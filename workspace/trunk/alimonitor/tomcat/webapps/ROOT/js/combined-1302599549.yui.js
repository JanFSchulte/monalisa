var olLoaded=0;var pmStart=10000000;var pmUpper=10001000;var pmCount=pmStart+1;var pmt="";var pms=new Array();var olInfo=new Info("4.21",1);var FREPLACE=0;var FBEFORE=1;var FAFTER=2;var FALTERNATE=3;var FCHAIN=4;var olHideForm=0;var olHautoFlag=0;var olVautoFlag=0;var hookPts=new Array(),postParse=new Array(),cmdLine=new Array(),runTime=new Array();registerCommands("donothing,inarray,caparray,sticky,background,noclose,caption,left,right,center,offsetx,offsety,fgcolor,bgcolor,textcolor,capcolor,closecolor,width,border,cellpad,status,autostatus,autostatuscap,height,closetext,snapx,snapy,fixx,fixy,relx,rely,fgbackground,bgbackground,padx,pady,fullhtml,above,below,capicon,textfont,captionfont,closefont,textsize,captionsize,closesize,timeout,function,delay,hauto,vauto,closeclick,wrap,followmouse,mouseoff,closetitle,cssoff,compatmode,cssclass,fgclass,bgclass,textfontclass,captionfontclass,closefontclass");if(typeof ol_fgcolor=="undefined"){var ol_fgcolor="#CCCCFF"}if(typeof ol_bgcolor=="undefined"){var ol_bgcolor="#333399"}if(typeof ol_textcolor=="undefined"){var ol_textcolor="#000000"}if(typeof ol_capcolor=="undefined"){var ol_capcolor="#FFFFFF"}if(typeof ol_closecolor=="undefined"){var ol_closecolor="#9999FF"}if(typeof ol_textfont=="undefined"){var ol_textfont="Verdana,Arial,Helvetica"}if(typeof ol_captionfont=="undefined"){var ol_captionfont="Verdana,Arial,Helvetica"}if(typeof ol_closefont=="undefined"){var ol_closefont="Verdana,Arial,Helvetica"}if(typeof ol_textsize=="undefined"){var ol_textsize="1"}if(typeof ol_captionsize=="undefined"){var ol_captionsize="1"}if(typeof ol_closesize=="undefined"){var ol_closesize="1"}if(typeof ol_width=="undefined"){var ol_width="200"}if(typeof ol_border=="undefined"){var ol_border="1"}if(typeof ol_cellpad=="undefined"){var ol_cellpad=2}if(typeof ol_offsetx=="undefined"){var ol_offsetx=10}if(typeof ol_offsety=="undefined"){var ol_offsety=10}if(typeof ol_text=="undefined"){var ol_text="Default Text"}if(typeof ol_cap=="undefined"){var ol_cap=""}if(typeof ol_sticky=="undefined"){var ol_sticky=0}if(typeof ol_background=="undefined"){var ol_background=""}if(typeof ol_close=="undefined"){var ol_close="Close"}if(typeof ol_hpos=="undefined"){var ol_hpos=RIGHT}if(typeof ol_status=="undefined"){var ol_status=""}if(typeof ol_autostatus=="undefined"){var ol_autostatus=0}if(typeof ol_height=="undefined"){var ol_height=-1}if(typeof ol_snapx=="undefined"){var ol_snapx=0}if(typeof ol_snapy=="undefined"){var ol_snapy=0}if(typeof ol_fixx=="undefined"){var ol_fixx=-1}if(typeof ol_fixy=="undefined"){var ol_fixy=-1}if(typeof ol_relx=="undefined"){var ol_relx=null}if(typeof ol_rely=="undefined"){var ol_rely=null}if(typeof ol_fgbackground=="undefined"){var ol_fgbackground=""}if(typeof ol_bgbackground=="undefined"){var ol_bgbackground=""}if(typeof ol_padxl=="undefined"){var ol_padxl=1}if(typeof ol_padxr=="undefined"){var ol_padxr=1}if(typeof ol_padyt=="undefined"){var ol_padyt=1}if(typeof ol_padyb=="undefined"){var ol_padyb=1}if(typeof ol_fullhtml=="undefined"){var ol_fullhtml=0}if(typeof ol_vpos=="undefined"){var ol_vpos=BELOW}if(typeof ol_aboveheight=="undefined"){var ol_aboveheight=0}if(typeof ol_capicon=="undefined"){var ol_capicon=""}if(typeof ol_frame=="undefined"){var ol_frame=self}if(typeof ol_timeout=="undefined"){var ol_timeout=0}if(typeof ol_function=="undefined"){var ol_function=null}if(typeof ol_delay=="undefined"){var ol_delay=0}if(typeof ol_hauto=="undefined"){var ol_hauto=0}if(typeof ol_vauto=="undefined"){var ol_vauto=0}if(typeof ol_closeclick=="undefined"){var ol_closeclick=0}if(typeof ol_wrap=="undefined"){var ol_wrap=0}if(typeof ol_followmouse=="undefined"){var ol_followmouse=1}if(typeof ol_mouseoff=="undefined"){var ol_mouseoff=0}if(typeof ol_closetitle=="undefined"){var ol_closetitle="Close"}if(typeof ol_compatmode=="undefined"){var ol_compatmode=0}if(typeof ol_css=="undefined"){var ol_css=CSSOFF}if(typeof ol_fgclass=="undefined"){var ol_fgclass=""}if(typeof ol_bgclass=="undefined"){var ol_bgclass=""}if(typeof ol_textfontclass=="undefined"){var ol_textfontclass=""}if(typeof ol_captionfontclass=="undefined"){var ol_captionfontclass=""}if(typeof ol_closefontclass=="undefined"){var ol_closefontclass=""}if(typeof ol_texts=="undefined"){var ol_texts=new Array("Text 0","Text 1")}if(typeof ol_caps=="undefined"){var ol_caps=new Array("Caption 0","Caption 1")}var o3_text="";var o3_cap="";var o3_sticky=0;var o3_background="";var o3_close="Close";var o3_hpos=RIGHT;var o3_offsetx=2;var o3_offsety=2;var o3_fgcolor="";var o3_bgcolor="";var o3_textcolor="";var o3_capcolor="";var o3_closecolor="";var o3_width=100;var o3_border=1;var o3_cellpad=2;var o3_status="";var o3_autostatus=0;var o3_height=-1;var o3_snapx=0;var o3_snapy=0;var o3_fixx=-1;var o3_fixy=-1;var o3_relx=null;var o3_rely=null;var o3_fgbackground="";var o3_bgbackground="";var o3_padxl=0;var o3_padxr=0;var o3_padyt=0;var o3_padyb=0;var o3_fullhtml=0;var o3_vpos=BELOW;var o3_aboveheight=0;var o3_capicon="";var o3_textfont="Verdana,Arial,Helvetica";var o3_captionfont="Verdana,Arial,Helvetica";var o3_closefont="Verdana,Arial,Helvetica";var o3_textsize="1";var o3_captionsize="1";var o3_closesize="1";var o3_frame=self;var o3_timeout=0;var o3_timerid=0;var o3_allowmove=0;var o3_function=null;var o3_delay=0;var o3_delayid=0;var o3_hauto=0;var o3_vauto=0;var o3_closeclick=0;var o3_wrap=0;var o3_followmouse=1;var o3_mouseoff=0;var o3_closetitle="";var o3_compatmode=0;var o3_css=CSSOFF;var o3_fgclass="";var o3_bgclass="";var o3_textfontclass="";var o3_captionfontclass="";var o3_closefontclass="";var o3_x=0;var o3_y=0;var o3_showingsticky=0;var o3_removecounter=0;var over=null;var fnRef,hoveringSwitch=false;var olHideDelay;var isMac=(navigator.userAgent.indexOf("Mac")!=-1);var olOp=(navigator.userAgent.toLowerCase().indexOf("opera")>-1&&document.createTextNode);var olNs4=(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)==4);var olNs6=(document.getElementById)?true:false;var olKq=(olNs6&&/konqueror/i.test(navigator.userAgent));var olIe4=(document.all)?true:false;var olIe5=false;var olIe55=false;var docRoot="document.body";if(olNs4){var oW=window.innerWidth;var oH=window.innerHeight;window.onresize=function(){if(oW!=window.innerWidth||oH!=window.innerHeight){location.reload()}}}if(olIe4){var agent=navigator.userAgent;if(/MSIE/.test(agent)){var versNum=parseFloat(agent.match(/MSIE[ ](\d\.\d+)\.*/i)[1]);if(versNum>=5){olIe5=true;olIe55=(versNum>=5.5&&!olOp)?true:false;if(olNs6){olNs6=false}}}if(olNs6){olIe4=false}}if(document.compatMode&&document.compatMode=="CSS1Compat"){docRoot=((olIe4&&!olOp)?"document.documentElement":docRoot)}if(window.addEventListener){window.addEventListener("load",OLonLoad_handler,false)}else{if(window.attachEvent){window.attachEvent("onload",OLonLoad_handler)}}var capExtent;function overlib(){if(!olLoaded||isExclusive(overlib.arguments)){return true}if(olCheckMouseCapture){olMouseCapture()}if(over){over=(typeof over.id!="string")?o3_frame.document.all.overDiv:over;cClick()}olHideDelay=0;o3_text=ol_text;o3_cap=ol_cap;o3_sticky=ol_sticky;o3_background=ol_background;o3_close=ol_close;o3_hpos=ol_hpos;o3_offsetx=ol_offsetx;o3_offsety=ol_offsety;o3_fgcolor=ol_fgcolor;o3_bgcolor=ol_bgcolor;o3_textcolor=ol_textcolor;o3_capcolor=ol_capcolor;o3_closecolor=ol_closecolor;o3_width=ol_width;o3_border=ol_border;o3_cellpad=ol_cellpad;o3_status=ol_status;o3_autostatus=ol_autostatus;o3_height=ol_height;o3_snapx=ol_snapx;o3_snapy=ol_snapy;o3_fixx=ol_fixx;o3_fixy=ol_fixy;o3_relx=ol_relx;o3_rely=ol_rely;o3_fgbackground=ol_fgbackground;o3_bgbackground=ol_bgbackground;o3_padxl=ol_padxl;o3_padxr=ol_padxr;o3_padyt=ol_padyt;o3_padyb=ol_padyb;o3_fullhtml=ol_fullhtml;o3_vpos=ol_vpos;o3_aboveheight=ol_aboveheight;o3_capicon=ol_capicon;o3_textfont=ol_textfont;o3_captionfont=ol_captionfont;o3_closefont=ol_closefont;o3_textsize=ol_textsize;o3_captionsize=ol_captionsize;o3_closesize=ol_closesize;o3_timeout=ol_timeout;o3_function=ol_function;o3_delay=ol_delay;o3_hauto=ol_hauto;o3_vauto=ol_vauto;o3_closeclick=ol_closeclick;o3_wrap=ol_wrap;o3_followmouse=ol_followmouse;o3_mouseoff=ol_mouseoff;o3_closetitle=ol_closetitle;o3_css=ol_css;o3_compatmode=ol_compatmode;o3_fgclass=ol_fgclass;o3_bgclass=ol_bgclass;o3_textfontclass=ol_textfontclass;o3_captionfontclass=ol_captionfontclass;o3_closefontclass=ol_closefontclass;setRunTimeVariables();fnRef="";o3_frame=ol_frame;if(!(over=createDivContainer())){return false}parseTokens("o3_",overlib.arguments);if(!postParseChecks()){return false}if(o3_delay==0){return runHook("olMain",FREPLACE)}else{o3_delayid=setTimeout("runHook('olMain', FREPLACE)",o3_delay);return false}}function nd(a){if(olLoaded&&!isExclusive()){hideDelay(a);if(o3_removecounter>=1){o3_showingsticky=0}if(o3_showingsticky==0){o3_allowmove=0;if(over!=null&&o3_timerid==0){runHook("hideObject",FREPLACE,over)}}else{o3_removecounter++}}return true}function cClick(){if(olLoaded){runHook("hideObject",FREPLACE,over);o3_showingsticky=0}return false}function overlib_pagedefaults(){parseTokens("ol_",overlib_pagedefaults.arguments)}function olMain(){var b,a;runHook("olMain",FBEFORE);if(o3_background!=""||o3_fullhtml){b=runHook("ol_content_background",FALTERNATE,o3_css,o3_text,o3_background,o3_fullhtml)}else{a=(pms[o3_css-1-pmStart]=="cssoff"||pms[o3_css-1-pmStart]=="cssclass");if(o3_fgbackground!=""){o3_fgbackground='background="'+o3_fgbackground+'"'}if(o3_bgbackground!=""){o3_bgbackground=(a?'background="'+o3_bgbackground+'"':o3_bgbackground)}if(o3_fgcolor!=""){o3_fgcolor=(a?'bgcolor="'+o3_fgcolor+'"':o3_fgcolor)}if(o3_bgcolor!=""){o3_bgcolor=(a?'bgcolor="'+o3_bgcolor+'"':o3_bgcolor)}if(o3_height>0){o3_height=(a?'height="'+o3_height+'"':o3_height)}else{o3_height=""}if(o3_cap==""){b=runHook("ol_content_simple",FALTERNATE,o3_css,o3_text)}else{if(o3_sticky){b=runHook("ol_content_caption",FALTERNATE,o3_css,o3_text,o3_cap,o3_close)}else{b=runHook("ol_content_caption",FALTERNATE,o3_css,o3_text,o3_cap,"")}}}if(o3_sticky){if(o3_timerid>0){clearTimeout(o3_timerid);o3_timerid=0}o3_showingsticky=1;o3_removecounter=0}if(!runHook("createPopup",FREPLACE,b)){return false}if(o3_autostatus>0){o3_status=o3_text;if(o3_autostatus>1){o3_status=o3_cap}}o3_allowmove=0;if(o3_timeout>0){if(o3_timerid>0){clearTimeout(o3_timerid)}o3_timerid=setTimeout("cClick()",o3_timeout)}runHook("disp",FREPLACE,o3_status);runHook("olMain",FAFTER);return(olOp&&event&&event.type=="mouseover"&&!o3_status)?"":(o3_status!="")}function ol_content_simple(c){var b=/,/.test(o3_cellpad);var a='<table width="'+o3_width+'" border="0" cellpadding="'+o3_border+'" cellspacing="0" '+(o3_bgclass?'class="'+o3_bgclass+'"':o3_bgcolor+" "+o3_height)+'><tr><td><table width="100%" border="0" '+((olNs4||!b)?'cellpadding="'+o3_cellpad+'" ':"")+'cellspacing="0" '+(o3_fgclass?'class="'+o3_fgclass+'"':o3_fgcolor+" "+o3_fgbackground+" "+o3_height)+'><tr><td valign="TOP"'+(o3_textfontclass?' class="'+o3_textfontclass+'">':((!olNs4&&b)?' style="'+setCellPadStr(o3_cellpad)+'">':">"))+(o3_textfontclass?"":wrapStr(0,o3_textsize,"text"))+c+(o3_textfontclass?"":wrapStr(1,o3_textsize))+"</td></tr></table></td></tr></table>";set_background("");return a}function ol_content_caption(j,h,g){var f,b,e=/,/.test(o3_cellpad);var c,a;c="";a="onmouseover";if(o3_closeclick==1){a=(o3_closetitle?"title='"+o3_closetitle+"'":"")+" onclick"}if(o3_capicon!=""){f=' hspace = "5" align = "middle" alt = ""';if(typeof o3_dragimg!="undefined"&&o3_dragimg){f=' hspace="5" name="'+o3_dragimg+'" id="'+o3_dragimg+'" align="middle" alt="Drag Enabled" title="Drag Enabled"'}o3_capicon='<img src="'+o3_capicon+'"'+f+" />"}if(g!=""){c="<td "+(!o3_compatmode&&o3_closefontclass?'class="'+o3_closefontclass:'align="RIGHT')+'"><a href="javascript:return '+fnRef+'cClick();"'+((o3_compatmode&&o3_closefontclass)?' class="'+o3_closefontclass+'" ':" ")+a+'="return '+fnRef+'cClick();">'+(o3_closefontclass?"":wrapStr(0,o3_closesize,"close"))+g+(o3_closefontclass?"":wrapStr(1,o3_closesize,"close"))+"</a></td>"}b='<table width="'+o3_width+'" border="0" cellpadding="'+o3_border+'" cellspacing="0" '+(o3_bgclass?'class="'+o3_bgclass+'"':o3_bgcolor+" "+o3_bgbackground+" "+o3_height)+'><tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0"><tr><td'+(o3_captionfontclass?' class="'+o3_captionfontclass+'">':">")+(o3_captionfontclass?"":"<b>"+wrapStr(0,o3_captionsize,"caption"))+o3_capicon+h+(o3_captionfontclass?"":wrapStr(1,o3_captionsize)+"</b>")+"</td>"+c+'</tr></table><table width="100%" border="0" '+((olNs4||!e)?'cellpadding="'+o3_cellpad+'" ':"")+'cellspacing="0" '+(o3_fgclass?'class="'+o3_fgclass+'"':o3_fgcolor+" "+o3_fgbackground+" "+o3_height)+'><tr><td valign="TOP"'+(o3_textfontclass?' class="'+o3_textfontclass+'">':((!olNs4&&e)?' style="'+setCellPadStr(o3_cellpad)+'">':">"))+(o3_textfontclass?"":wrapStr(0,o3_textsize,"text"))+j+(o3_textfontclass?"":wrapStr(1,o3_textsize))+"</td></tr></table></td></tr></table>";set_background("");return b}function ol_content_background(c,b,a){if(a){txt=c}else{txt='<table width="'+o3_width+'" border="0" cellpadding="0" cellspacing="0" height="'+o3_height+'"><tr><td colspan="3" height="'+o3_padyt+'"></td></tr><tr><td width="'+o3_padxl+'"></td><td valign="TOP" width="'+(o3_width-o3_padxl-o3_padxr)+(o3_textfontclass?'" class="'+o3_textfontclass:"")+'">'+(o3_textfontclass?"":wrapStr(0,o3_textsize,"text"))+c+(o3_textfontclass?"":wrapStr(1,o3_textsize))+'</td><td width="'+o3_padxr+'"></td></tr><tr><td colspan="3" height="'+o3_padyb+'"></td></tr></table>'}set_background(b);return txt}function set_background(a){if(a==""){if(olNs4){over.background.src=null}else{if(over.style){over.style.backgroundImage="none"}}}else{if(olNs4){over.background.src=a}else{if(over.style){over.style.width=o3_width+"px";over.style.backgroundImage="url("+a+")"}}}}var olShowId=-1;function disp(a){runHook("disp",FBEFORE);if(o3_allowmove==0){runHook("placeLayer",FREPLACE);(olNs6&&olShowId<0)?olShowId=setTimeout("runHook('showObject', FREPLACE, over)",1):runHook("showObject",FREPLACE,over);o3_allowmove=(o3_sticky||o3_followmouse==0)?0:1}runHook("disp",FAFTER);if(a!=""){self.status=a}}function createPopup(a){runHook("createPopup",FBEFORE);if(o3_wrap){var c,e,b=(olNs4?over:over.style);b.top=b.left=((olIe4&&!olOp)?0:-10000)+(!olNs4?"px":0);layerWrite(a);c=(olNs4?over.clip.width:over.offsetWidth);if(c>(e=windowWidth())){a=a.replace(/\&nbsp;/g," ");o3_width=e;o3_wrap=0}}layerWrite(a);if(o3_wrap){o3_width=(olNs4?over.clip.width:over.offsetWidth)}runHook("createPopup",FAFTER,a);return true}function placeLayer(){var placeX,placeY,widthFix=0;if(o3_frame.innerWidth){widthFix=18}iwidth=windowWidth();winoffset=(olIe4)?eval("o3_frame."+docRoot+".scrollLeft"):o3_frame.pageXOffset;placeX=runHook("horizontalPlacement",FCHAIN,iwidth,winoffset,widthFix);if(o3_frame.innerHeight){iheight=o3_frame.innerHeight}else{if(eval("o3_frame."+docRoot)&&eval("typeof o3_frame."+docRoot+".clientHeight=='number'")&&eval("o3_frame."+docRoot+".clientHeight")){iheight=eval("o3_frame."+docRoot+".clientHeight")}}scrolloffset=(olIe4)?eval("o3_frame."+docRoot+".scrollTop"):o3_frame.pageYOffset;placeY=runHook("verticalPlacement",FCHAIN,iheight,scrolloffset);repositionTo(over,placeX,placeY)}function olMouseMove(e){var e=(e)?e:event;if(e.pageX){o3_x=e.pageX;o3_y=e.pageY}else{if(e.clientX){o3_x=eval("e.clientX+o3_frame."+docRoot+".scrollLeft");o3_y=eval("e.clientY+o3_frame."+docRoot+".scrollTop")}}if(o3_allowmove==1){runHook("placeLayer",FREPLACE)}if(hoveringSwitch&&!olNs4&&runHook("cursorOff",FREPLACE)){(olHideDelay?hideDelay(olHideDelay):cClick());hoveringSwitch=!hoveringSwitch}}function no_overlib(){return ver3fix}function olMouseCapture(){capExtent=document;var fN,str="",l,k,f,wMv,sS,mseHandler=olMouseMove;var re=/function[ ]*(\w*)\(/;wMv=(!olIe4&&window.onmousemove);if(document.onmousemove||wMv){if(wMv){capExtent=window}f=capExtent.onmousemove.toString();fN=f.match(re);if(fN==null){str=f+"(e); "}else{if(fN[1]=="anonymous"||fN[1]=="olMouseMove"||(wMv&&fN[1]=="onmousemove")){if(!olOp&&wMv){l=f.indexOf("{")+1;k=f.lastIndexOf("}");sS=f.substring(l,k);if((l=sS.indexOf("("))!=-1){sS=sS.substring(0,l).replace(/^\s+/,"").replace(/\s+$/,"");if(eval("typeof "+sS+" == 'undefined'")){window.onmousemove=null}else{str=sS+"(e);"}}}if(!str){olCheckMouseCapture=false;return}}else{if(fN[1]){str=fN[1]+"(e); "}else{l=f.indexOf("{")+1;k=f.lastIndexOf("}");str=f.substring(l,k)+"\n"}}}str+="olMouseMove(e); ";mseHandler=new Function("e",str)}capExtent.onmousemove=mseHandler;if(olNs4){capExtent.captureEvents(Event.MOUSEMOVE)}}function parseTokens(pf,ar){var v,i,mode=-1,par=(pf!="ol_");var fnMark=(par&&!ar.length?1:0);for(i=0;i<ar.length;i++){if(mode<0){if(typeof ar[i]=="number"&&ar[i]>pmStart&&ar[i]<pmUpper){fnMark=(par?1:0);i--}else{switch(pf){case"ol_":ol_text=ar[i].toString();break;default:o3_text=ar[i].toString()}}mode=0}else{if(ar[i]>=pmCount||ar[i]==DONOTHING){continue}if(ar[i]==INARRAY){fnMark=0;eval(pf+"text=ol_texts["+ar[++i]+"].toString()");continue}if(ar[i]==CAPARRAY){eval(pf+"cap=ol_caps["+ar[++i]+"].toString()");continue}if(ar[i]==STICKY){if(pf!="ol_"){eval(pf+"sticky=1")}continue}if(ar[i]==BACKGROUND){eval(pf+'background="'+ar[++i]+'"');continue}if(ar[i]==NOCLOSE){if(pf!="ol_"){opt_NOCLOSE()}continue}if(ar[i]==CAPTION){eval(pf+"cap='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==CENTER||ar[i]==LEFT||ar[i]==RIGHT){eval(pf+"hpos="+ar[i]);if(pf!="ol_"){olHautoFlag=1}continue}if(ar[i]==OFFSETX){eval(pf+"offsetx="+ar[++i]);continue}if(ar[i]==OFFSETY){eval(pf+"offsety="+ar[++i]);continue}if(ar[i]==FGCOLOR){eval(pf+'fgcolor="'+ar[++i]+'"');continue}if(ar[i]==BGCOLOR){eval(pf+'bgcolor="'+ar[++i]+'"');continue}if(ar[i]==TEXTCOLOR){eval(pf+'textcolor="'+ar[++i]+'"');continue}if(ar[i]==CAPCOLOR){eval(pf+'capcolor="'+ar[++i]+'"');continue}if(ar[i]==CLOSECOLOR){eval(pf+'closecolor="'+ar[++i]+'"');continue}if(ar[i]==WIDTH){eval(pf+"width="+ar[++i]);continue}if(ar[i]==BORDER){eval(pf+"border="+ar[++i]);continue}if(ar[i]==CELLPAD){i=opt_MULTIPLEARGS(++i,ar,(pf+"cellpad"));continue}if(ar[i]==STATUS){eval(pf+"status='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==AUTOSTATUS){eval(pf+"autostatus=("+pf+"autostatus == 1) ? 0 : 1");continue}if(ar[i]==AUTOSTATUSCAP){eval(pf+"autostatus=("+pf+"autostatus == 2) ? 0 : 2");continue}if(ar[i]==HEIGHT){eval(pf+"height="+pf+"aboveheight="+ar[++i]);continue}if(ar[i]==CLOSETEXT){eval(pf+"close='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==SNAPX){eval(pf+"snapx="+ar[++i]);continue}if(ar[i]==SNAPY){eval(pf+"snapy="+ar[++i]);continue}if(ar[i]==FIXX){eval(pf+"fixx="+ar[++i]);continue}if(ar[i]==FIXY){eval(pf+"fixy="+ar[++i]);continue}if(ar[i]==RELX){eval(pf+"relx="+ar[++i]);continue}if(ar[i]==RELY){eval(pf+"rely="+ar[++i]);continue}if(ar[i]==FGBACKGROUND){eval(pf+'fgbackground="'+ar[++i]+'"');continue}if(ar[i]==BGBACKGROUND){eval(pf+'bgbackground="'+ar[++i]+'"');continue}if(ar[i]==PADX){eval(pf+"padxl="+ar[++i]);eval(pf+"padxr="+ar[++i]);continue}if(ar[i]==PADY){eval(pf+"padyt="+ar[++i]);eval(pf+"padyb="+ar[++i]);continue}if(ar[i]==FULLHTML){if(pf!="ol_"){eval(pf+"fullhtml=1")}continue}if(ar[i]==BELOW||ar[i]==ABOVE){eval(pf+"vpos="+ar[i]);if(pf!="ol_"){olVautoFlag=1}continue}if(ar[i]==CAPICON){eval(pf+'capicon="'+ar[++i]+'"');continue}if(ar[i]==TEXTFONT){eval(pf+"textfont='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==CAPTIONFONT){eval(pf+"captionfont='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==CLOSEFONT){eval(pf+"closefont='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==TEXTSIZE){eval(pf+'textsize="'+ar[++i]+'"');continue}if(ar[i]==CAPTIONSIZE){eval(pf+'captionsize="'+ar[++i]+'"');continue}if(ar[i]==CLOSESIZE){eval(pf+'closesize="'+ar[++i]+'"');continue}if(ar[i]==TIMEOUT){eval(pf+"timeout="+ar[++i]);continue}if(ar[i]==FUNCTION){if(pf=="ol_"){if(typeof ar[i+1]!="number"){v=ar[++i];ol_function=(typeof v=="function"?v:null)}}else{fnMark=0;v=null;if(typeof ar[i+1]!="number"){v=ar[++i]}opt_FUNCTION(v)}continue}if(ar[i]==DELAY){eval(pf+"delay="+ar[++i]);continue}if(ar[i]==HAUTO){eval(pf+"hauto=("+pf+"hauto == 0) ? 1 : 0");continue}if(ar[i]==VAUTO){eval(pf+"vauto=("+pf+"vauto == 0) ? 1 : 0");continue}if(ar[i]==CLOSECLICK){eval(pf+"closeclick=("+pf+"closeclick == 0) ? 1 : 0");continue}if(ar[i]==WRAP){eval(pf+"wrap=("+pf+"wrap == 0) ? 1 : 0");continue}if(ar[i]==FOLLOWMOUSE){eval(pf+"followmouse=("+pf+"followmouse == 1) ? 0 : 1");continue}if(ar[i]==MOUSEOFF){eval(pf+"mouseoff=("+pf+"mouseoff==0) ? 1 : 0");v=ar[i+1];if(pf!="ol_"&&eval(pf+"mouseoff")&&typeof v=="number"&&(v<pmStart||v>pmUpper)){olHideDelay=ar[++i]}continue}if(ar[i]==CLOSETITLE){eval(pf+"closetitle='"+escSglQuote(ar[++i])+"'");continue}if(ar[i]==CSSOFF||ar[i]==CSSCLASS){eval(pf+"css="+ar[i]);continue}if(ar[i]==COMPATMODE){eval(pf+"compatmode=("+pf+"compatmode==0) ? 1 : 0");continue}if(ar[i]==FGCLASS){eval(pf+'fgclass="'+ar[++i]+'"');continue}if(ar[i]==BGCLASS){eval(pf+'bgclass="'+ar[++i]+'"');continue}if(ar[i]==TEXTFONTCLASS){eval(pf+'textfontclass="'+ar[++i]+'"');continue}if(ar[i]==CAPTIONFONTCLASS){eval(pf+'captionfontclass="'+ar[++i]+'"');continue}if(ar[i]==CLOSEFONTCLASS){eval(pf+'closefontclass="'+ar[++i]+'"');continue}i=parseCmdLine(pf,i,ar)}}if(fnMark&&o3_function){o3_text=o3_function()}if((pf=="o3_")&&o3_wrap){o3_width=0;var tReg=/<.*\n*>/ig;if(!tReg.test(o3_text)){o3_text=o3_text.replace(/[ ]+/g,"&nbsp;")}if(!tReg.test(o3_cap)){o3_cap=o3_cap.replace(/[ ]+/g,"&nbsp;")}}if((pf=="o3_")&&o3_sticky){if(!o3_close&&(o3_frame!=ol_frame)){o3_close=ol_close}if(o3_mouseoff&&(o3_frame==ol_frame)){opt_NOCLOSE(" ")}}}function layerWrite(a){a+="\n";if(olNs4){var b=o3_frame.document.layers.overDiv.document;b.write(a);b.close()}else{if(typeof over.innerHTML!="undefined"){if(olIe5&&isMac){over.innerHTML=""}over.innerHTML=a}else{range=o3_frame.document.createRange();range.setStartAfter(over);domfrag=range.createContextualFragment(a);while(over.hasChildNodes()){over.removeChild(over.lastChild)}over.appendChild(domfrag)}}}function showObject(b){runHook("showObject",FBEFORE);var a=(olNs4?b:b.style);a.visibility="visible";runHook("showObject",FAFTER)}function hideObject(b){runHook("hideObject",FBEFORE);var a=(olNs4?b:b.style);if(olNs6&&olShowId>0){clearTimeout(olShowId);olShowId=0}a.visibility="hidden";a.top=a.left=((olIe4&&!olOp)?0:-10000)+(!olNs4?"px":0);if(o3_timerid>0){clearTimeout(o3_timerid)}if(o3_delayid>0){clearTimeout(o3_delayid)}o3_timerid=0;o3_delayid=0;self.status="";if(b.onmouseout||b.onmouseover){if(olNs4){b.releaseEvents(Event.MOUSEOUT||Event.MOUSEOVER)}b.onmouseout=b.onmouseover=null}runHook("hideObject",FAFTER)}function repositionTo(c,e,a){var b=(olNs4?c:c.style);b.left=e+(!olNs4?"px":0);b.top=a+(!olNs4?"px":0)}function cursorOff(){var e=parseInt(over.style.left);var c=parseInt(over.style.top);var b=e+(over.offsetWidth>=parseInt(o3_width)?over.offsetWidth:parseInt(o3_width));var a=c+(over.offsetHeight>=o3_aboveheight?over.offsetHeight:o3_aboveheight);if(o3_x<e||o3_x>b||o3_y<c||o3_y>a){return true}return false}function opt_FUNCTION(callme){o3_text=(callme?(typeof callme=="string"?(/.+\(.*\)/.test(callme)?eval(callme):callme):callme()):(o3_function?o3_function():"No Function"));return 0}function opt_NOCLOSE(a){if(!a){o3_close=""}if(olNs4){over.captureEvents(Event.MOUSEOUT||Event.MOUSEOVER);over.onmouseover=function(){if(o3_timerid>0){clearTimeout(o3_timerid);o3_timerid=0}};over.onmouseout=function(b){if(olHideDelay){hideDelay(olHideDelay)}else{cClick(b)}}}else{over.onmouseover=function(){hoveringSwitch=true;if(o3_timerid>0){clearTimeout(o3_timerid);o3_timerid=0}}}return 0}function opt_MULTIPLEARGS(i,args,parameter){var k=i,re,pV,str="";for(k=i;k<args.length;k++){if(typeof args[k]=="number"&&args[k]>pmStart){break}str+=args[k]+","}if(str){str=str.substring(0,--str.length)}k--;pV=(olNs4&&/cellpad/i.test(parameter))?str.split(",")[0]:str;eval(parameter+'="'+pV+'"');return k}function nbspCleanup(){if(o3_wrap){o3_text=o3_text.replace(/\&nbsp;/g," ");o3_cap=o3_cap.replace(/\&nbsp;/g," ")}}function escSglQuote(a){return a.toString().replace(/'/g,"\\'")}function OLonLoad_handler(e){var re=/\w+\(.*\)[;\s]+/g,olre=/overlib\(|nd\(|cClick\(/,fn,l,i;if(!olLoaded){olLoaded=1}if(window.removeEventListener&&e.eventPhase==3){window.removeEventListener("load",OLonLoad_handler,false)}else{if(window.detachEvent){window.detachEvent("onload",OLonLoad_handler);var fN=document.body.getAttribute("onload");if(fN){fN=fN.toString().match(re);if(fN&&fN.length){for(i=0;i<fN.length;i++){if(/anonymous/.test(fN[i])){continue}while((l=fN[i].search(/\)[;\s]+/))!=-1){fn=fN[i].substring(0,l+1);fN[i]=fN[i].substring(l+2);if(olre.test(fn)){eval(fn)}}}}}}}}function wrapStr(endWrap,fontSizeStr,whichString){var fontStr,fontColor,isClose=((whichString=="close")?1:0),hasDims=/[%\-a-z]+$/.test(fontSizeStr);fontSizeStr=(olNs4)?(!hasDims?fontSizeStr:"1"):fontSizeStr;if(endWrap){return(hasDims&&!olNs4)?(isClose?"</span>":"</div>"):"</font>"}else{fontStr="o3_"+whichString+"font";fontColor="o3_"+((whichString=="caption")?"cap":whichString)+"color";return(hasDims&&!olNs4)?(isClose?'<span style="font-family: '+quoteMultiNameFonts(eval(fontStr))+"; color: "+eval(fontColor)+"; font-size: "+fontSizeStr+';">':'<div style="font-family: '+quoteMultiNameFonts(eval(fontStr))+"; color: "+eval(fontColor)+"; font-size: "+fontSizeStr+';">'):'<font face="'+eval(fontStr)+'" color="'+eval(fontColor)+'" size="'+(parseInt(fontSizeStr)>7?"7":fontSizeStr)+'">'}}function quoteMultiNameFonts(e){var a,b=e.split(",");for(var c=0;c<b.length;c++){a=b[c];a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(/\s/.test(a)&&!/['"]/.test(a)){a="'"+a+"'";b[c]=a}}return b.join()}function isExclusive(a){return false}function setCellPadStr(n){var f="",b=0,e=new Array(),h,a,g,c;f+="padding: ";e=n.replace(/\s+/g,"").split(",");switch(e.length){case 2:h=a=e[b];g=c=e[++b];break;case 3:h=e[b];g=c=e[++b];a=e[++b];break;case 4:h=e[b];c=e[++b];a=e[++b];g=e[++b];break}f+=((e.length==1)?e[0]+"px;":h+"px "+c+"px "+a+"px "+g+"px;");return f}function hideDelay(a){if(a&&!o3_delay){if(o3_timerid>0){clearTimeout(o3_timerid)}o3_timerid=setTimeout("cClick()",(o3_timeout=a))}}function horizontalPlacement(h,j,e){var g,b=h,c=j;var a=parseInt(o3_width);if(o3_fixx>-1||o3_relx!=null){g=(o3_relx!=null?(o3_relx<0?c+o3_relx+b-a-e:c+o3_relx):o3_fixx)}else{if(o3_hauto==1){if((o3_x-c)>(b/2)){o3_hpos=LEFT}else{o3_hpos=RIGHT}}if(o3_hpos==CENTER){g=o3_x+o3_offsetx-(a/2);if(g<c){g=c}}if(o3_hpos==RIGHT){g=o3_x+o3_offsetx;if((g+a)>(c+b-e)){g=b+c-a-e;if(g<0){g=0}}}if(o3_hpos==LEFT){g=o3_x-o3_offsetx-a;if(g<c){g=c}}if(o3_snapx>1){var f=g%o3_snapx;if(o3_hpos==LEFT){g=g-(o3_snapx+f)}else{g=g+(o3_snapx-f)}if(g<c){g=c}}}return g}function verticalPlacement(b,a){var g,h=b,c=a;var f=(o3_aboveheight?parseInt(o3_aboveheight):(olNs4?over.clip.height:over.offsetHeight));if(o3_fixy>-1||o3_rely!=null){g=(o3_rely!=null?(o3_rely<0?c+o3_rely+h-f:c+o3_rely):o3_fixy)}else{if(o3_vauto==1){if((o3_y-c)>(h/2)&&o3_vpos==BELOW&&(o3_y+f+o3_offsety-(c+h)>0)){o3_vpos=ABOVE}else{if(o3_vpos==ABOVE&&(o3_y-(f+o3_offsety)-c<0)){o3_vpos=BELOW}}}if(o3_vpos==ABOVE){if(o3_aboveheight==0){o3_aboveheight=f}g=o3_y-(o3_aboveheight+o3_offsety);if(g<c){g=c}}else{g=o3_y+o3_offsety}if(o3_snapy>1){var e=g%o3_snapy;if(o3_aboveheight>0&&o3_vpos==ABOVE){g=g-(o3_snapy+e)}else{g=g+(o3_snapy-e)}if(g<c){g=c}}}return g}function checkPositionFlags(){if(olHautoFlag){olHautoFlag=o3_hauto=0}if(olVautoFlag){olVautoFlag=o3_vauto=0}return true}function windowWidth(){var w;if(o3_frame.innerWidth){w=o3_frame.innerWidth}else{if(eval("o3_frame."+docRoot)&&eval("typeof o3_frame."+docRoot+".clientWidth=='number'")&&eval("o3_frame."+docRoot+".clientWidth")){w=eval("o3_frame."+docRoot+".clientWidth")}}return w}function createDivContainer(g,e,c){g=(g||"overDiv"),e=(e||o3_frame),c=(c||1000);var f,b=layerReference(g);if(b==null){if(olNs4){b=e.document.layers[g]=new Layer(window.innerWidth,e);f=b}else{var a=(olIe4?e.document.all.tags("BODY")[0]:e.document.getElementsByTagName("BODY")[0]);if(olIe4&&!document.getElementById){a.insertAdjacentHTML("beforeEnd",'<div id="'+g+'"></div>');b=layerReference(g)}else{b=e.document.createElement("DIV");b.id=g;a.appendChild(b)}f=b.style}f.position="absolute";f.visibility="hidden";f.zIndex=c;if(olIe4&&!olOp){f.left=f.top="0px"}else{f.left=f.top=-10000+(!olNs4?"px":0)}}return b}function layerReference(a){return(olNs4?o3_frame.document.layers[a]:(document.all?o3_frame.document.all[a]:o3_frame.document.getElementById(a)))}function isFunction(c){var b=true;if(typeof c=="object"){for(var a=0;a<c.length;a++){if(typeof c[a]=="function"){continue}b=false;break}}else{if(typeof c!="function"){b=false}}return b}function argToString(h,b,g){var f=b,a="",e=h;g=(g?g:"ar");if(e.length>f){for(var c=f;c<e.length;c++){a+=g+"["+c+"], "}a=a.substring(0,a.length-2)}return a}function reOrder(b,h,a){var c=new Array(),f,g,e;if(!a||typeof a=="undefined"||typeof a=="number"){return b}if(typeof a=="function"){if(typeof h=="object"){c=c.concat(h)}else{c[c.length++]=h}for(g=0;g<b.length;g++){f=false;if(typeof h=="function"&&b[g]==h){continue}else{for(e=0;e<h.length;e++){if(b[g]==h[e]){f=true;break}}}if(!f){c[c.length++]=b[g]}}c[c.length++]=a}else{if(typeof a=="object"){if(typeof h=="object"){c=c.concat(h)}else{c[c.length++]=h}for(e=0;e<b.length;e++){f=false;if(typeof h=="function"&&b[e]==h){continue}else{for(g=0;g<h.length;g++){if(b[e]==h[g]){f=true;break}}}if(!f){c[c.length++]=b[e]}}for(g=0;g<c.length;g++){b[g]=c[g]}c.length=0;for(e=0;e<b.length;e++){f=false;for(g=0;g<a.length;g++){if(b[e]==a[g]){f=true;break}}if(!f){c[c.length++]=b[e]}}c=c.concat(a)}}b=c;return b}function setRunTimeVariables(){if(typeof runTime!="undefined"&&runTime.length){for(var a=0;a<runTime.length;a++){runTime[a]()}}}function parseCmdLine(a,f,e){if(typeof cmdLine!="undefined"&&cmdLine.length){for(var b=0;b<cmdLine.length;b++){var c=cmdLine[b](a,f,e);if(c>-1){f=c;break}}}return f}function postParseChecks(a,c){if(typeof postParse!="undefined"&&postParse.length){for(var b=0;b<postParse.length;b++){if(postParse[b](a,c)){continue}return false}}return true}function registerCommands(cmdStr){if(typeof cmdStr!="string"){return}var pM=cmdStr.split(",");pms=pms.concat(pM);for(var i=0;i<pM.length;i++){eval(pM[i].toUpperCase()+"="+pmCount++)}}function registerNoParameterCommands(a){if(!a&&typeof a!="string"){return}pmt=(!pmt)?a:pmt+","+a}function registerHook(g,f,e,b){var a,c=typeof b;if(g=="plgIn"||g=="postParse"){return}if(typeof hookPts[g]=="undefined"){hookPts[g]=new FunctionReference()}a=hookPts[g];if(e!=null){if(e==FREPLACE){a.ovload=f;if(g.indexOf("ol_content_")>-1){a.alt[pms[CSSOFF-1-pmStart]]=f}}else{if(e==FBEFORE||e==FAFTER){var a=(e==1?a.before:a.after);if(typeof f=="object"){a=a.concat(f)}else{a[a.length++]=f}if(b){a=reOrder(a,f,b)}}else{if(e==FALTERNATE){if(c=="number"){a.alt[pms[b-1-pmStart]]=f}}else{if(e==FCHAIN){a=a.chain;if(typeof f=="object"){a=a.concat(f)}else{a[a.length++]=f}}}}}return}}function registerRunTimeFunction(a){if(isFunction(a)){if(typeof a=="object"){runTime=runTime.concat(a)}else{runTime[runTime.length++]=a}}}function registerCmdLineFunction(a){if(isFunction(a)){if(typeof a=="object"){cmdLine=cmdLine.concat(a)}else{cmdLine[cmdLine.length++]=a}}}function registerPostParseFunction(a){if(isFunction(a)){if(typeof a=="object"){postParse=postParse.concat(a)}else{postParse[postParse.length++]=a}}}function runHook(fnHookTo,hookType){var l=hookPts[fnHookTo],k,rtnVal=null,optPm,arS,ar=runHook.arguments;if(hookType==FREPLACE){arS=argToString(ar,2);if(typeof l=="undefined"||!(l=l.ovload)){rtnVal=eval(fnHookTo+"("+arS+")")}else{rtnVal=eval("l("+arS+")")}}else{if(hookType==FBEFORE||hookType==FAFTER){if(typeof l!="undefined"){l=(hookType==1?l.before:l.after);if(l.length){arS=argToString(ar,2);for(var k=0;k<l.length;k++){eval("l[k]("+arS+")")}}}}else{if(hookType==FALTERNATE){optPm=ar[2];arS=argToString(ar,3);if(typeof l=="undefined"||(l=l.alt[pms[optPm-1-pmStart]])=="undefined"){rtnVal=eval(fnHookTo+"("+arS+")")}else{rtnVal=eval("l("+arS+")")}}else{if(hookType==FCHAIN){arS=argToString(ar,2);l=l.chain;for(k=l.length;k>0;k--){if((rtnVal=eval("l[k-1]("+arS+")"))!=void (0)){break}}}}}}return rtnVal}function FunctionReference(){this.ovload=null;this.before=new Array();this.after=new Array();this.alt=new Array();this.chain=new Array()}function Info(a,b){this.version=a;this.prerelease=b;this.simpleversion=Math.round(this.version*100);this.major=parseInt(this.simpleversion/100);this.minor=parseInt(this.simpleversion/10)-this.major*10;this.revision=parseInt(this.simpleversion)-this.major*100-this.minor*10;this.meets=meets}function meets(a){return(!a)?false:this.simpleversion>=Math.round(100*parseFloat(a))}registerHook("ol_content_simple",ol_content_simple,FALTERNATE,CSSOFF);registerHook("ol_content_caption",ol_content_caption,FALTERNATE,CSSOFF);registerHook("ol_content_background",ol_content_background,FALTERNATE,CSSOFF);registerHook("ol_content_simple",ol_content_simple,FALTERNATE,CSSCLASS);registerHook("ol_content_caption",ol_content_caption,FALTERNATE,CSSCLASS);registerHook("ol_content_background",ol_content_background,FALTERNATE,CSSCLASS);registerPostParseFunction(checkPositionFlags);registerHook("hideObject",nbspCleanup,FAFTER);registerHook("horizontalPlacement",horizontalPlacement,FCHAIN);registerHook("verticalPlacement",verticalPlacement,FCHAIN);if(olNs4||(olIe5&&isMac)||olKq){olLoaded=1}registerNoParameterCommands("sticky,autostatus,autostatuscap,fullhtml,hauto,vauto,closeclick,wrap,followmouse,mouseoff,compatmode");var olCheckMouseCapture=true;if((olNs4||olNs6||olIe4)){olMouseCapture()}else{overlib=no_overlib;nd=no_overlib;ver3fix=true}if(typeof olInfo=="undefined"||typeof olInfo.meets=="undefined"||!olInfo.meets(4.1)){alert("overLIB 4.10 or later is required for the Cross Frame Support Plugin.")}else{registerCommands("frame");function parseFrameExtras(a,f,e){var c=f,b;if(c<e.length){if(e[c]==FRAME){b=e[++c];if(a=="ol_"){ol_frame=b}else{opt_FRAME(b)}return c}}return -1}function opt_FRAME(a){o3_frame=a;over=createDivContainer("overDiv");return 0}function frmDepth(a,c){var e="";for(var b=0;b<a.length;b++){if(a[b].length>0){e=frmDepth(a[b],c);if(e==""){continue}}else{if(a[b]!=c){continue}}e="["+b+"]"+e;break}return e}function getFrmRef(e,c){var g="";if(c!=e){var h=frmDepth(top.frames,c);var n=frmDepth(top.frames,e);if(n.length==h.length){l=h.lastIndexOf("[");if(l){while(n.substring(0,l)!=h.substring(0,l)){l=h.lastIndexOf("[",l-1)}h=h.substr(l);n=n.substr(l)}}var b=0,a="",j=h;while((k=j.lastIndexOf("["))!=-1){b++;j=j.substring(0,k)}for(var f=0;f<b;f++){a=a+"parent."}g=a+"frames"+n+"."}return g}function chkForFrmRef(){if(o3_frame!=ol_frame){fnRef=getFrmRef(ol_frame,o3_frame)}return true}registerCmdLineFunction(parseFrameExtras);registerPostParseFunction(chkForFrmRef)}function Node(c,g,a,b,n,h,j,e,f){this.id=c;this.pid=g;this.name=a;this.url=b;this.title=n;this.target=h;this.icon=j;this.iconOpen=e;this._io=f||false;this._is=false;this._ls=false;this._hc=false;this._ai=0;this._p}function dTree(a){this.config={target:null,folderLinks:true,useSelection:true,useCookies:true,useLines:true,useIcons:true,useStatusText:false,closeSameLevel:false,inOrder:false};this.icon={root:"/img/globe.gif",folder:"/img/folder.gif",folderOpen:"/img/folderopen.gif",node:"/img/page.gif",empty:"/img/empty.gif",line:"/img/line.gif",join:"/img/join.gif",joinBottom:"/img/joinbottom.gif",plus:"/img/plus.gif",plusBottom:"/img/plusbottom.gif",minus:"/img/minus.gif",minusBottom:"/img/minusbottom.gif",nlPlus:"/img/nolines_plus.gif",nlMinus:"/img/nolines_minus.gif"};this.obj=a;this.aNodes=[];this.aIndent=[];this.root=new Node(-1);this.selectedNode=null;this.selectedFound=false;this.completed=false}dTree.prototype.add=function(c,g,a,b,n,h,j,e,f){this.aNodes[this.aNodes.length]=new Node(c,g,a,b,n,h,j,e,f)};dTree.prototype.openAll=function(){this.oAll(true)};dTree.prototype.closeAll=function(){this.oAll(false)};dTree.prototype.toString=function(){var a='<div class="dtree">\n';if(document.getElementById){if(this.config.useCookies){this.selectedNode=this.getSelected()}a+=this.addNode(this.root)}else{a+="Browser not supported."}a+="</div>";if(!this.selectedFound){this.selectedNode=null}this.completed=true;return a};dTree.prototype.addNode=function(a){var b="";var e=0;if(this.config.inOrder){e=a._ai}for(e;e<this.aNodes.length;e++){if(this.aNodes[e].pid==a.id){var c=this.aNodes[e];c._p=a;c._ai=e;this.setCS(c);if(!c.target&&this.config.target){c.target=this.config.target}if(c._hc&&!c._io&&this.config.useCookies){c._io=this.isOpen(c.id)}if(!this.config.folderLinks&&c._hc){c.url=null}if(this.config.useSelection&&c.id==this.selectedNode&&!this.selectedFound){c._is=true;this.selectedNode=e;this.selectedFound=true}b+=this.node(c,e);if(c._ls){break}}}return b};dTree.prototype.node=function(a,c){var b='<div class="dTreeNode">'+this.indent(a,c);if(this.config.useIcons){if(!a.icon){a.icon=(this.root.id==a.pid)?this.icon.root:((a._hc)?this.icon.folder:this.icon.node)}if(!a.iconOpen){a.iconOpen=(a._hc)?this.icon.folderOpen:this.icon.node}if(this.root.id==a.pid){a.icon=this.icon.root;a.iconOpen=this.icon.root}b+='<img id="i'+this.obj+c+'" src="'+((a._io)?a.iconOpen:a.icon)+'" alt="" />'}if(a.url){b+='<a id="s'+this.obj+c+'" class="'+((this.config.useSelection)?((a._is?"nodeSel":"node")):"node")+'" href="'+a.url+'"';if(a.title){b+=' title="'+a.title+'"'}if(a.target){b+=' target="'+a.target+'"'}if(this.config.useStatusText){b+=" onmouseover=\"window.status='"+a.name+"';return true;\" onmouseout=\"window.status='';return true;\" "}if(this.config.useSelection&&((a._hc&&this.config.folderLinks)||!a._hc)){b+=' onclick="javascript: '+this.obj+".s("+c+');"'}b+=">"}else{if((!this.config.folderLinks||!a.url)&&a._hc&&a.pid!=this.root.id){b+='<a href="javascript: '+this.obj+".o("+c+');" class="node">'}}b+=a.name;if(a.url||((!this.config.folderLinks||!a.url)&&a._hc)){b+="</a>"}b+="</div>";if(a._hc){b+='<div id="d'+this.obj+c+'" class="clip" style="display:'+((this.root.id==a.pid||a._io)?"block":"none")+';">';b+=this.addNode(a);b+="</div>"}this.aIndent.pop();return b};dTree.prototype.indent=function(a,c){var b="";if(this.root.id!=a.pid){for(var e=0;e<this.aIndent.length;e++){b+='<img src="'+((this.aIndent[e]==1&&this.config.useLines)?this.icon.line:this.icon.empty)+'" alt="" />'}(a._ls)?this.aIndent.push(0):this.aIndent.push(1);if(a._hc){b+='<a href="javascript: '+this.obj+".o("+c+');"><img id="j'+this.obj+c+'" src="';if(!this.config.useLines){b+=(a._io)?this.icon.nlMinus:this.icon.nlPlus}else{b+=((a._io)?((a._ls&&this.config.useLines)?this.icon.minusBottom:this.icon.minus):((a._ls&&this.config.useLines)?this.icon.plusBottom:this.icon.plus))}b+='" alt="" /></a>'}else{b+='<img src="'+((this.config.useLines)?((a._ls)?this.icon.joinBottom:this.icon.join):this.icon.empty)+'" alt="" />'}}return b};dTree.prototype.setCS=function(a){var b;for(var c=0;c<this.aNodes.length;c++){if(this.aNodes[c].pid==a.id){a._hc=true}if(this.aNodes[c].pid==a.pid){b=this.aNodes[c].id}}if(b==a.id){a._ls=true}};dTree.prototype.getSelected=function(){var a=this.getCookie("cs"+this.obj);return(a)?a:null};dTree.prototype.s=function(b){if(!this.config.useSelection){return}var a=this.aNodes[b];if(a._hc&&!this.config.folderLinks){return}if(this.selectedNode!=b){if(this.selectedNode||this.selectedNode==0){eOld=document.getElementById("s"+this.obj+this.selectedNode);eOld.className="node"}eNew=document.getElementById("s"+this.obj+b);eNew.className="nodeSel";this.selectedNode=b;if(this.config.useCookies){this.setCookie("cs"+this.obj,a.id)}}};dTree.prototype.o=function(b){var a=this.aNodes[b];this.nodeStatus(!a._io,b,a._ls);a._io=!a._io;if(this.config.closeSameLevel){this.closeLevel(a)}if(this.config.useCookies){this.updateCookie()}};dTree.prototype.oAll=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b]._hc&&this.aNodes[b].pid!=this.root.id){this.nodeStatus(a,b,this.aNodes[b]._ls);this.aNodes[b]._io=a}}if(this.config.useCookies){this.updateCookie()}};dTree.prototype.openTo=function(b,a,c){if(!c){for(var f=0;f<this.aNodes.length;f++){if(this.aNodes[f].id==b){b=f;break}}}var e=this.aNodes[b];if(e.pid==this.root.id||!e._p){return}e._io=true;e._is=a;if(this.completed&&e._hc){this.nodeStatus(true,e._ai,e._ls)}if(this.completed&&a){this.s(e._ai)}else{if(a){this._sn=e._ai}}this.openTo(e._p._ai,false,true)};dTree.prototype.closeLevel=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b].pid==a.pid&&this.aNodes[b].id!=a.id&&this.aNodes[b]._hc){this.nodeStatus(false,b,this.aNodes[b]._ls);this.aNodes[b]._io=false;this.closeAllChildren(this.aNodes[b])}}};dTree.prototype.closeAllChildren=function(a){for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b].pid==a.id&&this.aNodes[b]._hc){if(this.aNodes[b]._io){this.nodeStatus(false,b,this.aNodes[b]._ls)}this.aNodes[b]._io=false;this.closeAllChildren(this.aNodes[b])}}};dTree.prototype.nodeStatus=function(a,c,b){eDiv=document.getElementById("d"+this.obj+c);eJoin=document.getElementById("j"+this.obj+c);if(this.config.useIcons){eIcon=document.getElementById("i"+this.obj+c);eIcon.src=(a)?this.aNodes[c].iconOpen:this.aNodes[c].icon}eJoin.src=(this.config.useLines)?((a)?((b)?this.icon.minusBottom:this.icon.minus):((b)?this.icon.plusBottom:this.icon.plus)):((a)?this.icon.nlMinus:this.icon.nlPlus);eDiv.style.display=(a)?"block":"none"};dTree.prototype.clearCookie=function(){var a=new Date();var b=new Date(a.getTime()-1000*60*60*24);this.setCookie("co"+this.obj,"cookieValue",b);this.setCookie("cs"+this.obj,"cookieValue",b)};dTree.prototype.setCookie=function(g,f,a,e,b,c){document.cookie=escape(g)+"="+escape(f)+(a?"; expires="+a.toGMTString():"")+(e?"; path="+e:"")+(b?"; domain="+b:"")+(c?"; secure":"")};dTree.prototype.getCookie=function(f){var e="";var b=document.cookie.indexOf(escape(f)+"=");if(b!=-1){var c=b+(escape(f)+"=").length;var a=document.cookie.indexOf(";",c);if(a!=-1){e=unescape(document.cookie.substring(c,a))}else{e=unescape(document.cookie.substring(c))}}return(e)};dTree.prototype.updateCookie=function(){var a="";for(var b=0;b<this.aNodes.length;b++){if(this.aNodes[b]._io&&this.aNodes[b].pid!=this.root.id){if(a){a+="."}a+=this.aNodes[b].id}}this.setCookie("co"+this.obj,a)};dTree.prototype.isOpen=function(c){var b=this.getCookie("co"+this.obj).split(".");for(var a=0;a<b.length;a++){if(b[a]==c){return true}}return false};if(!Array.prototype.push){Array.prototype.push=function array_push(){for(var a=0;a<arguments.length;a++){this[this.length]=arguments[a]}return this.length}}if(!Array.prototype.pop){Array.prototype.pop=function array_pop(){lastElement=this[this.length-1];this.length=Math.max(this.length-1,0);return lastElement}}function Range(){this._value=0;this._minimum=0;this._maximum=100;this._extent=0;this._isChanging=false}Range.prototype.setValue=function(a){a=parseInt(a);if(isNaN(a)){return}if(this._value!=a){if(a+this._extent>this._maximum){this._value=this._maximum-this._extent}else{if(a<this._minimum){this._value=this._minimum}else{this._value=a}}if(!this._isChanging&&typeof this.onchange=="function"){this.onchange()}}};Range.prototype.getValue=function(){return this._value};Range.prototype.setExtent=function(a){if(this._extent!=a){if(a<0){this._extent=0}else{if(this._value+a>this._maximum){this._extent=this._maximum-this._value}else{this._extent=a}}if(!this._isChanging&&typeof this.onchange=="function"){this.onchange()}}};Range.prototype.getExtent=function(){return this._extent};Range.prototype.setMinimum=function(a){if(this._minimum!=a){var b=this._isChanging;this._isChanging=true;this._minimum=a;if(a>this._value){this.setValue(a)}if(a>this._maximum){this._extent=0;this.setMaximum(a);this.setValue(a)}if(a+this._extent>this._maximum){this._extent=this._maximum-this._minimum}this._isChanging=b;if(!this._isChanging&&typeof this.onchange=="function"){this.onchange()}}};Range.prototype.getMinimum=function(){return this._minimum};Range.prototype.setMaximum=function(b){if(this._maximum!=b){var a=this._isChanging;this._isChanging=true;this._maximum=b;if(b<this._value){this.setValue(b-this._extent)}if(b<this._minimum){this._extent=0;this.setMinimum(b);this.setValue(this._maximum)}if(b<this._minimum+this._extent){this._extent=this._maximum-this._minimum}if(b<this._value+this._extent){this._extent=this._maximum-this._value}this._isChanging=a;if(!this._isChanging&&typeof this.onchange=="function"){this.onchange()}}};Range.prototype.getMaximum=function(){return this._maximum};function Timer(a){this._pauseTime=typeof a=="undefined"?1000:a;this._timer=null;this._isStarted=false}Timer.prototype.start=function(){if(this.isStarted()){this.stop()}var a=this;this._timer=window.setTimeout(function(){if(typeof a.ontimer=="function"){a.ontimer()}},this._pauseTime);this._isStarted=false};Timer.prototype.stop=function(){if(this._timer!=null){window.clearTimeout(this._timer)}this._isStarted=false};Timer.prototype.isStarted=function(){return this._isStarted};Timer.prototype.getPauseTime=function(){return this._pauseTime};Timer.prototype.setPauseTime=function(a){this._pauseTime=a};Slider.isSupported=typeof document.createElement!="undefined"&&typeof document.documentElement!="undefined"&&typeof document.documentElement.offsetWidth=="number";function Slider(b,e,c){if(!b){return}this._orientation=c||"horizontal";this._range=new Range();this._range.setExtent(0);this._blockIncrement=10;this._unitIncrement=1;this._timer=new Timer(100);if(Slider.isSupported&&b){this.document=b.ownerDocument||b.document;this.element=b;this.element.slider=this;this.element.unselectable="on";this.element.className=this._orientation+" "+this.classNameTag+" "+this.element.className;this.line=this.document.createElement("DIV");this.line.className="line";this.line.unselectable="on";this.line.appendChild(this.document.createElement("DIV"));this.element.appendChild(this.line);this.handle=this.document.createElement("DIV");this.handle.className="handle";this.handle.unselectable="on";this.handle.appendChild(this.document.createElement("DIV"));this.handle.firstChild.appendChild(this.document.createTextNode(String.fromCharCode(160)));this.element.appendChild(this.handle)}this.input=e;var a=this;this._range.onchange=function(){a.recalculate();if(typeof a.onchange=="function"){a.onchange()}};if(Slider.isSupported&&b){this.element.onfocus=Slider.eventHandlers.onfocus;this.element.onblur=Slider.eventHandlers.onblur;this.element.onmousedown=Slider.eventHandlers.onmousedown;this.element.onmouseover=Slider.eventHandlers.onmouseover;this.element.onmouseout=Slider.eventHandlers.onmouseout;this.element.onkeydown=Slider.eventHandlers.onkeydown;this.element.onkeypress=Slider.eventHandlers.onkeypress;this.element.onmousewheel=Slider.eventHandlers.onmousewheel;this.handle.onselectstart=this.element.onselectstart=function(){return false};this._timer.ontimer=function(){a.ontimer()};window.setTimeout(function(){a.recalculate()},1)}else{this.input.onchange=function(f){a.setValue(a.input.value)}}}Slider.eventHandlers={getEvent:function(b,a){if(!b){if(a){b=a.document.parentWindow.event}else{b=window.event}}if(!b.srcElement){var a=b.target;while(a!=null&&a.nodeType!=1){a=a.parentNode}b.srcElement=a}if(typeof b.offsetX=="undefined"){b.offsetX=b.layerX;b.offsetY=b.layerY}return b},getDocument:function(a){if(a.target){return a.target.ownerDocument}return a.srcElement.document},getSlider:function(b){var a=b.target||b.srcElement;while(a!=null&&a.slider==null){a=a.parentNode}if(a){return a.slider}return null},getLine:function(b){var a=b.target||b.srcElement;while(a!=null&&a.className!="line"){a=a.parentNode}return a},getHandle:function(c){var b=c.target||c.srcElement;var a=/handle/;while(b!=null&&!a.test(b.className)){b=b.parentNode}return b},onfocus:function(b){var a=this.slider;a._focused=true;a.handle.className="handle hover"},onblur:function(b){var a=this.slider;a._focused=false;a.handle.className="handle"},onmouseover:function(b){b=Slider.eventHandlers.getEvent(b,this);var a=this.slider;if(b.srcElement==a.handle){a.handle.className="handle hover"}},onmouseout:function(b){b=Slider.eventHandlers.getEvent(b,this);var a=this.slider;if(b.srcElement==a.handle&&!a._focused){a.handle.className="handle"}},onmousedown:function(f){f=Slider.eventHandlers.getEvent(f,this);var a=this.slider;if(a.element.focus){a.element.focus()}Slider._currentInstance=a;var c=a.document;if(c.addEventListener){c.addEventListener("mousemove",Slider.eventHandlers.onmousemove,true);c.addEventListener("mouseup",Slider.eventHandlers.onmouseup,true)}else{if(c.attachEvent){c.attachEvent("onmousemove",Slider.eventHandlers.onmousemove);c.attachEvent("onmouseup",Slider.eventHandlers.onmouseup);c.attachEvent("onlosecapture",Slider.eventHandlers.onmouseup);a.element.setCapture()}}if(Slider.eventHandlers.getHandle(f)){Slider._sliderDragData={screenX:f.screenX,screenY:f.screenY,dx:f.screenX-a.handle.offsetLeft,dy:f.screenY-a.handle.offsetTop,startValue:a.getValue(),slider:a}}else{var b=Slider.eventHandlers.getLine(f);a._mouseX=f.offsetX+(b?a.line.offsetLeft:0);a._mouseY=f.offsetY+(b?a.line.offsetTop:0);a._increasing=null;a.ontimer()}},onmousemove:function(h){h=Slider.eventHandlers.getEvent(h,this);if(Slider._sliderDragData){var c=Slider._sliderDragData.slider;var a=c.getMaximum()-c.getMinimum();var b,j,g;if(c._orientation=="horizontal"){b=c.element.offsetWidth-c.handle.offsetWidth;j=h.screenX-Slider._sliderDragData.dx;g=Math.abs(h.screenY-Slider._sliderDragData.screenY)>100}else{b=c.element.offsetHeight-c.handle.offsetHeight;j=c.element.offsetHeight-c.handle.offsetHeight-(h.screenY-Slider._sliderDragData.dy);g=Math.abs(h.screenX-Slider._sliderDragData.screenX)>100}c.setValue(g?Slider._sliderDragData.startValue:c.getMinimum()+a*j/b);return false}else{var c=Slider._currentInstance;if(c!=null){var f=Slider.eventHandlers.getLine(h);c._mouseX=h.offsetX+(f?c.line.offsetLeft:0);c._mouseY=h.offsetY+(f?c.line.offsetTop:0)}}},onmouseup:function(c){c=Slider.eventHandlers.getEvent(c,this);var a=Slider._currentInstance;var b=a.document;if(b.removeEventListener){b.removeEventListener("mousemove",Slider.eventHandlers.onmousemove,true);b.removeEventListener("mouseup",Slider.eventHandlers.onmouseup,true)}else{if(b.detachEvent){b.detachEvent("onmousemove",Slider.eventHandlers.onmousemove);b.detachEvent("onmouseup",Slider.eventHandlers.onmouseup);b.detachEvent("onlosecapture",Slider.eventHandlers.onmouseup);a.element.releaseCapture()}}if(Slider._sliderDragData){Slider._sliderDragData=null}else{a._timer.stop();a._increasing=null}Slider._currentInstance=null},onkeydown:function(c){c=Slider.eventHandlers.getEvent(c,this);var b=this.slider;var a=c.keyCode;switch(a){case 33:b.setValue(b.getValue()+b.getBlockIncrement());break;case 34:b.setValue(b.getValue()-b.getBlockIncrement());break;case 35:b.setValue(b.getOrientation()=="horizontal"?b.getMaximum():b.getMinimum());break;case 36:b.setValue(b.getOrientation()=="horizontal"?b.getMinimum():b.getMaximum());break;case 38:case 39:b.setValue(b.getValue()+b.getUnitIncrement());break;case 37:case 40:b.setValue(b.getValue()-b.getUnitIncrement());break}if(a>=33&&a<=40){return false}},onkeypress:function(b){b=Slider.eventHandlers.getEvent(b,this);var a=b.keyCode;if(a>=33&&a<=40){return false}},onmousewheel:function(b){b=Slider.eventHandlers.getEvent(b,this);var a=this.slider;if(a._focused){a.setValue(a.getValue()+b.wheelDelta/120*a.getUnitIncrement());return false}}};Slider.prototype.classNameTag="dynamic-slider-control",Slider.prototype.setValue=function(a){this._range.setValue(a);this.input.value=this.getValue()};Slider.prototype.getValue=function(){return this._range.getValue()};Slider.prototype.setMinimum=function(a){this._range.setMinimum(a);this.input.value=this.getValue()};Slider.prototype.getMinimum=function(){return this._range.getMinimum()};Slider.prototype.setMaximum=function(a){this._range.setMaximum(a);this.input.value=this.getValue()};Slider.prototype.getMaximum=function(){return this._range.getMaximum()};Slider.prototype.setUnitIncrement=function(a){this._unitIncrement=a};Slider.prototype.getUnitIncrement=function(){return this._unitIncrement};Slider.prototype.setBlockIncrement=function(a){this._blockIncrement=a};Slider.prototype.getBlockIncrement=function(){return this._blockIncrement};Slider.prototype.getOrientation=function(){return this._orientation};Slider.prototype.setOrientation=function(a){if(a!=this._orientation){if(Slider.isSupported&&this.element){this.element.className=this.element.className.replace(this._orientation,a)}this._orientation=a;this.recalculate()}};Slider.prototype.recalculate=function(){if(!Slider.isSupported||!this.element){return}var c=this.element.offsetWidth;var f=this.element.offsetHeight;var a=this.handle.offsetWidth;var e=this.handle.offsetHeight;var g=this.line.offsetWidth;var b=this.line.offsetHeight;if(this._orientation=="horizontal"){this.handle.style.left=(c-a)*(this.getValue()-this.getMinimum())/(this.getMaximum()-this.getMinimum())+"px";this.handle.style.top=(f-e)/2+"px";this.line.style.top=(f-b)/2+"px";this.line.style.left=a/2+"px";this.line.style.width=Math.max(0,c-a-2)+"px";this.line.firstChild.style.width=Math.max(0,c-a-4)+"px"}else{this.handle.style.left=(c-a)/2+"px";this.handle.style.top=f-e-(f-e)*(this.getValue()-this.getMinimum())/(this.getMaximum()-this.getMinimum())+"px";this.line.style.left=(c-g)/2+"px";this.line.style.top=e/2+"px";this.line.style.height=Math.max(0,f-e-2)+"px";this.line.firstChild.style.height=Math.max(0,f-e-4)+"px"}};Slider.prototype.ontimer=function(){var b=this.handle.offsetWidth;var e=this.handle.offsetHeight;var a=this.handle.offsetLeft;var c=this.handle.offsetTop;if(this._orientation=="horizontal"){if(this._mouseX>a+b&&(this._increasing==null||this._increasing)){this.setValue(this.getValue()+this.getBlockIncrement());this._increasing=true}else{if(this._mouseX<a&&(this._increasing==null||!this._increasing)){this.setValue(this.getValue()-this.getBlockIncrement());this._increasing=false}}}else{if(this._mouseY>c+e&&(this._increasing==null||!this._increasing)){this.setValue(this.getValue()-this.getBlockIncrement());this._increasing=false}else{if(this._mouseY<c&&(this._increasing==null||this._increasing)){this.setValue(this.getValue()+this.getBlockIncrement());this._increasing=true}}}this._timer.start()};function IE(a,b){if(a.button=="2"||a.button=="3"){s(b);return false}}function NS(a,b){if(document.layers||(document.getElementById&&!document.all)){if(a.which=="2"||a.which=="3"){s(b);return false}}}function objById(b){if(document.getElementById){var a=document.getElementById(b)}else{if(document.all){var a=document.all[b]}else{if(document.layers){var a=document.layers[b]}}}return a}function reverse(b){var a=objById(b);a.checked=!a.checked}function changeCheckState(a,c){if(a){if(a.length&&a.length>0){for(i=0;i<a.length;i++){a[i].checked=c}}else{try{a.checked=c}catch(b){}}}}function checkall(){changeCheckState(document.form1.plot_series,true)}function uncheckall(){changeCheckState(document.form1.plot_series,false)}function modify(){document.form1.submit()}function s(a){uncheckall();reverse(a);modify()}function so(a){s(a)}function switchToAlternate(a){if(a.indexOf("CLEAR")==0){a=a.substring(5);uncheckall()}if(a.indexOf("CLEAN")==0){a=a.substring(5);document.location="display?page="+a}document.form1.page.value=a;document.form1.submit()}function checkallmodules(){changeCheckState(document.form1.modules,true)}function uncheckallmodules(){changeCheckState(document.form1.modules,false)}function matchName(b,a){var c=new RegExp("^(\\d+\\. )?"+b+"$");return a.match(c)}var imgResolutions="1280x700,1024x600,800x550";var imgResDefault="1024x600";function displayImgResOptions(c){if(c.options){var b=imgResolutions.split(",");var a=0;while(a<b.length){c.options[a]=new Option(b[a],b[a]);if(b[a]==imgResDefault){c.options[a].selected=true}a++}}}function setStartPage(){Set_Cookie("lastval_div_indexmap",buri,365,"/","","");alert("Current page was set as your start page for the AliEn Repository")}function showBookmarkWindow(){var a=bookmark.replace(/&/g,"&amp;");showCenteredWindow("<div align=left style='padding-left: 10px; padding-right: 10px; padding-top: 10px'>The <a href=\""+bookmark+'">link</a> to the current page is:<br><br><textarea id=url_area wrap=soft style=\'width:100%; height:100px; font-family: Arial,Verdana,Helvetica,sans; font-size: 10px;\'></textarea><br><a href="JavaScript:shorten()">Short URL</a></div><br><br><a href="JavaScript:setStartPage();">Make this page your start page</a>',"Link to this page");objById("url_area").value=bookmark;return false}var surl;function shortenAction(){r=surl.response.replace(/^\s+|\s+$/g,"");if(/^\d+$/.test(r)){objById("url_area").value=bookmark.substring(0,bookmark.lastIndexOf(buri))+"?"+r}}function shorten(){surl=new sack();surl.method="GET";surl.setVar("path",buri);surl.requestFile="/work/shorturl.jsp";surl.onCompletion=function(){shortenAction()};surl.runAJAX()}function showLink(b,a){document.write('<table width="100%" cellspacing="0" cellpadding="0" border="0" bgcolor="#FFF3F3">');document.write("<tr>");document.write('<td width="5" height="5" align="left" valign="bottom"><img src="/images/center_top_left.jpg" width="5" height="5" border="0"></td>');document.write('<td height="5" width="100%" style="border-top: solid 1px #b5b5bd"><img width="1" height="1"></td>');document.write('<td width="5" height="5" align="right" valign="bottom"><img src="/images/center_top_right.jpg" width="5" height="5" border="0"></td>');document.write("</tr>");document.write("<tr>");document.write('<td width="5" style="border-left: solid 1px #b5b5bd"><img height="1" width="1"></td>');document.write('<td class="text" width="100%">');if(document.all||window.sidebar){document.write('<b>This page: <a class="linkb" title="'+b+'" rel="sidebar" href="#" class="linkmenublue" onclick="return bookmarksite(\''+b+"', '"+a+'\');"">bookmark</a>, <a class="linkb" href="javascript:void(0);" onClick="return showBookmarkWindow();">URL</a>')}else{document.write('<a class="linkb" title="'+b+'" class="linkmenublue" href="'+a+'">Current page</a>')}document.write("</td>");document.write('<td width="5" style="border-right: solid 1px #b5b5bd"><img height="1" width="1"></td>');document.write("</tr>");document.write("<tr>");document.write('<td width="5" height="5" align="left"><img src="/images/center_bottom_left.jpg" width="5" height="5" border="0"></td>');document.write('<td height="5" width="100%" style="border-bottom: solid 1px #b5b5bd"><img width="1" height="1"></td>');document.write('<td width="5" height="5" align="right"><img src="/images/center_bottom_right.jpg" width="5" height="5" border="0"></td>	');document.write("</tr>");document.write("</table>");document.write('<div class="spacer"><!-- // --></div>')}function bookmarksite(b,a){if(document.all&&!window.opera){window.external.AddFavorite(a,b)}else{if(window.sidebar&&sidebar.addPanel){sidebar.addPanel(b,a,"")}else{this.title=b}}return false}function Set_Cookie(c,f,a,j,e,h){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var g=new Date(b.getTime()+(a));document.cookie=c+"="+escape(f)+((a)?";expires="+g.toGMTString():"")+((j)?";path="+j:"")+((e)?";domain="+e:"")+((h)?";secure":"")}function Get_Cookie(c){var e=document.cookie.indexOf(c+"=");var a=e+c.length+1;if((!e)&&(c!=document.cookie.substring(0,c.length))){return null}if(e==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))}function checkDivs(b){for(var a=0;a<b.length;a++){var c=Get_Cookie("lastval_"+b[a]);if(c==1){switchDiv(b[a])}}}function switchDiv(e,c,g){if(!g){g=0.3}var f=objById(e);var b=f.style.display=="none";if(c){new Effect.toggle($(e),"blind",{duration:g});Set_Cookie("lastval_"+e,b?"1":"0",30,"/","","")}else{objById(e).style.display=b?"":"none"}var a=objById(e+"_img");if(a){a.src=b?"/img/dynamic/minus.jpg":"/img/dynamic/plus.jpg"}}function cancelAutoReload(){if(autoReloadArmed){clearTimeout(autoReloadTimeout);autoReloadArmed=false}}function rearmAutoReload(){if(!autoReloadConfigured){autoReloadTimeout=window.setTimeout("modify()",refreshAfter);autoReloadArmed=true}}function setMinWidth(b,a){if(b.clientWidth<a){b.style.width=a+"px"}}function setWidth(b,a){b.style.width=a}function focusText(b,a){setMinWidth(b,a);b.style.background="yellow"}function blurText(a){setWidth(a,"100%");a.style.background="#F6F6F6"}function extendBoxes(){forEach(document.getElementsByTagName("input"),function(a){if(a.className.search(/\bextendable\b/)!=-1){blurText(a)}})}var NUM_CENTYEAR=30;var BUL_TIMECOMPONENT=false;var BUL_YEARSCROLL=true;var calendars=[];var RE_NUM=/^\-?\d+$/;function calendar1(a){this.gen_date=cal_gen_date1;this.gen_time=cal_gen_time1;this.gen_tsmp=cal_gen_tsmp1;this.prs_date=cal_prs_date1;this.prs_time=cal_prs_time1;this.prs_tsmp=cal_prs_tsmp1;this.popup=cal_popup1;this.irecalc=recalc;if(!a){return cal_error("Error calling the calendar: no target control specified")}if(a.value==null){return cal_error("Error calling the calendar: parameter specified is not valid target control")}this.target=a;this.time_comp=BUL_TIMECOMPONENT;this.year_scroll=BUL_YEARSCROLL;this.id=calendars.length;calendars[this.id]=this}function cal_popup1(b){this.dt_current=this.prs_tsmp(b?b:this.target.value);if(!this.dt_current){return}var a=window.open("/calendar.html?datetime="+this.dt_current.valueOf()+"&id="+this.id,"Calendar","width=200,height="+(this.time_comp?215:190)+",status=no,resizable=no,top=200,left=200,dependent=yes,alwaysRaised=yes");a.opener=window;a.focus()}function cal_gen_tsmp1(a){return(this.gen_date(a)+" "+this.gen_time(a))}function cal_gen_date1(a){return((a.getDate()<10?"0":"")+a.getDate()+"-"+(a.getMonth()<9?"0":"")+(a.getMonth()+1)+"-"+a.getFullYear())}function cal_gen_time1(a){return((a.getHours()<10?"0":"")+a.getHours()+":"+(a.getMinutes()<10?"0":"")+(a.getMinutes())+":"+(a.getSeconds()<10?"0":"")+(a.getSeconds()))}function cal_prs_tsmp1(b){if(!b){return(new Date())}if(RE_NUM.exec(b)){return new Date(b)}var a=b.split(" ");return this.prs_time(a[1],this.prs_date(a[0]))}function cal_prs_date1(c){var e=c.split("-");if(e.length!=3){return cal_error("Invalid date format: '"+c+"'.\nFormat accepted is dd-mm-yyyy.")}if(!e[0]){return cal_error("Invalid date format: '"+c+"'.\nNo day of month value can be found.")}if(!RE_NUM.exec(e[0])){return cal_error("Invalid day of month value: '"+e[0]+"'.\nAllowed values are unsigned integers.")}if(!e[1]){return cal_error("Invalid date format: '"+c+"'.\nNo month value can be found.")}if(!RE_NUM.exec(e[1])){return cal_error("Invalid month value: '"+e[1]+"'.\nAllowed values are unsigned integers.")}if(!e[2]){return cal_error("Invalid date format: '"+c+"'.\nNo year value can be found.")}if(!RE_NUM.exec(e[2])){return cal_error("Invalid year value: '"+e[2]+"'.\nAllowed values are unsigned integers.")}var b=new Date();b.setDate(1);if(e[1]<1||e[1]>12){return cal_error("Invalid month value: '"+e[1]+"'.\nAllowed range is 01-12.")}b.setMonth(e[1]-1);if(e[2]<100){e[2]=Number(e[2])+(e[2]<NUM_CENTYEAR?2000:1900)}b.setFullYear(e[2]);var a=new Date(e[2],e[1],0);b.setDate(e[0]);if(b.getMonth()!=(e[1]-1)){return cal_error("Invalid day of month value: '"+e[0]+"'.\nAllowed range is 01-"+a.getDate()+".")}return(b)}function cal_prs_time1(a,c){if(!c){return null}var b=String(a?a:"").split(":");if(!b[0]){c.setHours(0)}else{if(RE_NUM.exec(b[0])){if(b[0]<24){c.setHours(b[0])}else{return cal_error("Invalid hours value: '"+b[0]+"'.\nAllowed range is 00-23.")}}else{return cal_error("Invalid hours value: '"+b[0]+"'.\nAllowed values are unsigned integers.")}}if(!b[1]){c.setMinutes(0)}else{if(RE_NUM.exec(b[1])){if(b[1]<60){c.setMinutes(b[1])}else{return cal_error("Invalid minutes value: '"+b[1]+"'.\nAllowed range is 00-59.")}}else{return cal_error("Invalid minutes value: '"+b[1]+"'.\nAllowed values are unsigned integers.")}}if(!b[2]){c.setSeconds(0)}else{if(RE_NUM.exec(b[2])){if(b[2]<60){c.setSeconds(b[2])}else{return cal_error("Invalid seconds value: '"+b[2]+"'.\nAllowed range is 00-59.")}}else{return cal_error("Invalid seconds value: '"+b[2]+"'.\nAllowed values are unsigned integers.")}}c.setMilliseconds(0);return c}function cal_error(a){alert(a);return null}var Prototype={Version:"1.5.1_rc3",Browser:{IE:!!(window.attachEvent&&!window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1},BrowserFeatures:{XPath:!!document.evaluate,ElementExtensions:!!window.HTMLElement,SpecificElementExtensions:(document.createElement("div").__proto__!==document.createElement("form").__proto__)},ScriptFragment:"<script[^>]*>([\u0001-\uFFFF]*?)<\/script>",JSONFilter:/^\/\*-secure-\s*(.*)\s*\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};var Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};var Abstract=new Object();Object.extend=function(a,c){for(var b in c){a[b]=c[b]}return a};Object.extend(Object,{inspect:function(a){try{if(a===undefined){return"undefined"}if(a===null){return"null"}return a.inspect?a.inspect():a.toString()}catch(b){if(b instanceof RangeError){return"..."}throw b}},toJSON:function(a){var c=typeof a;switch(c){case"undefined":case"function":case"unknown":return;case"boolean":return a.toString()}if(a===null){return"null"}if(a.toJSON){return a.toJSON()}if(a.ownerDocument===document){return}var b=[];for(var f in a){var e=Object.toJSON(a[f]);if(e!==undefined){b.push(f.toJSON()+": "+e)}}return"{"+b.join(", ")+"}"},keys:function(a){var b=[];for(var c in a){b.push(c)}return b},values:function(b){var a=[];for(var c in b){a.push(b[c])}return a},clone:function(a){return Object.extend({},a)}});Function.prototype.bind=function(){var a=this,c=$A(arguments),b=c.shift();return function(){return a.apply(b,c.concat($A(arguments)))}};Function.prototype.bindAsEventListener=function(c){var a=this,b=$A(arguments),c=b.shift();return function(e){return a.apply(c,[(e||window.event)].concat(b).concat($A(arguments)))}};Object.extend(Number.prototype,{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(a){$R(0,this,true).each(a);return this},toPaddedString:function(c,b){var a=this.toString(b||10);return"0".times(c-a.length)+a},toJSON:function(){return isFinite(this)?this.toString():"null"}});Date.prototype.toJSON=function(){return'"'+this.getFullYear()+"-"+(this.getMonth()+1).toPaddedString(2)+"-"+this.getDate().toPaddedString(2)+"T"+this.getHours().toPaddedString(2)+":"+this.getMinutes().toPaddedString(2)+":"+this.getSeconds().toPaddedString(2)+'"'};var Try={these:function(){var c;for(var b=0,f=arguments.length;b<f;b++){var a=arguments[b];try{c=a();break}catch(g){}}return c}};var PeriodicalExecuter=Class.create();PeriodicalExecuter.prototype={initialize:function(b,a){this.callback=b;this.frequency=a;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.callback(this)}finally{this.currentlyExecuting=false}}}};Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,{gsub:function(f,c){var a="",e=this,b;c=arguments.callee.prepareReplacement(c);while(e.length>0){if(b=e.match(f)){a+=e.slice(0,b.index);a+=String.interpret(c(b));e=e.slice(b.index+b[0].length)}else{a+=e,e=""}}return a},sub:function(c,a,b){a=this.gsub.prepareReplacement(a);b=b===undefined?1:b;return this.gsub(c,function(e){if(--b<0){return e[0]}return a(e)})},scan:function(b,a){this.gsub(b,a);return this},truncate:function(b,a){b=b||30;a=a===undefined?"...":a;return this.length>b?this.slice(0,b-a.length)+a:this},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")},extractScripts:function(){var b=new RegExp(Prototype.ScriptFragment,"img");var a=new RegExp(Prototype.ScriptFragment,"im");return(this.match(b)||[]).map(function(c){return(c.match(a)||["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(script){return eval(script)})},escapeHTML:function(){var a=arguments.callee;a.text.data=this;return a.div.innerHTML},unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags();return a.childNodes[0]?(a.childNodes.length>1?$A(a.childNodes).inject("",function(b,c){return b+c.nodeValue}):a.childNodes[0].nodeValue):""},toQueryParams:function(b){var a=this.strip().match(/([^?#]*)(#.*)?$/);if(!a){return{}}return a[1].split(b||"&").inject({},function(f,g){if((g=g.split("="))[0]){var c=decodeURIComponent(g.shift());var e=g.length>1?g.join("="):g[0];if(e!=undefined){e=decodeURIComponent(e)}if(c in f){if(f[c].constructor!=Array){f[c]=[f[c]]}f[c].push(e)}else{f[c]=e}}return f})},toArray:function(){return this.split("")},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)},times:function(c){var a="";for(var b=0;b<c;b++){a+=this}return a},camelize:function(){var e=this.split("-"),a=e.length;if(a==1){return e[0]}var c=this.charAt(0)=="-"?e[0].charAt(0).toUpperCase()+e[0].substring(1):e[0];for(var b=1;b<a;b++){c+=e[b].charAt(0).toUpperCase()+e[b].substring(1)}return c},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscore:function(){return this.gsub(/::/,"/").gsub(/([A-Z]+)([A-Z][a-z])/,"#{1}_#{2}").gsub(/([a-z\d])([A-Z])/,"#{1}_#{2}").gsub(/-/,"_").toLowerCase()},dasherize:function(){return this.gsub(/_/,"-")},inspect:function(b){var a=this.gsub(/[\x00-\x1f\\]/,function(c){var e=String.specialChar[c[0]];return e?e:"\\u00"+c[0].charCodeAt().toPaddedString(2,16)});if(b){return'"'+a.replace(/"/g,'\\"')+'"'}return"'"+a.replace(/'/g,"\\'")+"'"},toJSON:function(){return this.inspect(true)},unfilterJSON:function(a){return this.sub(a||Prototype.JSONFilter,"#{1}")},evalJSON:function(sanitize){var json=this.unfilterJSON();try{if(!sanitize||(/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(json))){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())},include:function(a){return this.indexOf(a)>-1},startsWith:function(a){return this.indexOf(a)===0},endsWith:function(a){var b=this.length-a.length;return b>=0&&this.lastIndexOf(a)===b},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)}});if(Prototype.Browser.WebKit||Prototype.Browser.IE){Object.extend(String.prototype,{escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}})}String.prototype.gsub.prepareReplacement=function(b){if(typeof b=="function"){return b}var a=new Template(b);return function(c){return a.evaluate(c)}};String.prototype.parseQuery=String.prototype.toQueryParams;Object.extend(String.prototype.escapeHTML,{div:document.createElement("div"),text:document.createTextNode("")});with(String.prototype.escapeHTML){div.appendChild(text)}var Template=Class.create();Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;Template.prototype={initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){return this.template.gsub(this.pattern,function(b){var c=b[1];if(c=="\\"){return b[2]}return c+String.interpret(a[b[3]])})}};var $break=new Object();var $continue=new Object();var Enumerable={each:function(b){var a=0;try{this._each(function(e){b(e,a++)})}catch(c){if(c!=$break){throw c}}return this},eachSlice:function(c,b){var a=-c,e=[],f=this.toArray();while((a+=c)<f.length){e.push(f.slice(a,a+c))}return e.map(b)},all:function(b){var a=true;this.each(function(e,c){a=a&&!!(b||Prototype.K)(e,c);if(!a){throw $break}});return a},any:function(b){var a=false;this.each(function(e,c){if(a=!!(b||Prototype.K)(e,c)){throw $break}});return a},collect:function(b){var a=[];this.each(function(e,c){a.push((b||Prototype.K)(e,c))});return a},detect:function(b){var a;this.each(function(e,c){if(b(e,c)){a=e;throw $break}});return a},findAll:function(b){var a=[];this.each(function(e,c){if(b(e,c)){a.push(e)}});return a},grep:function(c,b){var a=[];this.each(function(g,f){var e=g.toString();if(e.match(c)){a.push((b||Prototype.K)(g,f))}});return a},include:function(a){var b=false;this.each(function(c){if(c==a){b=true;throw $break}});return b},inGroupsOf:function(b,a){a=a===undefined?null:a;return this.eachSlice(b,function(c){while(c.length<b){c.push(a)}return c})},inject:function(a,b){this.each(function(e,c){a=b(a,e,c)});return a},invoke:function(b){var a=$A(arguments).slice(1);return this.map(function(c){return c[b].apply(c,a)})},max:function(b){var a;this.each(function(e,c){e=(b||Prototype.K)(e,c);if(a==undefined||e>=a){a=e}});return a},min:function(b){var a;this.each(function(e,c){e=(b||Prototype.K)(e,c);if(a==undefined||e<a){a=e}});return a},partition:function(c){var b=[],a=[];this.each(function(f,e){((c||Prototype.K)(f,e)?b:a).push(f)});return[b,a]},pluck:function(b){var a=[];this.each(function(e,c){a.push(e[b])});return a},reject:function(b){var a=[];this.each(function(e,c){if(!b(e,c)){a.push(e)}});return a},sortBy:function(a){return this.map(function(c,b){return{value:c,criteria:a(c,b)}}).sort(function(g,f){var e=g.criteria,c=f.criteria;return e<c?-1:e>c?1:0}).pluck("value")},toArray:function(){return this.map()},zip:function(){var b=Prototype.K,a=$A(arguments);if(typeof a.last()=="function"){b=a.pop()}var c=[this].concat(a).map($A);return this.map(function(f,e){return b(c.pluck(e))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+this.toArray().inspect()+">"}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray});var $A=Array.from=function(e){if(!e){return[]}if(e.toArray){return e.toArray()}else{var b=[];for(var a=0,c=e.length;a<c;a++){b.push(e[a])}return b}};if(Prototype.Browser.WebKit){$A=Array.from=function(e){if(!e){return[]}if(!(typeof e=="function"&&e=="[object NodeList]")&&e.toArray){return e.toArray()}else{var b=[];for(var a=0,c=e.length;a<c;a++){b.push(e[a])}return b}}}Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse){Array.prototype._reverse=Array.prototype.reverse}Object.extend(Array.prototype,{_each:function(b){for(var a=0,c=this.length;a<c;a++){b(this[a])}},clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(a){return a!=null})},flatten:function(){return this.inject([],function(b,a){return b.concat(a&&a.constructor==Array?a.flatten():[a])})},without:function(){var a=$A(arguments);return this.select(function(b){return !a.include(b)})},indexOf:function(a){for(var b=0,c=this.length;b<c;b++){if(this[b]==a){return b}}return -1},reverse:function(a){return(a!==false?this:this.toArray())._reverse()},reduce:function(){return this.length>1?this:this[0]},uniq:function(a){return this.inject([],function(e,c,b){if(0==b||(a?e.last()!=c:!e.include(c))){e.push(c)}return e})},clone:function(){return[].concat(this)},size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"},toJSON:function(){var a=[];this.each(function(b){var c=Object.toJSON(b);if(c!==undefined){a.push(c)}});return"["+a.join(", ")+"]"}});Array.prototype.toArray=Array.prototype.clone;function $w(a){a=a.strip();return a?a.split(/\s+/):[]}if(Prototype.Browser.Opera){Array.prototype.concat=function(){var f=[];for(var b=0,c=this.length;b<c;b++){f.push(this[b])}for(var b=0,c=arguments.length;b<c;b++){if(arguments[b].constructor==Array){for(var a=0,e=arguments[b].length;a<e;a++){f.push(arguments[b][a])}}else{f.push(arguments[b])}}return f}}var Hash=function(a){if(a instanceof Hash){this.merge(a)}else{Object.extend(this,a||{})}};Object.extend(Hash,{toQueryString:function(b){var a=[];a.add=arguments.callee.addPair;this.prototype._each.call(b,function(e){if(!e.key){return}var c=e.value;if(c&&typeof c=="object"){if(c.constructor==Array){c.each(function(f){a.add(e.key,f)})}return}a.add(e.key,c)});return a.join("&")},toJSON:function(a){var b=[];this.prototype._each.call(a,function(e){var c=Object.toJSON(e.value);if(c!==undefined){b.push(e.key.toJSON()+": "+c)}});return"{"+b.join(", ")+"}"}});Hash.toQueryString.addPair=function(a,c,b){a=encodeURIComponent(a);if(c===undefined){this.push(a)}else{this.push(a+"="+(c==null?"":encodeURIComponent(c)))}};Object.extend(Hash.prototype,Enumerable);Object.extend(Hash.prototype,{_each:function(b){for(var a in this){var c=this[a];if(c&&c==Hash.prototype[a]){continue}var e=[a,c];e.key=a;e.value=c;b(e)}},keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},merge:function(a){return $H(a).inject(this,function(b,c){b[c.key]=c.value;return b})},remove:function(){var a;for(var b=0,c=arguments.length;b<c;b++){var e=this[arguments[b]];if(e!==undefined){if(a===undefined){a=e}else{if(a.constructor!=Array){a=[a]}a.push(e)}}delete this[arguments[b]]}return a},toQueryString:function(){return Hash.toQueryString(this)},inspect:function(){return"#<Hash:{"+this.map(function(a){return a.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:function(){return Hash.toJSON(this)}});function $H(a){if(a instanceof Hash){return a}return new Hash(a)}if(function(){var a=0,c=function(e){this.key=e};c.prototype.key="foo";for(var b in new c("bar")){a++}return a>1}()){Hash.prototype._each=function(c){var a=[];for(var b in this){var e=this[b];if((e&&e==Hash.prototype[b])||a.include(b)){continue}a.push(b);var f=[b,e];f.key=b;f.value=e;c(f)}}}ObjectRange=Class.create();Object.extend(ObjectRange.prototype,Enumerable);Object.extend(ObjectRange.prototype,{initialize:function(c,a,b){this.start=c;this.end=a;this.exclusive=b},_each:function(a){var b=this.start;while(this.include(b)){a(b);b=b.succ()}},include:function(a){if(a<this.start){return false}if(this.exclusive){return a<this.end}return a<=this.end}});var $R=function(c,a,b){return new ObjectRange(c,a,b)};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){if(!this.include(a)){this.responders.push(a)}},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(e,b,c,a){this.each(function(f){if(typeof f[e]=="function"){try{f[e].apply(f,[b,c,a])}catch(g){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=function(){};Ajax.Base.prototype={setOptions:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:""};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(typeof this.options.parameters=="string"){this.options.parameters=this.options.parameters.toQueryParams()}}};Ajax.Request=Class.create();Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Request.prototype=Object.extend(new Ajax.Base(),{_complete:false,initialize:function(b,a){this.transport=Ajax.getTransport();this.setOptions(a);this.request(b)},request:function(a){this.url=a;this.method=this.options.method;var c=Object.clone(this.options.parameters);if(!["get","post"].include(this.method)){c._method=this.method;this.method="post"}this.parameters=c;if(c=Hash.toQueryString(c)){if(this.method=="get"){this.url+=(this.url.include("?")?"&":"?")+c}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){c+="&_="}}}try{if(this.options.onCreate){this.options.onCreate(this.transport)}Ajax.Responders.dispatch("onCreate",this,this.transport);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){setTimeout(function(){this.respondToReadyState(1)}.bind(this),10)}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||c):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(b){this.dispatchException(b)}},onStateChange:function(){var a=this.transport.readyState;if(a>1&&!((a==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var f={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){f["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){f.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var c=this.options.requestHeaders;if(typeof c.push=="function"){for(var b=0,e=c.length;b<e;b+=2){f[c[b]]=c[b+1]}}else{$H(c).each(function(g){f[g.key]=g.value})}}for(var a in f){this.transport.setRequestHeader(a,f[a])}},success:function(){return !this.transport.status||(this.transport.status>=200&&this.transport.status<300)},respondToReadyState:function(a){var c=Ajax.Request.Events[a];var h=this.transport,b=this.evalJSON();if(c=="Complete"){try{this._complete=true;(this.options["on"+this.transport.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(h,b)}catch(f){this.dispatchException(f)}var g=this.getHeader("Content-type");if(g&&g.strip().match(/^(text|application)\/(x-)?(java|ecma)script(;.*)?$/i)){this.evalResponse()}}try{(this.options["on"+c]||Prototype.emptyFunction)(h,b);Ajax.Responders.dispatch("on"+c,this,h,b)}catch(f){this.dispatchException(f)}if(c=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction}},getHeader:function(a){try{return this.transport.getResponseHeader(a)}catch(b){return null}},evalJSON:function(){try{var a=this.getHeader("X-JSON");return a?a.evalJSON():null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Updater=Class.create();Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(a,c,b){this.container={success:(a.success||a),failure:(a.failure||(a.success?null:a))};this.transport=Ajax.getTransport();this.setOptions(b);var e=this.options.onComplete||Prototype.emptyFunction;this.options.onComplete=(function(g,f){this.updateContent();e(g,f)}).bind(this);this.request(c)},updateContent:function(){var b=this.container[this.success()?"success":"failure"];var a=this.transport.responseText;if(!this.options.evalScripts){a=a.stripScripts()}if(b=$(b)){if(this.options.insertion){new this.options.insertion(b,a)}else{b.update(a)}}if(this.success()){if(this.onComplete){setTimeout(this.onComplete.bind(this),10)}}}});Ajax.PeriodicalUpdater=Class.create();Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Base(),{initialize:function(a,c,b){this.setOptions(b);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=a;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(a){if(this.options.decay){this.decay=(a.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=a.responseText}this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1000)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});function $(b){if(arguments.length>1){for(var a=0,e=[],c=arguments.length;a<c;a++){e.push($(arguments[a]))}return e}if(typeof b=="string"){b=document.getElementById(b)}return Element.extend(b)}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(g,a){var c=[];var f=document.evaluate(g,$(a)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var b=0,e=f.snapshotLength;b<e;b++){c.push(f.snapshotItem(b))}return c};document.getElementsByClassName=function(b,a){var c=".//*[contains(concat(' ', @class, ' '), ' "+b+" ')]";return document._getElementsByXPath(c,a)}}else{document.getElementsByClassName=function(e,a){var c=($(a)||document.body).getElementsByTagName("*");var g=[],h;for(var b=0,f=c.length;b<f;b++){h=c[b];if(Element.hasClassName(h,e)){g.push(Element.extend(h))}}return g}}if(!window.Element){var Element={}}Element.extend=function(f){var g=Prototype.BrowserFeatures;if(!f||!f.tagName||f.nodeType==3||f._extended||g.SpecificElementExtensions||f==window){return f}var b={},e=f.tagName,a=Element.extend.cache,c=Element.Methods.ByTag;if(!g.ElementExtensions){Object.extend(b,Element.Methods),Object.extend(b,Element.Methods.Simulated)}if(c[e]){Object.extend(b,c[e])}for(var j in b){var h=b[j];if(typeof h=="function"&&!(j in f)){f[j]=a.findOrStore(h)}}f._extended=Prototype.emptyFunction;return f};Element.extend.cache={findOrStore:function(a){return this[a]=this[a]||function(){return a.apply(null,[this].concat($A(arguments)))}}};Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){$(a).style.display="none";return a},show:function(a){$(a).style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(b,a){a=typeof a=="undefined"?"":a.toString();$(b).innerHTML=a.stripScripts();setTimeout(function(){a.evalScripts()},10);return b},replace:function(c,b){c=$(c);b=typeof b=="undefined"?"":b.toString();if(c.outerHTML){c.outerHTML=b.stripScripts()}else{var a=c.ownerDocument.createRange();a.selectNodeContents(c);c.parentNode.replaceChild(a.createContextualFragment(b.stripScripts()),c)}setTimeout(function(){b.evalScripts()},10);return c},inspect:function(b){b=$(b);var a="<"+b.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(g){var f=g.first(),c=g.last();var e=(b[f]||"").toString();if(e){a+=" "+c+"="+e.inspect(true)}});return a+">"},recursivelyCollect:function(a,c){a=$(a);var b=[];while(a=a[c]){if(a.nodeType==1){b.push(Element.extend(a))}}return b},ancestors:function(a){return $(a).recursivelyCollect("parentNode")},descendants:function(a){return $A($(a).getElementsByTagName("*")).each(Element.extend)},firstDescendant:function(a){a=$(a).firstChild;while(a&&a.nodeType!=1){a=a.nextSibling}return $(a)},immediateDescendants:function(a){if(!(a=$(a).firstChild)){return[]}while(a&&a.nodeType!=1){a=a.nextSibling}if(a){return[a].concat($(a).nextSiblings())}return[]},previousSiblings:function(a){return $(a).recursivelyCollect("previousSibling")},nextSiblings:function(a){return $(a).recursivelyCollect("nextSibling")},siblings:function(a){a=$(a);return a.previousSiblings().reverse().concat(a.nextSiblings())},match:function(b,a){if(typeof a=="string"){a=new Selector(a)}return a.match($(b))},up:function(b,e,a){b=$(b);if(arguments.length==1){return $(b.parentNode)}var c=b.ancestors();return e?Selector.findElement(c,e,a):c[a||0]},down:function(b,c,a){b=$(b);if(arguments.length==1){return b.firstDescendant()}var e=b.descendants();return c?Selector.findElement(e,c,a):e[a||0]},previous:function(b,e,a){b=$(b);if(arguments.length==1){return $(Selector.handlers.previousElementSibling(b))}var c=b.previousSiblings();return e?Selector.findElement(c,e,a):c[a||0]},next:function(c,e,b){c=$(c);if(arguments.length==1){return $(Selector.handlers.nextElementSibling(c))}var a=c.nextSiblings();return e?Selector.findElement(a,e,b):a[b||0]},getElementsBySelector:function(){var a=$A(arguments),b=$(a.shift());return Selector.findChildElements(b,a)},getElementsByClassName:function(a,b){return document.getElementsByClassName(b,a)},readAttribute:function(c,a){c=$(c);if(Prototype.Browser.IE){if(!c.attributes){return null}var b=Element._attributeTranslations;if(b.values[a]){return b.values[a](c,a)}if(b.names[a]){a=b.names[a]}var e=c.attributes[a];return e?e.nodeValue:null}return c.getAttribute(a)},getHeight:function(a){return $(a).getDimensions().height},getWidth:function(a){return $(a).getDimensions().width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(!(a=$(a))){return}var c=a.className;if(c.length==0){return false}if(c==b||c.match(new RegExp("(^|\\s)"+b+"(\\s|$)"))){return true}return false},addClassName:function(a,b){if(!(a=$(a))){return}Element.classNames(a).add(b);return a},removeClassName:function(a,b){if(!(a=$(a))){return}Element.classNames(a).remove(b);return a},toggleClassName:function(a,b){if(!(a=$(a))){return}Element.classNames(a)[a.hasClassName(b)?"remove":"add"](b);return a},observe:function(){Event.observe.apply(Event,arguments);return $A(arguments).first()},stopObserving:function(){Event.stopObserving.apply(Event,arguments);return $A(arguments).first()},cleanWhitespace:function(b){b=$(b);var c=b.firstChild;while(c){var a=c.nextSibling;if(c.nodeType==3&&!/\S/.test(c.nodeValue)){b.removeChild(c)}c=a}return b},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(b,a){b=$(b),a=$(a);while(b=b.parentNode){if(b==a){return true}}return false},scrollTo:function(a){a=$(a);var b=Position.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(b,c){b=$(b);c=c=="float"?"cssFloat":c.camelize();var e=b.style[c];if(!e){var a=document.defaultView.getComputedStyle(b,null);e=a?a[c]:null}if(c=="opacity"){return e?parseFloat(e):1}return e=="auto"?null:e},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,c,b){a=$(a);var f=a.style;for(var e in c){if(e=="opacity"){a.setOpacity(c[e])}else{f[(e=="float"||e=="cssFloat")?(f.styleFloat===undefined?"cssFloat":"styleFloat"):(b?e:e.camelize())]=c[e]}}return a},setOpacity:function(a,b){a=$(a);a.style.opacity=(b==1||b==="")?"":(b<0.00001)?0:b;return a},getDimensions:function(c){c=$(c);var h=$(c).getStyle("display");if(h!="none"&&h!=null){return{width:c.offsetWidth,height:c.offsetHeight}}var b=c.style;var g=b.visibility;var e=b.position;var a=b.display;b.visibility="hidden";b.position="absolute";b.display="block";var j=c.clientWidth;var f=c.clientHeight;b.display=a;b.position=e;b.visibility=g;return{width:j,height:f}},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(window.opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow){return a}a._overflow=a.style.overflow||"auto";if((Element.getStyle(a,"overflow")||"visible")!="hidden"){a.style.overflow="hidden"}return a},undoClipping:function(a){a=$(a);if(!a._overflow){return a}a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a}};Object.extend(Element.Methods,{childOf:Element.Methods.descendantOf,childElements:Element.Methods.immediateDescendants});if(Prototype.Browser.Opera){Element.Methods._getStyle=Element.Methods.getStyle;Element.Methods.getStyle=function(a,b){switch(b){case"left":case"top":case"right":case"bottom":if(Element._getStyle(a,"position")=="static"){return null}default:return Element._getStyle(a,b)}}}else{if(Prototype.Browser.IE){Element.Methods.getStyle=function(a,b){a=$(a);b=(b=="float"||b=="cssFloat")?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle){c=a.currentStyle[b]}if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/)){if(c[1]){return parseFloat(c[1])/100}}return 1}if(c=="auto"){if((b=="width"||b=="height")&&(a.getStyle("display")!="none")){return a["offset"+b.capitalize()]+"px"}return null}return c};Element.Methods.setOpacity=function(a,e){a=$(a);var c=a.getStyle("filter"),b=a.style;if(e==1||e===""){b.filter=c.replace(/alpha\([^\)]*\)/gi,"");return a}else{if(e<0.00001){e=0}}b.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+(e*100)+")";return a};Element.Methods.update=function(c,b){c=$(c);b=typeof b=="undefined"?"":b.toString();var a=c.tagName.toUpperCase();if(["THEAD","TBODY","TR","TD"].include(a)){var e=document.createElement("div");switch(a){case"THEAD":case"TBODY":e.innerHTML="<table><tbody>"+b.stripScripts()+"</tbody></table>";depth=2;break;case"TR":e.innerHTML="<table><tbody><tr>"+b.stripScripts()+"</tr></tbody></table>";depth=3;break;case"TD":e.innerHTML="<table><tbody><tr><td>"+b.stripScripts()+"</td></tr></tbody></table>";depth=4}$A(c.childNodes).each(function(f){c.removeChild(f)});depth.times(function(){e=e.firstChild});$A(e.childNodes).each(function(f){c.appendChild(f)})}else{c.innerHTML=b.stripScripts()}setTimeout(function(){b.evalScripts()},10);return c}}else{if(Prototype.Browser.Gecko){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=(b==1)?0.999999:(b==="")?"":(b<0.00001)?0:b;return a}}}}Element._attributeTranslations={names:{colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",datetime:"dateTime",accesskey:"accessKey",tabindex:"tabIndex",enctype:"encType",maxlength:"maxLength",readonly:"readOnly",longdesc:"longDesc"},values:{_getAttr:function(a,b){return a.getAttribute(b,2)},_flag:function(a,b){return $(a).hasAttribute(b)?b:null},style:function(a){return a.style.cssText.toLowerCase()},title:function(a){var b=a.getAttributeNode("title");return b.specified?b.nodeValue:null}}};(function(){Object.extend(this,{href:this._getAttr,src:this._getAttr,disabled:this._flag,checked:this._flag,readonly:this._flag,multiple:this._flag})}).call(Element._attributeTranslations.values);Element.Methods.Simulated={hasAttribute:function(b,e){var a=Element._attributeTranslations,c;e=a.names[e]||e;c=$(b).getAttributeNode(e);return c&&c.specified}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);if(!Prototype.BrowserFeatures.ElementExtensions&&document.createElement("div").__proto__){window.HTMLElement={};window.HTMLElement.prototype=document.createElement("div").__proto__;Prototype.BrowserFeatures.ElementExtensions=true}Element.hasAttribute=function(a,b){if(a.hasAttribute){return a.hasAttribute(b)}return Element.Methods.Simulated.hasAttribute(a,b)};Element.addMethods=function(c){var j=Prototype.BrowserFeatures,e=Element.Methods.ByTag;if(arguments.length==2){var b=c;c=arguments[1]}if(!b){Object.extend(Element.Methods,c||{})}else{if(b.constructor==Array){b.each(h)}else{h(b)}}function h(o){o=o.toUpperCase();if(!Element.Methods.ByTag[o]){Element.Methods.ByTag[o]={}}Object.extend(Element.Methods.ByTag[o],c)}function a(t,p,o){o=o||false;var q=Element.extend.cache;for(var v in t){var u=t[v];if(!o||!(v in p)){p[v]=q.findOrStore(u)}}}function f(q){var o;var p={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(p[q]){o="HTML"+p[q]+"Element"}if(window[o]){return window[o]}o="HTML"+q+"Element";if(window[o]){return window[o]}o="HTML"+q.capitalize()+"Element";if(window[o]){return window[o]}window[o]={};window[o].prototype=document.createElement(q).__proto__;return window[o]}if(j.ElementExtensions){a(Element.Methods,HTMLElement.prototype);a(Element.Methods.Simulated,HTMLElement.prototype,true)}if(j.SpecificElementExtensions){for(var n in Element.Methods.ByTag){var g=f(n);if(typeof g=="undefined"){continue}a(e[n],g.prototype)}}Object.extend(Element,Element.Methods);delete Element.ByTag};var Toggle={display:Element.toggle};Abstract.Insertion=function(a){this.adjacency=a};Abstract.Insertion.prototype={initialize:function(b,c){this.element=$(b);this.content=c.stripScripts();if(this.adjacency&&this.element.insertAdjacentHTML){try{this.element.insertAdjacentHTML(this.adjacency,this.content)}catch(f){var a=this.element.tagName.toUpperCase();if(["TBODY","TR"].include(a)){this.insertContent(this.contentFromAnonymousTable())}else{throw f}}}else{this.range=this.element.ownerDocument.createRange();if(this.initializeRange){this.initializeRange()}this.insertContent([this.range.createContextualFragment(this.content)])}setTimeout(function(){c.evalScripts()},10)},contentFromAnonymousTable:function(){var a=document.createElement("div");a.innerHTML="<table><tbody>"+this.content+"</tbody></table>";return $A(a.childNodes[0].childNodes[0].childNodes)}};var Insertion=new Object();Insertion.Before=Class.create();Insertion.Before.prototype=Object.extend(new Abstract.Insertion("beforeBegin"),{initializeRange:function(){this.range.setStartBefore(this.element)},insertContent:function(a){a.each((function(b){this.element.parentNode.insertBefore(b,this.element)}).bind(this))}});Insertion.Top=Class.create();Insertion.Top.prototype=Object.extend(new Abstract.Insertion("afterBegin"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(true)},insertContent:function(a){a.reverse(false).each((function(b){this.element.insertBefore(b,this.element.firstChild)}).bind(this))}});Insertion.Bottom=Class.create();Insertion.Bottom.prototype=Object.extend(new Abstract.Insertion("beforeEnd"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(this.element)},insertContent:function(a){a.each((function(b){this.element.appendChild(b)}).bind(this))}});Insertion.After=Class.create();Insertion.After.prototype=Object.extend(new Abstract.Insertion("afterEnd"),{initializeRange:function(){this.range.setStartAfter(this.element)},insertContent:function(a){a.each((function(b){this.element.parentNode.insertBefore(b,this.element.nextSibling)}).bind(this))}});Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){if(this.include(a)){return}this.set($A(this).concat(a).join(" "))},remove:function(a){if(!this.include(a)){return}this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);var Selector=Class.create();Selector.prototype={initialize:function(a){this.expression=a.strip();this.compileMatcher()},compileMatcher:function(){if(Prototype.BrowserFeatures.XPath&&!(/\[[\w-]*?:/).test(this.expression)){return this.compileXPathMatcher()}var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m;if(Selector._cache[e]){this.matcher=Selector._cache[e];return}this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i in ps){p=ps[i];if(m=e.match(p)){this.matcher.push(typeof c[i]=="function"?c[i](m):new Template(c[i]).evaluate(m));e=e.replace(m[0],"");break}}}this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join("\n"));Selector._cache[this.expression]=this.matcher},compileXPathMatcher:function(){var g=this.expression,h=Selector.patterns,b=Selector.xpath,f,a;if(Selector._cache[g]){this.xpath=Selector._cache[g];return}this.matcher=[".//*"];while(g&&f!=g&&(/\S/).test(g)){f=g;for(var c in h){if(a=g.match(h[c])){this.matcher.push(typeof b[c]=="function"?b[c](a):new Template(b[c]).evaluate(a));g=g.replace(a[0],"");break}}}this.xpath=this.matcher.join("");Selector._cache[this.expression]=this.xpath},findElements:function(a){a=a||document;if(this.xpath){return document._getElementsByXPath(this.xpath,a)}return this.matcher(a)},match:function(a){return this.findElements(document).include(a)},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+">"}};Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(a){if(a[1]=="*"){return""}return"[local-name()='"+a[1].toLowerCase()+"' or local-name()='"+a[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:"[@#{1}]",attr:function(a){a[3]=a[5]||a[6];return new Template(Selector.xpath.operators[a[2]]).evaluate(a)},pseudo:function(a){var b=Selector.xpath.pseudos[a[1]];if(!b){return""}if(typeof b==="function"){return b(a)}return new Template(Selector.xpath.pseudos[a[1]]).evaluate(a)},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0 or translate(text(), ' \t\r\n', '') = '')]",checked:"[@checked]",disabled:"[@disabled]",enabled:"[not(@disabled)]",not:function(b){var n=b[6],j=Selector.patterns,a=Selector.xpath,g,b,c;var h=[];while(n&&g!=n&&(/\S/).test(n)){g=n;for(var f in j){if(b=n.match(j[f])){c=typeof a[f]=="function"?a[f](b):new Template(a[f]).evaluate(b);h.push("("+c.substring(1,c.length-1)+")");n=n.replace(b[0],"");break}}}return"[not("+h.join(" and ")+")]"},"nth-child":function(a){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",a)},"nth-last-child":function(a){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",a)},"nth-of-type":function(a){return Selector.xpath.pseudos.nth("position() ",a)},"nth-last-of-type":function(a){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",a)},"first-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-of-type"](a)},"last-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](a)},"only-of-type":function(a){var b=Selector.xpath.pseudos;return b["first-of-type"](a)+b["last-of-type"](a)},nth:function(h,f){var j,n=f[6],e;if(n=="even"){n="2n+0"}if(n=="odd"){n="2n+1"}if(j=n.match(/^(\d+)$/)){return"["+h+"= "+j[1]+"]"}if(j=n.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(j[1]=="-"){j[1]=-1}var g=j[1]?Number(j[1]):1;var c=j[2]?Number(j[2]):0;e="[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]";return new Template(e).evaluate({fragment:h,a:g,b:c})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);   c = false;',className:'n = h.className(n, r, "#{1}", c); c = false;',id:'n = h.id(n, r, "#{1}", c);        c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}"); c = false;',attr:function(a){a[3]=(a[5]||a[6]);return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}"); c = false;').evaluate(a)},pseudo:function(a){if(a[6]){a[6]=a[6].replace(/"/g,'\\"')}return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(a)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:{laterSibling:/^\s*~\s*/,child:/^\s*>\s*/,adjacent:/^\s*\+\s*/,descendant:/^\s/,tagName:/^\s*(\*|[\w\-]+)(\b|$)?/,id:/^#([\w\-\*]+)(\b|$)/,className:/^\.([\w\-\*]+)(\b|$)/,pseudo:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|\s)/,attrPresence:/^\[([\w]+)\]/,attr:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\]]*?)\4|([^'"][^\]]*?)))?\]/},handlers:{concat:function(e,c){for(var f=0,g;g=c[f];f++){e.push(g)}return e},mark:function(a){for(var b=0,c;c=a[b];b++){c._counted=true}return a},unmark:function(a){for(var b=0,c;c=a[b];b++){c._counted=undefined}return a},index:function(a,e,g){a._counted=true;if(e){for(var b=a.childNodes,f=b.length-1,c=1;f>=0;f--){node=b[f];if(node.nodeType==1&&(!g||node._counted)){node.nodeIndex=c++}}}else{for(var f=0,c=1,b=a.childNodes;node=b[f];f++){if(node.nodeType==1&&(!g||node._counted)){node.nodeIndex=c++}}}},unique:function(b){if(b.length==0){return b}var e=[],f;for(var c=0,a=b.length;c<a;c++){if(!(f=b[c])._counted){f._counted=true;e.push(Element.extend(f))}}return Selector.handlers.unmark(e)},descendant:function(a){var e=Selector.handlers;for(var c=0,b=[],f;f=a[c];c++){e.concat(b,f.getElementsByTagName("*"))}return b},child:function(a){var g=Selector.handlers;for(var f=0,e=[],n;n=a[f];f++){for(var b=0,c=[],o;o=n.childNodes[b];b++){if(o.nodeType==1&&o.tagName!="!"){e.push(o)}}}return e},adjacent:function(a){for(var c=0,b=[],f;f=a[c];c++){var e=this.nextElementSibling(f);if(e){b.push(e)}}return b},laterSibling:function(a){var e=Selector.handlers;for(var c=0,b=[],f;f=a[c];c++){e.concat(b,Element.nextSiblings(f))}return b},nextElementSibling:function(a){while(a=a.nextSibling){if(a.nodeType==1){return a}}return null},previousElementSibling:function(a){while(a=a.previousSibling){if(a.nodeType==1){return a}}return null},tagName:function(b,a,f,n){f=f.toUpperCase();var e=[],g=Selector.handlers;if(b){if(n){if(n=="descendant"){for(var c=0,j;j=b[c];c++){g.concat(e,j.getElementsByTagName(f))}return e}else{b=this[n](b)}if(f=="*"){return b}}for(var c=0,j;j=b[c];c++){if(j.tagName.toUpperCase()==f){e.push(j)}}return e}else{return a.getElementsByTagName(f)}},id:function(b,a,n,g){var j=$(n),e=Selector.handlers;if(!b&&a==document){return j?[j]:[]}if(b){if(g){if(g=="child"){for(var c=0,f;f=b[c];c++){if(j.parentNode==f){return[j]}}}else{if(g=="descendant"){for(var c=0,f;f=b[c];c++){if(Element.descendantOf(j,f)){return[j]}}}else{if(g=="adjacent"){for(var c=0,f;f=b[c];c++){if(Selector.handlers.previousElementSibling(j)==f){return[j]}}}else{b=e[g](b)}}}}for(var c=0,f;f=b[c];c++){if(f==j){return[j]}}return[]}return(j&&Element.descendantOf(j,a))?[j]:[]},className:function(b,a,c,e){if(b&&e){b=this[e](b)}return Selector.handlers.byClassName(b,a,c)},byClassName:function(c,b,g){if(!c){c=Selector.handlers.descendant([b])}var j=" "+g+" ";for(var f=0,e=[],h,a;h=c[f];f++){a=h.className;if(a.length==0){continue}if(a==g||(" "+a+" ").include(j)){e.push(h)}}return e},attrPresence:function(c,b,a){var f=[];for(var e=0,g;g=c[e];e++){if(Element.hasAttribute(g,a)){f.push(g)}}return f},attr:function(a,j,h,n,b){if(!a){a=j.getElementsByTagName("*")}var o=Selector.operators[b],e=[];for(var f=0,c;c=a[f];f++){var g=Element.readAttribute(c,h);if(g===null){continue}if(o(g,n)){e.push(c)}}return e},pseudo:function(b,c,f,a,e){if(b&&e){b=this[e](b)}if(!b){b=a.getElementsByTagName("*")}return Selector.pseudos[c](b,f,a)}},pseudos:{"first-child":function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(Selector.handlers.previousElementSibling(f)){continue}c.push(f)}return c},"last-child":function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(Selector.handlers.nextElementSibling(f)){continue}c.push(f)}return c},"only-child":function(b,j,a){var f=Selector.handlers;for(var e=0,c=[],g;g=b[e];e++){if(!f.previousElementSibling(g)&&!f.nextElementSibling(g)){c.push(g)}}return c},"nth-child":function(b,c,a){return Selector.pseudos.nth(b,c,a)},"nth-last-child":function(b,c,a){return Selector.pseudos.nth(b,c,a,true)},"nth-of-type":function(b,c,a){return Selector.pseudos.nth(b,c,a,false,true)},"nth-last-of-type":function(b,c,a){return Selector.pseudos.nth(b,c,a,true,true)},"first-of-type":function(b,c,a){return Selector.pseudos.nth(b,"1",a,false,true)},"last-of-type":function(b,c,a){return Selector.pseudos.nth(b,"1",a,true,true)},"only-of-type":function(b,e,a){var c=Selector.pseudos;return c["last-of-type"](c["first-of-type"](b,e,a),e,a)},getIndices:function(e,c,f){if(e==0){return c>0?[c]:[]}return $R(1,f).inject([],function(a,b){if(0==(b-c)%e&&(b-c)/e>=0){a.push(b)}return a})},nth:function(c,w,z,v,f){if(c.length==0){return[]}if(w=="even"){w="2n+0"}if(w=="odd"){w="2n+1"}var u=Selector.handlers,t=[],e=[],n;u.mark(c);for(var q=0,g;g=c[q];q++){if(!g.parentNode._counted){u.index(g.parentNode,v,f);e.push(g.parentNode)}}if(w.match(/^\d+$/)){w=Number(w);for(var q=0,g;g=c[q];q++){if(g.nodeIndex==w){t.push(g)}}}else{if(n=w.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(n[1]=="-"){n[1]=-1}var A=n[1]?Number(n[1]):1;var x=n[2]?Number(n[2]):0;var B=Selector.pseudos.getIndices(A,x,c.length);for(var q=0,g,o=B.length;g=c[q];q++){for(var p=0;p<o;p++){if(g.nodeIndex==B[p]){t.push(g)}}}}}u.unmark(c);u.unmark(e);return t},empty:function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(f.tagName=="!"||(f.firstChild&&!f.innerHTML.match(/^\s*$/))){continue}c.push(f)}return c},not:function(a,e,o){var j=Selector.handlers,p,c;var n=new Selector(e).findElements(o);j.mark(n);for(var g=0,f=[],b;b=a[g];g++){if(!b._counted){f.push(b)}}j.unmark(n);return f},enabled:function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(!f.disabled){c.push(f)}}return c},disabled:function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(f.disabled){c.push(f)}}return c},checked:function(b,g,a){for(var e=0,c=[],f;f=b[e];e++){if(f.checked){c.push(f)}}return c}},operators:{"=":function(b,a){return b==a},"!=":function(b,a){return b!=a},"^=":function(b,a){return b.startsWith(a)},"$=":function(b,a){return b.endsWith(a)},"*=":function(b,a){return b.include(a)},"~=":function(b,a){return(" "+b+" ").include(" "+a+" ")},"|=":function(b,a){return("-"+b.toUpperCase()+"-").include("-"+a.toUpperCase()+"-")}},matchElements:function(g,j){var f=new Selector(j).findElements(),e=Selector.handlers;e.mark(f);for(var c=0,b=[],a;a=g[c];c++){if(a._counted){b.push(a)}}e.unmark(f);return b},findElement:function(b,c,a){if(typeof c=="number"){a=c;c=false}return Selector.matchElements(b,c||"*")[a||0]},findChildElements:function(f,j){var n=j.join(","),j=[];n.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(h){j.push(h[1].strip())});var e=[],g=Selector.handlers;for(var c=0,b=j.length,a;c<b;c++){a=new Selector(j[c].strip());g.concat(e,a.findElements(f))}return(b>1)?g.unique(e):e}});function $$(){return Selector.findChildElements(document,$A(arguments))}var Form={reset:function(a){$(a).reset();return a},serializeElements:function(c,a){var b=c.inject({},function(e,g){if(!g.disabled&&g.name){var f=g.name,h=$(g).getValue();if(h!=null){if(f in e){if(e[f].constructor!=Array){e[f]=[e[f]]}e[f].push(h)}else{e[f]=h}}}return e});return a?b:Hash.toQueryString(b)}};Form.Methods={serialize:function(b,a){return Form.serializeElements(Form.getElements(b),a)},getElements:function(a){return $A($(a).getElementsByTagName("*")).inject([],function(b,c){if(Form.Element.Serializers[c.tagName.toLowerCase()]){b.push(Element.extend(c))}return b})},getInputs:function(h,c,e){h=$(h);var a=h.getElementsByTagName("input");if(!c&&!e){return $A(a).map(Element.extend)}for(var f=0,j=[],g=a.length;f<g;f++){var b=a[f];if((c&&b.type!=c)||(e&&b.name!=e)){continue}j.push(Element.extend(b))}return j},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){return $(a).getElements().find(function(b){return b.type!="hidden"&&!b.disabled&&["input","select","textarea"].include(b.tagName.toLowerCase())})},focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(b,a){b=$(b),a=Object.clone(a||{});var c=a.parameters;a.parameters=b.serialize(true);if(c){if(typeof c=="string"){c=c.toQueryParams()}Object.extend(a.parameters,c)}if(b.hasAttribute("method")&&!a.method){a.method=b.method}return new Ajax.Request(b.readAttribute("action"),a)}};Object.extend(Form,Form.Methods);Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Hash.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();if(a.select&&(a.tagName.toLowerCase()!="input"||!["button","reset","submit"].include(a.type))){a.select()}}catch(b){}return a},disable:function(a){a=$(a);a.blur();a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)});var Field=Form.Element;var $F=Form.Element.getValue;Form.Element.Serializers={input:function(a){switch(a.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(a);default:return Form.Element.Serializers.textarea(a)}},inputSelector:function(a){return a.checked?a.value:null},textarea:function(a){return a.value},select:function(a){return this[a.type=="select-one"?"selectOne":"selectMany"](a)},selectOne:function(b){var a=b.selectedIndex;return a>=0?this.optionValue(b.options[a]):null},selectMany:function(e){var a,f=e.length;if(!f){return null}for(var c=0,a=[];c<f;c++){var b=e.options[c];if(b.selected){a.push(this.optionValue(b))}}return a},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};Abstract.TimedObserver=function(){};Abstract.TimedObserver.prototype={initialize:function(a,b,c){this.frequency=b;this.element=$(a);this.callback=c;this.lastValue=this.getValue();this.registerCallback()},registerCallback:function(){setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},onTimerEvent:function(){var a=this.getValue();var b=("string"==typeof this.lastValue&&"string"==typeof a?this.lastValue!=a:String(this.lastValue)!=String(a));if(b){this.callback(this.element,a);this.lastValue=a}}};Form.Element.Observer=Class.create();Form.Element.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create();Form.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=function(){};Abstract.EventObserver.prototype={initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback.bind(this))},registerCallback:function(a){if(a.type){switch(a.type.toLowerCase()){case"checkbox":case"radio":Event.observe(a,"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}}};Form.Element.EventObserver=Class.create();Form.Element.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create();Form.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.serialize(this.element)}});if(!window.Event){var Event=new Object()}Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(a){return $(a.target||a.srcElement)},isLeftClick:function(a){return(((a.which)&&(a.which==1))||((a.button)&&(a.button==1)))},pointerX:function(a){return a.pageX||(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft))},pointerY:function(a){return a.pageY||(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop))},stop:function(a){if(a.preventDefault){a.preventDefault();a.stopPropagation()}else{a.returnValue=false;a.cancelBubble=true}},findElement:function(c,b){var a=Event.element(c);while(a.parentNode&&(!a.tagName||(a.tagName.toUpperCase()!=b.toUpperCase()))){a=a.parentNode}return a},observers:false,_observeAndCache:function(e,c,b,a){if(!this.observers){this.observers=[]}if(e.addEventListener){this.observers.push([e,c,b,a]);e.addEventListener(c,b,a)}else{if(e.attachEvent){this.observers.push([e,c,b,a]);e.attachEvent("on"+c,b)}}},unloadCache:function(){if(!Event.observers){return}for(var a=0,b=Event.observers.length;a<b;a++){Event.stopObserving.apply(this,Event.observers[a]);Event.observers[a][0]=null}Event.observers=false},observe:function(e,c,b,a){e=$(e);a=a||false;if(c=="keypress"&&(Prototype.Browser.WebKit||e.attachEvent)){c="keydown"}Event._observeAndCache(e,c,b,a)},stopObserving:function(f,c,b,a){f=$(f);a=a||false;if(c=="keypress"&&(Prototype.Browser.WebKit||f.attachEvent)){c="keydown"}if(f.removeEventListener){f.removeEventListener(c,b,a)}else{if(f.detachEvent){try{f.detachEvent("on"+c,b)}catch(g){}}}}});if(Prototype.Browser.IE){Event.observe(window,"unload",Event.unloadCache,false)}var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},realOffset:function(b){var a=0,c=0;do{a+=b.scrollTop||0;c+=b.scrollLeft||0;b=b.parentNode}while(b);return[c,a]},cumulativeOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent}while(b);return[c,a]},positionedOffset:function(b){var a=0,e=0;do{a+=b.offsetTop||0;e+=b.offsetLeft||0;b=b.offsetParent;if(b){if(b.tagName=="BODY"){break}var c=Element.getStyle(b,"position");if(c=="relative"||c=="absolute"){break}}}while(b);return[e,a]},offsetParent:function(a){if(a.offsetParent){return a.offsetParent}if(a==document.body){return a}while((a=a.parentNode)&&a!=document.body){if(Element.getStyle(a,"position")!="static"){return a}}return document.body},within:function(b,a,c){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,c)}this.xcomp=a;this.ycomp=c;this.offset=this.cumulativeOffset(b);return(c>=this.offset[1]&&c<this.offset[1]+b.offsetHeight&&a>=this.offset[0]&&a<this.offset[0]+b.offsetWidth)},withinIncludingScrolloffsets:function(b,a,e){var c=this.realOffset(b);this.xcomp=a+c[0]-this.deltaX;this.ycomp=e+c[1]-this.deltaY;this.offset=this.cumulativeOffset(b);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+b.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+b.offsetWidth)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset[1]+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset[0]+a.offsetWidth)-this.xcomp)/a.offsetWidth}},page:function(e){var a=0,c=0;var b=e;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body){if(Element.getStyle(b,"position")=="absolute"){break}}}while(b=b.offsetParent);b=e;do{if(!window.opera||b.tagName=="BODY"){a-=b.scrollTop||0;c-=b.scrollLeft||0}}while(b=b.parentNode);return[c,a]},clone:function(c,f){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});c=$(c);var e=Position.page(c);f=$(f);var g=[0,0];var b=null;if(Element.getStyle(f,"position")=="absolute"){b=Position.offsetParent(f);g=Position.page(b)}if(b==document.body){g[0]-=document.body.offsetLeft;g[1]-=document.body.offsetTop}if(a.setLeft){f.style.left=(e[0]-g[0]+a.offsetLeft)+"px"}if(a.setTop){f.style.top=(e[1]-g[1]+a.offsetTop)+"px"}if(a.setWidth){f.style.width=c.offsetWidth+"px"}if(a.setHeight){f.style.height=c.offsetHeight+"px"}},absolutize:function(b){b=$(b);if(b.style.position=="absolute"){return}Position.prepare();var e=Position.positionedOffset(b);var g=e[1];var f=e[0];var c=b.clientWidth;var a=b.clientHeight;b._originalLeft=f-parseFloat(b.style.left||0);b._originalTop=g-parseFloat(b.style.top||0);b._originalWidth=b.style.width;b._originalHeight=b.style.height;b.style.position="absolute";b.style.top=g+"px";b.style.left=f+"px";b.style.width=c+"px";b.style.height=a+"px"},relativize:function(a){a=$(a);if(a.style.position=="relative"){return}Position.prepare();a.style.position="relative";var c=parseFloat(a.style.top||0)-(a._originalTop||0);var b=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=c+"px";a.style.left=b+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth}};if(Prototype.Browser.WebKit){Position.cumulativeOffset=function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body){if(Element.getStyle(b,"position")=="absolute"){break}}b=b.offsetParent}while(b);return[c,a]}}Element.addMethods();var Scriptaculous={Version:"1.7.1_beta3",require:function(a){document.write('<script type="text/javascript" src="'+a+'"><\/script>')},REQUIRED_PROTOTYPE:"1.5.1",load:function(){function a(b){var c=b.split(".");return parseInt(c[0])*100000+parseInt(c[1])*1000+parseInt(c[2])}if((typeof Prototype=="undefined")||(typeof Element=="undefined")||(typeof Element.Methods=="undefined")||(a(Prototype.Version)<a(Scriptaculous.REQUIRED_PROTOTYPE))){throw ("script.aculo.us requires the Prototype JavaScript framework >= "+Scriptaculous.REQUIRED_PROTOTYPE)}$A(document.getElementsByTagName("script")).findAll(function(b){return(b.src&&b.src.match(/scriptaculous\.js(\?.*)?$/))}).each(function(c){var e=c.src.replace(/scriptaculous\.js(\?.*)?$/,"");var b=c.src.match(/\?.*load=([a-z,]*)/);(b?b[1]:"builder,effects,dragdrop,controls,slider,sound").split(",").each(function(f){Scriptaculous.require(e+f+".js")})})}};Scriptaculous.load();function sack(file){this.xmlhttp=null;this.resetData=function(){this.method="POST";this.queryStringSeparator="?";this.argumentSeparator="&";this.URLString="";this.encodeURIString=true;this.execute=false;this.element=null;this.elementObj=null;this.requestFile=file;this.vars=new Object();this.responseStatus=new Array(2)};this.resetFunctions=function(){this.onLoading=function(){};this.onLoaded=function(){};this.onInteractive=function(){};this.onCompletion=function(){};this.onError=function(){};this.onFail=function(){}};this.reset=function(){this.resetFunctions();this.resetData()};this.createAJAX=function(){try{this.xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e1){try{this.xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e2){this.xmlhttp=null}}if(!this.xmlhttp){if(typeof XMLHttpRequest!="undefined"){this.xmlhttp=new XMLHttpRequest()}else{this.failed=true}}};this.setVar=function(name,value){this.vars[name]=Array(value,false)};this.encVar=function(name,value,returnvars){if(true==returnvars){return Array(encodeURIComponent(name),encodeURIComponent(value))}else{this.vars[encodeURIComponent(name)]=Array(encodeURIComponent(value),true)}};this.processURLString=function(string,encode){encoded=encodeURIComponent(this.argumentSeparator);regexp=new RegExp(this.argumentSeparator+"|"+encoded);varArray=string.split(regexp);for(i=0;i<varArray.length;i++){urlVars=varArray[i].split("=");if(true==encode){this.encVar(urlVars[0],urlVars[1])}else{this.setVar(urlVars[0],urlVars[1])}}};this.createURLString=function(urlstring){if(this.encodeURIString&&this.URLString.length){this.processURLString(this.URLString,true)}if(urlstring){if(this.URLString.length){this.URLString+=this.argumentSeparator+urlstring}else{this.URLString=urlstring}}this.setVar("rndval",new Date().getTime());urlstringtemp=new Array();for(key in this.vars){if(false==this.vars[key][1]&&true==this.encodeURIString){encoded=this.encVar(key,this.vars[key][0],true);delete this.vars[key];this.vars[encoded[0]]=Array(encoded[1],true);key=encoded[0]}urlstringtemp[urlstringtemp.length]=key+"="+this.vars[key][0]}if(urlstring){this.URLString+=this.argumentSeparator+urlstringtemp.join(this.argumentSeparator)}else{this.URLString+=urlstringtemp.join(this.argumentSeparator)}};this.runResponse=function(){eval(this.response)};this.runAJAX=function(urlstring){if(this.failed){this.onFail()}else{this.createURLString(urlstring);if(this.element){this.elementObj=document.getElementById(this.element)}if(this.xmlhttp){var self=this;if(this.method=="GET"){totalurlstring=this.requestFile+this.queryStringSeparator+this.URLString;this.xmlhttp.open(this.method,totalurlstring,true)}else{this.xmlhttp.open(this.method,this.requestFile,true);try{this.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(e){}}this.xmlhttp.onreadystatechange=function(){switch(self.xmlhttp.readyState){case 1:self.onLoading();break;case 2:self.onLoaded();break;case 3:self.onInteractive();break;case 4:self.response=self.xmlhttp.responseText;self.responseXML=self.xmlhttp.responseXML;self.responseStatus[0]=self.xmlhttp.status;self.responseStatus[1]=self.xmlhttp.statusText;if(self.execute){self.runResponse()}if(self.elementObj){elemNodeName=self.elementObj.nodeName;elemNodeName.toLowerCase();if(elemNodeName=="input"||elemNodeName=="select"||elemNodeName=="option"||elemNodeName=="textarea"){self.elementObj.value=self.response}else{self.elementObj.innerHTML=self.response}}if(self.responseStatus[0]=="200"){self.onCompletion()}else{self.onError()}self.URLString="";delete self.xmlhttp.onreadystatechange;self.xmlhttp=null;self.responseStatus=null;self.response=null;self.responseXML=null;break}};this.xmlhttp.send(this.URLString)}}};this.reset();this.createAJAX()}var Window=Class.create();Window.keepMultiModalWindow=false;Window.hasEffectLib=(typeof Effect!="undefined");Window.resizeEffectDuration=0.4;Window.prototype={initialize:function(){var c;var b=0;if(arguments.length>0){if(typeof arguments[0]=="string"){c=arguments[0];b=1}else{c=arguments[0]?arguments[0].id:null}}if(!c){c="window_"+new Date().getTime()}if($(c)){alert("Window "+c+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor")}this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:true,closable:true,minimizable:true,maximizable:true,draggable:true,userData:null,showEffect:(Window.hasEffectLib?Effect.Appear:Element.show),hideEffect:(Window.hasEffectLib?Effect.Fade:Element.hide),showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&nbsp;",url:null,onload:Prototype.emptyFunction,width:200,height:300,opacity:1,recenterAuto:true,wiredDrag:false,closeCallback:null,destroyOnClose:false,gridX:1,gridY:1},arguments[b]||{});if(this.options.blurClassName){this.options.focusClassName=this.options.className}if(typeof this.options.top=="undefined"&&typeof this.options.bottom=="undefined"){this.options.top=this._round(Math.random()*500,this.options.gridY)}if(typeof this.options.left=="undefined"&&typeof this.options.right=="undefined"){this.options.left=this._round(Math.random()*500,this.options.gridX)}if(this.options.effectOptions){Object.extend(this.options.hideEffectOptions,this.options.effectOptions);Object.extend(this.options.showEffectOptions,this.options.effectOptions);if(this.options.showEffect==Element.Appear){this.options.showEffectOptions.to=this.options.opacity}}if(Window.hasEffectLib){if(this.options.showEffect==Effect.Appear){this.options.showEffectOptions.to=this.options.opacity}if(this.options.hideEffect==Effect.Fade){this.options.hideEffectOptions.from=this.options.opacity}}if(this.options.hideEffect==Element.hide){this.options.hideEffect=function(){Element.hide(this.element);if(this.options.destroyOnClose){this.destroy()}}.bind(this)}if(this.options.parent!=document.body){this.options.parent=$(this.options.parent)}this.element=this._createWindow(c);this.element.win=this;this.eventMouseDown=this._initDrag.bindAsEventListener(this);this.eventMouseUp=this._endDrag.bindAsEventListener(this);this.eventMouseMove=this._updateDrag.bindAsEventListener(this);this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this);this.eventMouseDownContent=this.toFront.bindAsEventListener(this);this.eventResize=this._recenter.bindAsEventListener(this);this.topbar=$(this.element.id+"_top");this.bottombar=$(this.element.id+"_bottom");this.content=$(this.element.id+"_content");Event.observe(this.topbar,"mousedown",this.eventMouseDown);Event.observe(this.bottombar,"mousedown",this.eventMouseDown);Event.observe(this.content,"mousedown",this.eventMouseDownContent);Event.observe(window,"load",this.eventOnLoad);Event.observe(window,"resize",this.eventResize);Event.observe(window,"scroll",this.eventResize);Event.observe(this.options.parent,"scroll",this.eventResize);if(this.options.draggable){var a=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(e){e.observe("mousedown",a.eventMouseDown);e.addClassName("top_draggable")});[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(e){e.observe("mousedown",a.eventMouseDown);e.addClassName("bottom_draggable")})}if(this.options.resizable){this.sizer=$(this.element.id+"_sizer");Event.observe(this.sizer,"mousedown",this.eventMouseDown)}this.useLeft=null;this.useTop=null;if(typeof this.options.left!="undefined"){this.element.setStyle({left:parseFloat(this.options.left)+"px"});this.useLeft=true}else{this.element.setStyle({right:parseFloat(this.options.right)+"px"});this.useLeft=false}if(typeof this.options.top!="undefined"){this.element.setStyle({top:parseFloat(this.options.top)+"px"});this.useTop=true}else{this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"});this.useTop=false}this.storedLocation=null;this.setOpacity(this.options.opacity);if(this.options.zIndex){this.setZIndex(this.options.zIndex)}if(this.options.destroyOnClose){this.setDestroyOnClose(true)}this._getWindowBorderSize();this.width=this.options.width;this.height=this.options.height;this.visible=false;this.constraint=false;this.constraintPad={top:0,left:0,bottom:0,right:0};if(this.width&&this.height){this.setSize(this.options.width,this.options.height)}this.setTitle(this.options.title);Windows.register(this)},destroy:function(){this._notify("onDestroy");Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown);Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown);Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent);Event.stopObserving(window,"load",this.eventOnLoad);Event.stopObserving(window,"resize",this.eventResize);Event.stopObserving(window,"scroll",this.eventResize);Event.stopObserving(this.content,"load",this.options.onload);if(this._oldParent){var c=this.getContent();var a=null;for(var b=0;b<c.childNodes.length;b++){a=c.childNodes[b];if(a.nodeType==1){break}a=null}if(a){this._oldParent.appendChild(a)}this._oldParent=null}if(this.sizer){Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown)}if(this.options.url){this.content.src=null}if(this.iefix){Element.remove(this.iefix)}Element.remove(this.element);Windows.unregister(this)},setCloseCallback:function(a){this.options.closeCallback=a},getContent:function(){return this.content},setContent:function(h,g,b){var a=$(h);if(null==a){throw"Unable to find element '"+h+"' in DOM"}this._oldParent=a.parentNode;var f=null;var e=null;if(g){f=Element.getDimensions(a)}if(b){e=Position.cumulativeOffset(a)}var c=this.getContent();this.setHTMLContent("");c=this.getContent();c.appendChild(a);a.show();if(g){this.setSize(f.width,f.height)}if(b){this.setLocation(e[1]-this.heightN,e[0]-this.widthW)}},setHTMLContent:function(a){if(this.options.url){this.content.src=null;this.options.url=null;var b='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>';$(this.getId()+"_table_content").innerHTML=b;this.content=$(this.element.id+"_content")}this.getContent().innerHTML=a},setAjaxContent:function(b,a,e,c){this.showFunction=e?"showCenter":"show";this.showModal=c||false;a=a||{};this.setHTMLContent("");this.onComplete=a.onComplete;if(!this._onCompleteHandler){this._onCompleteHandler=this._setAjaxContent.bind(this)}a.onComplete=this._onCompleteHandler;new Ajax.Request(b,a);a.onComplete=this.onComplete},_setAjaxContent:function(a){Element.update(this.getContent(),a.responseText);if(this.onComplete){this.onComplete(a)}this.onComplete=null;this[this.showFunction](this.showModal)},setURL:function(a){if(this.options.url){this.content.src=null}this.options.url=a;var b="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+a+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=b;this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){if(this.options.url){$(this.element.getAttribute("id")+"_content").src=this.options.url}},setCookie:function(b,c,u,f,a){b=b||this.element.id;this.cookie=[b,c,u,f,a];var q=WindowUtilities.getCookie(b);if(q){var t=q.split(",");var o=t[0].split(":");var n=t[1].split(":");var p=parseFloat(t[2]),g=parseFloat(t[3]);var j=t[4];var e=t[5];this.setSize(p,g);if(j=="true"){this.doMinimize=true}else{if(e=="true"){this.doMaximize=true}}this.useLeft=o[0]=="l";this.useTop=n[0]=="t";this.element.setStyle(this.useLeft?{left:o[1]}:{right:o[1]});this.element.setStyle(this.useTop?{top:n[1]}:{bottom:n[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=true},setConstraint:function(a,b){this.constraint=a;this.constraintPad=Object.extend(this.constraintPad,b||{});if(this.useTop&&this.useLeft){this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))}},_initDrag:function(b){if(Event.element(b)==this.sizer&&this.isMinimized()){return}if(Event.element(b)!=this.sizer&&this.isMaximized()){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}this.pointer=[this._round(Event.pointerX(b),this.options.gridX),this._round(Event.pointerY(b),this.options.gridY)];if(this.options.wiredDrag){this.currentDrag=this._createWiredElement()}else{this.currentDrag=this.element}if(Event.element(b)==this.sizer){this.doResize=true;this.widthOrg=this.width;this.heightOrg=this.height;this.bottomOrg=parseFloat(this.element.getStyle("bottom"));this.rightOrg=parseFloat(this.element.getStyle("right"));this._notify("onStartResize")}else{this.doResize=false;var a=$(this.getId()+"_close");if(a&&Position.within(a,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable){return}this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,false);Event.observe(document,"mousemove",this.eventMouseMove,false);WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity);document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};this.currentDrag.show();Event.stop(b)},_round:function(b,a){return a==1?b:b=Math.floor(b/a)*a},_updateDrag:function(b){var a=[this._round(Event.pointerX(b),this.options.gridX),this._round(Event.pointerY(b),this.options.gridY)];var p=a[0]-this.pointer[0];var o=a[1]-this.pointer[1];if(this.doResize){var n=this.widthOrg+p;var e=this.heightOrg+o;p=this.width-this.widthOrg;o=this.height-this.heightOrg;if(this.useLeft){n=this._updateWidthConstraint(n)}else{this.currentDrag.setStyle({right:(this.rightOrg-p)+"px"})}if(this.useTop){e=this._updateHeightConstraint(e)}else{this.currentDrag.setStyle({bottom:(this.bottomOrg-o)+"px"})}this.setSize(n,e);this._notify("onResize")}else{this.pointer=a;if(this.useLeft){var c=parseFloat(this.currentDrag.getStyle("left"))+p;var j=this._updateLeftConstraint(c);this.pointer[0]+=j-c;this.currentDrag.setStyle({left:j+"px"})}else{this.currentDrag.setStyle({right:parseFloat(this.currentDrag.getStyle("right"))-p+"px"})}if(this.useTop){var g=parseFloat(this.currentDrag.getStyle("top"))+o;var f=this._updateTopConstraint(g);this.pointer[1]+=f-g;this.currentDrag.setStyle({top:f+"px"})}else{this.currentDrag.setStyle({bottom:parseFloat(this.currentDrag.getStyle("bottom"))-o+"px"})}this._notify("onMove")}if(this.iefix){this._fixIEOverlapping()}this._removeStoreLocation();Event.stop(b)},_endDrag:function(a){WindowUtilities.enableScreen("__invisible__");if(this.doResize){this._notify("onEndResize")}else{this._notify("onEndMove")}Event.stopObserving(document,"mouseup",this.eventMouseUp,false);Event.stopObserving(document,"mousemove",this.eventMouseMove,false);Event.stop(a);this._hideWiredElement();this._saveCookie();document.body.ondrag=null;document.body.onselectstart=null},_updateLeftConstraint:function(b){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;if(b<this.constraintPad.left){b=this.constraintPad.left}if(b+this.width+this.widthE+this.widthW>a-this.constraintPad.right){b=a-this.constraintPad.right-this.width-this.widthE-this.widthW}}return b},_updateTopConstraint:function(c){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var b=this.height+this.heightN+this.heightS;if(c<this.constraintPad.top){c=this.constraintPad.top}if(c+b>a-this.constraintPad.bottom){c=a-this.constraintPad.bottom-b}}return c},_updateWidthConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;var c=parseFloat(this.element.getStyle("left"));if(c+a+this.widthE+this.widthW>b-this.constraintPad.right){a=b-this.constraintPad.right-c-this.widthE-this.widthW}}return a},_updateHeightConstraint:function(b){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var c=parseFloat(this.element.getStyle("top"));if(c+b+this.heightN+this.heightS>a-this.constraintPad.bottom){b=a-this.constraintPad.bottom-c-this.heightN-this.heightS}}return b},_createWindow:function(a){var g=this.options.className;var e=document.createElement("div");e.setAttribute("id",a);e.className="dialog";var f;if(this.options.url){f='<iframe frameborder="0" name="'+a+'_content"  id="'+a+'_content" src="'+this.options.url+'"> </iframe>'}else{f='<div id="'+a+'_content" class="'+g+'_content"> </div>'}var h=this.options.closable?"<div class='"+g+"_close' id='"+a+"_close' onclick='Windows.close(\""+a+"\", event)'> </div>":"";var j=this.options.minimizable?"<div class='"+g+"_minimize' id='"+a+"_minimize' onclick='Windows.minimize(\""+a+"\", event)'> </div>":"";var n=this.options.maximizable?"<div class='"+g+"_maximize' id='"+a+"_maximize' onclick='Windows.maximize(\""+a+"\", event)'> </div>":"";var c=this.options.resizable?"class='"+g+"_sizer' id='"+a+"_sizer'":"class='"+g+"_se'";var b="/js/htmlsuite/themes/default/blank.gif";e.innerHTML=h+j+n+"      <table id='"+a+"_row1' class=\"top table_window\">        <tr>          <td class='"+g+"_nw'></td>          <td class='"+g+"_n'><div id='"+a+"_top' class='"+g+"_title title_window'>"+this.options.title+"</div></td>          <td class='"+g+"_ne'></td>        </tr>      </table>      <table id='"+a+"_row2' class=\"mid table_window\">        <tr>          <td class='"+g+"_w'></td>            <td id='"+a+"_table_content' class='"+g+"_content' valign='top'>"+f+"</td>          <td class='"+g+"_e'></td>        </tr>      </table>        <table id='"+a+"_row3' class=\"bot table_window\">        <tr>          <td class='"+g+"_sw'></td>            <td class='"+g+"_s'><div id='"+a+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>            <td "+c+"></td>        </tr>      </table>    ";Element.hide(e);this.options.parent.insertBefore(e,this.options.parent.firstChild);Event.observe($(a+"_content"),"load",this.options.onload);return e},changeClassName:function(a){var b=this.options.className;var c=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(e){this._toggleClassName($(c+e),b+e,a+e)}.bind(this));this._toggleClassName($(c+"_top"),b+"_title",a+"_title");$$("#"+c+" td").each(function(e){e.className=e.className.sub(b,a)});this.options.className=a},_toggleClassName:function(c,b,a){if(c){c.removeClassName(b);c.addClassName(a)}},setLocation:function(c,b){c=this._updateTopConstraint(c);b=this._updateLeftConstraint(b);var a=this.currentDrag||this.element;a.setStyle({top:c+"px"});a.setStyle({left:b+"px"});this.useLeft=true;this.useTop=true},getLocation:function(){var a={};if(this.useTop){a=Object.extend(a,{top:this.element.getStyle("top")})}else{a=Object.extend(a,{bottom:this.element.getStyle("bottom")})}if(this.useLeft){a=Object.extend(a,{left:this.element.getStyle("left")})}else{a=Object.extend(a,{right:this.element.getStyle("right")})}return a},getSize:function(){return{width:this.width,height:this.height}},setSize:function(c,b,a){c=parseFloat(c);b=parseFloat(b);if(!this.minimized&&c<this.options.minWidth){c=this.options.minWidth}if(!this.minimized&&b<this.options.minHeight){b=this.options.minHeight}if(this.options.maxHeight&&b>this.options.maxHeight){b=this.options.maxHeight}if(this.options.maxWidth&&c>this.options.maxWidth){c=this.options.maxWidth}if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&a){new Effect.ResizeWindow(this,null,null,c,b,{duration:Window.resizeEffectDuration})}else{this.width=c;this.height=b;var g=this.currentDrag?this.currentDrag:this.element;g.setStyle({width:c+this.widthW+this.widthE+"px"});g.setStyle({height:b+this.heightN+this.heightS+"px"});if(!this.currentDrag||this.currentDrag==this.element){var f=$(this.element.id+"_content");f.setStyle({height:b+"px"});f.setStyle({width:c+"px"})}}},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,true)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,true)},toFront:function(){if(this.element.style.zIndex<Windows.maxZIndex){this.setZIndex(Windows.maxZIndex+1)}if(this.iefix){this._fixIEOverlapping()}},getBounds:function(b){if(!this.width||!this.height||!this.visible){this.computeBounds()}var a=this.width;var c=this.height;if(!b){a+=this.widthW+this.widthE;c+=this.heightN+this.heightS}var e=Object.extend(this.getLocation(),{width:a+"px",height:c+"px"});return e},computeBounds:function(){if(!this.width||!this.height){var a=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);if(this.height){this.width=a+5}else{this.height=a+5}}this.setSize(this.width,this.height);if(this.centered){this._center(this.centerTop,this.centerLeft)}},show:function(b){this.visible=true;if(b){if(typeof this.overlayOpacity=="undefined"){var a=this;setTimeout(function(){a.show(b)},10);return}Windows.addModalWindow(this);this.modal=true;this.setZIndex(Windows.maxZIndex+1);Windows.unsetOverflow(this)}else{if(!this.element.style.zIndex){this.setZIndex(Windows.maxZIndex+1)}}if(this.oldStyle){this.getContent().setStyle({overflow:this.oldStyle})}this.computeBounds();this._notify("onBeforeShow");if(this.options.showEffect!=Element.show&&this.options.showEffectOptions){this.options.showEffect(this.element,this.options.showEffectOptions)}else{this.options.showEffect(this.element)}this._checkIEOverlapping();WindowUtilities.focusedWindow=this;this._notify("onShow")},showCenter:function(a,c,b){this.centered=true;this.centerTop=c;this.centerLeft=b;this.show(a)},isVisible:function(){return this.visible},_center:function(c,b){var e=WindowUtilities.getWindowScroll(this.options.parent);var a=WindowUtilities.getPageSize(this.options.parent);if(typeof c=="undefined"){c=(a.windowHeight-(this.height+this.heightN+this.heightS))/2}c+=e.top;if(typeof b=="undefined"){b=(a.windowWidth-(this.width+this.widthW+this.widthE))/2}b+=e.left;this.setLocation(c,b);this.toFront()},_recenter:function(b){if(this.centered){var a=WindowUtilities.getPageSize(this.options.parent);var c=WindowUtilities.getWindowScroll(this.options.parent);if(this.pageSize&&this.pageSize.windowWidth==a.windowWidth&&this.pageSize.windowHeight==a.windowHeight&&this.windowScroll.left==c.left&&this.windowScroll.top==c.top){return}this.pageSize=a;this.windowScroll=c;if($("overlay_modal")){$("overlay_modal").setStyle({height:(a.pageHeight+"px")})}if(this.options.recenterAuto){this._center(this.centerTop,this.centerLeft)}}},hide:function(){this.visible=false;if(this.modal){Windows.removeModalWindow(this);Windows.resetOverflow()}this.oldStyle=this.getContent().getStyle("overflow")||"auto";this.getContent().setStyle({overflow:"hidden"});this.options.hideEffect(this.element,this.options.hideEffectOptions);if(this.iefix){this.iefix.hide()}if(!this.doNotNotifyHide){this._notify("onHide")}},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this)){return}if(this.options.destroyOnClose){var a=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var b=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){b();a()}}else{this.options.hideEffectOptions.afterFinish=function(){a()}}}Windows.updateFocusedWindow();this.doNotNotifyHide=true;this.hide();this.doNotNotifyHide=false;this._notify("onClose")}},minimize:function(){if(this.resizing){return}var a=$(this.getId()+"_row2");if(!this.minimized){this.minimized=true;var e=a.getDimensions().height;this.r2Height=e;var c=this.element.getHeight()-e;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height-e,{duration:Window.resizeEffectDuration})}else{this.height-=e;this.element.setStyle({height:c+"px"});a.hide()}if(!this.useTop){var b=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:(b+e)+"px"})}}else{this.minimized=false;var e=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height+e,{duration:Window.resizeEffectDuration})}else{var c=this.element.getHeight()+e;this.height+=e;this.element.setStyle({height:c+"px"});a.show()}if(!this.useTop){var b=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:(b-e)+"px"})}this.toFront()}this._notify("onMinimize");this._saveCookie()},maximize:function(){if(this.isMinimized()||this.resizing){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}if(this.storedLocation!=null){this._restoreLocation();if(this.iefix){this.iefix.hide()}}else{this._storeLocation();Windows.unsetOverflow(this);var h=WindowUtilities.getWindowScroll(this.options.parent);var b=WindowUtilities.getPageSize(this.options.parent);var g=h.left;var f=h.top;if(this.options.parent!=document.body){h={top:0,left:0,bottom:0,right:0};var e=this.options.parent.getDimensions();b.windowWidth=e.width;b.windowHeight=e.height;f=0;g=0}if(this.constraint){b.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right);b.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom);g+=Math.max(0,this.constraintPad.left);f+=Math.max(0,this.constraintPad.top)}var c=b.windowWidth-this.widthW-this.widthE;var a=b.windowHeight-this.heightN-this.heightS;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,f,g,c,a,{duration:Window.resizeEffectDuration})}else{this.setSize(c,a);this.element.setStyle(this.useLeft?{left:g}:{right:g});this.element.setStyle(this.useTop?{top:f}:{bottom:f})}this.toFront();if(this.iefix){this._fixIEOverlapping()}}this._notify("onMaximize");this._saveCookie()},isMinimized:function(){return this.minimized},isMaximized:function(){return(this.storedLocation!=null)},setOpacity:function(a){if(Element.setOpacity){Element.setOpacity(this.element,a)}},setZIndex:function(a){this.element.setStyle({zIndex:a});Windows.updateZindex(a,this)},setTitle:function(a){if(!a||a==""){a="&nbsp;"}Element.update(this.element.id+"_top",a)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(b){var a=$(this.getId()+"_bottom");if(typeof(b)=="object"){if(this.bottombar.firstChild){this.bottombar.replaceChild(b,this.bottombar.firstChild)}else{this.bottombar.appendChild(b)}}else{this.bottombar.innerHTML=b}},_checkIEOverlapping:function(){if(!this.iefix&&(navigator.appVersion.indexOf("MSIE")>0)&&(navigator.userAgent.indexOf("Opera")<0)&&(this.element.getStyle("position")=="absolute")){new Insertion.After(this.element.id,'<iframe id="'+this.element.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.element.id+"_iefix")}if(this.iefix){setTimeout(this._fixIEOverlapping.bind(this),50)}},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix);this.iefix.style.zIndex=this.element.style.zIndex-1;this.iefix.show()},_getWindowBorderSize:function(b){var c=this._createHiddenDiv(this.options.className+"_n");this.heightN=Element.getDimensions(c).height;c.parentNode.removeChild(c);var c=this._createHiddenDiv(this.options.className+"_s");this.heightS=Element.getDimensions(c).height;c.parentNode.removeChild(c);var c=this._createHiddenDiv(this.options.className+"_e");this.widthE=Element.getDimensions(c).width;c.parentNode.removeChild(c);var c=this._createHiddenDiv(this.options.className+"_w");this.widthW=Element.getDimensions(c).width;c.parentNode.removeChild(c);var c=document.createElement("div");c.className="overlay_"+this.options.className;document.body.appendChild(c);var a=this;setTimeout(function(){a.overlayOpacity=($(c).getStyle("opacity"));c.parentNode.removeChild(c)},10);if(Prototype.Browser.IE){this.heightS=$(this.getId()+"_row3").getDimensions().height;this.heightN=$(this.getId()+"_row1").getDimensions().height}if(Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420){this.setSize(this.width,this.height)}if(this.doMaximize){this.maximize()}if(this.doMinimize){this.minimize()}},_createHiddenDiv:function(b){var a=document.body;var c=document.createElement("div");c.setAttribute("id",this.element.id+"_tmp");c.className=b;c.style.display="none";c.innerHTML="";a.insertBefore(c,a.firstChild);return c},_storeLocation:function(){if(this.storedLocation==null){this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:this.element.getStyle("top"),bottom:this.element.getStyle("bottom"),left:this.element.getStyle("left"),right:this.element.getStyle("right"),width:this.width,height:this.height}}},_restoreLocation:function(){if(this.storedLocation!=null){this.useLeft=this.storedLocation.useLeft;this.useTop=this.storedLocation.useTop;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration})}else{this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right});this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom});this.setSize(this.storedLocation.width,this.storedLocation.height)}Windows.resetOverflow();this._removeStoreLocation()}},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var a="";if(this.useLeft){a+="l:"+(this.storedLocation?this.storedLocation.left:this.element.getStyle("left"))}else{a+="r:"+(this.storedLocation?this.storedLocation.right:this.element.getStyle("right"))}if(this.useTop){a+=",t:"+(this.storedLocation?this.storedLocation.top:this.element.getStyle("top"))}else{a+=",b:"+(this.storedLocation?this.storedLocation.bottom:this.element.getStyle("bottom"))}a+=","+(this.storedLocation?this.storedLocation.width:this.width);a+=","+(this.storedLocation?this.storedLocation.height:this.height);a+=","+this.isMinimized();a+=","+this.isMaximized();WindowUtilities.setCookie(a,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){if(Prototype.Browser.IE){this._getWindowBorderSize()}var b=document.createElement("div");b.className="wired_frame "+this.options.className+"_wired_frame";b.style.position="absolute";this.options.parent.insertBefore(b,this.options.parent.firstChild);this.wiredElement=$(b)}if(this.useLeft){this.wiredElement.setStyle({left:this.element.getStyle("left")})}else{this.wiredElement.setStyle({right:this.element.getStyle("right")})}if(this.useTop){this.wiredElement.setStyle({top:this.element.getStyle("top")})}else{this.wiredElement.setStyle({bottom:this.element.getStyle("bottom")})}var a=this.element.getDimensions();this.wiredElement.setStyle({width:a.width+"px",height:a.height+"px"});this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){if(!this.wiredElement||!this.currentDrag){return}if(this.currentDrag==this.element){this.currentDrag=null}else{if(this.useLeft){this.element.setStyle({left:this.currentDrag.getStyle("left")})}else{this.element.setStyle({right:this.currentDrag.getStyle("right")})}if(this.useTop){this.element.setStyle({top:this.currentDrag.getStyle("top")})}else{this.element.setStyle({bottom:this.currentDrag.getStyle("bottom")})}this.currentDrag.hide();this.currentDrag=null;if(this.doResize){this.setSize(this.width,this.height)}}},_notify:function(a){if(this.options[a]){this.options[a](this)}else{Windows.notify(a,this)}}};var Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:0.5},overlayHideEffectOptions:{duration:0.5},addObserver:function(a){this.removeObserver(a);this.observers.push(a)},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b==a})},notify:function(a,b){this.observers.each(function(c){if(c[a]){c[a](a,b)}})},getWindow:function(a){return this.windows.detect(function(b){return b.getId()==a})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},register:function(a){this.windows.push(a)},addModalWindow:function(a){if(this.modalWindows.length==0){WindowUtilities.disableScreen(a.options.className,"overlay_modal",a.overlayOpacity,a.getId(),a.options.parent)}else{if(Window.keepMultiModalWindow){$("overlay_modal").style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex+=1;WindowUtilities._hideSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.hide()}WindowUtilities._showSelect(a.getId())}this.modalWindows.push(a)},removeModalWindow:function(a){this.modalWindows.pop();if(this.modalWindows.length==0){WindowUtilities.enableScreen()}else{if(Window.keepMultiModalWindow){this.modalWindows.last().toFront();WindowUtilities._showSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.show()}}},register:function(a){this.windows.push(a)},unregister:function(a){this.windows=this.windows.reject(function(b){return b==a})},closeAll:function(){this.windows.each(function(a){Windows.close(a.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen();this.modalWindows.each(function(a){if(a){a.close()}})},minimize:function(c,a){var b=this.getWindow(c);if(b&&b.visible){b.minimize()}Event.stop(a)},maximize:function(c,a){var b=this.getWindow(c);if(b&&b.visible){b.maximize()}Event.stop(a)},close:function(c,a){var b=this.getWindow(c);if(b){b.close()}if(a){Event.stop(a)}},blur:function(b){var a=this.getWindow(b);if(!a){return}if(a.options.blurClassName){a.changeClassName(a.options.blurClassName)}if(this.focusedWindow==a){this.focusedWindow=null}a._notify("onBlur")},focus:function(b){var a=this.getWindow(b);if(!a){return}if(this.focusedWindow){this.blur(this.focusedWindow.getId())}if(a.options.focusClassName){a.changeClassName(a.options.focusClassName)}this.focusedWindow=a;a._notify("onFocus")},unsetOverflow:function(a){this.windows.each(function(b){b.oldOverflow=b.getContent().getStyle("overflow")||"auto";b.getContent().setStyle({overflow:"hidden"})});if(a&&a.oldOverflow){a.getContent().setStyle({overflow:a.oldOverflow})}},resetOverflow:function(){this.windows.each(function(a){if(a.oldOverflow){a.getContent().setStyle({overflow:a.oldOverflow})}})},updateZindex:function(a,b){if(a>this.maxZIndex){this.maxZIndex=a;if(this.focusedWindow){this.blur(this.focusedWindow.getId())}}this.focusedWindow=b;if(this.focusedWindow){this.focus(this.focusedWindow.getId())}}};var Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(e,c){if(e&&typeof e!="string"){Dialog._runAjaxRequest(e,c,Dialog.confirm);return}e=e||"";c=c||{};var g=c.okLabel?c.okLabel:"Ok";var a=c.cancelLabel?c.cancelLabel:"Cancel";c=Object.extend(c,c.windowParameters||{});c.windowParameters=c.windowParameters||{};c.className=c.className||"alert";var b="class ='"+(c.buttonClass?c.buttonClass+" ":"")+" ok_button'";var f="class ='"+(c.buttonClass?c.buttonClass+" ":"")+" cancel_button'";var e="      <div class='"+c.className+"_message'>"+e+"</div>        <div class='"+c.className+"_buttons'>          <input type='button' value='"+g+"' onclick='Dialog.okCallback()' "+b+"/>          <input type='button' value='"+a+"' onclick='Dialog.cancelCallback()' "+f+"/>        </div>    ";return this._openDialog(e,c)},alert:function(c,b){if(c&&typeof c!="string"){Dialog._runAjaxRequest(c,b,Dialog.alert);return}c=c||"";b=b||{};var e=b.okLabel?b.okLabel:"Ok";b=Object.extend(b,b.windowParameters||{});b.windowParameters=b.windowParameters||{};b.className=b.className||"alert";var a="class ='"+(b.buttonClass?b.buttonClass+" ":"")+" ok_button'";var c="      <div class='"+b.className+"_message'>"+c+"</div>        <div class='"+b.className+"_buttons'>          <input type='button' value='"+e+"' onclick='Dialog.okCallback()' "+a+"/>        </div>";return this._openDialog(c,b)},info:function(b,a){if(b&&typeof b!="string"){Dialog._runAjaxRequest(b,a,Dialog.info);return}b=b||"";a=a||{};a=Object.extend(a,a.windowParameters||{});a.windowParameters=a.windowParameters||{};a.className=a.className||"alert";var b="<div id='modal_dialog_message' class='"+a.className+"_message'>"+b+"</div>";if(a.showProgress){b+="<div id='modal_dialog_progress' class='"+a.className+"_progress'>  </div>"}a.ok=null;a.cancel=null;return this._openDialog(b,a)},setInfoMessage:function(a){$("modal_dialog_message").update(a)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(f,e){var c=e.className;if(!e.height&&!e.width){e.width=WindowUtilities.getPageSize(e.options.parent||document.body).pageWidth/2}if(e.id){this.dialogId=e.id}else{var b=new Date();this.dialogId="modal_dialog_"+b.getTime();e.id=this.dialogId}if(!e.height||!e.width){var a=WindowUtilities._computeSize(f,this.dialogId,e.width,e.height,5,c);if(e.height){e.width=a+5}else{e.height=a+5}}e.effectOptions=e.effectOptions;e.resizable=e.resizable||false;e.minimizable=e.minimizable||false;e.maximizable=e.maximizable||false;e.draggable=e.draggable||false;e.closable=e.closable||false;var g=new Window(e);g.getContent().innerHTML=f;g.showCenter(true,e.top,e.left);g.setDestroyOnClose();g.cancelCallback=e.onCancel||e.cancel;g.okCallback=e.onOk||e.ok;return g},_getAjaxContent:function(a){Dialog.callFunc(a.responseText,Dialog.parameters)},_runAjaxRequest:function(c,b,a){if(c.options==null){c.options={}}Dialog.onCompleteFunc=c.options.onComplete;Dialog.parameters=b;Dialog.callFunc=a;c.options.onComplete=Dialog._getAjaxContent;new Ajax.Request(c.url,c.options)},okCallback:function(){var a=Windows.focusedWindow;if(!a.okCallback||a.okCallback(a)){$$("#"+a.getId()+" input").each(function(b){b.onclick=null});a.close()}},cancelCallback:function(){var a=Windows.focusedWindow;$$("#"+a.getId()+" input").each(function(b){b.onclick=null});a.close();if(a.cancelCallback){a.cancelCallback(a)}}};if(Prototype.Browser.WebKit){var array=navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/));Prototype.Browser.WebKitVersion=parseFloat(array[1])}var WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body){T=parent.scrollTop;L=parent.scrollLeft;W=parent.scrollWidth;H=parent.scrollHeight}else{var w=window;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}}return{top:T,left:L,width:W,height:H}},getPageSize:function(e){e=e||document.body;var c,h;var f,b;if(e!=document.body){c=e.getWidth();h=e.getHeight();b=e.scrollWidth;f=e.scrollHeight}else{var g,a;if(window.innerHeight&&window.scrollMaxY){g=document.body.scrollWidth;a=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){g=document.body.scrollWidth;a=document.body.scrollHeight}else{g=document.body.offsetWidth;a=document.body.offsetHeight}}if(self.innerHeight){c=self.innerWidth;h=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){c=document.documentElement.clientWidth;h=document.documentElement.clientHeight}else{if(document.body){c=document.body.clientWidth;h=document.body.clientHeight}}}if(a<h){f=h}else{f=a}if(g<c){b=c}else{b=g}}return{pageWidth:b,pageHeight:f,windowWidth:c,windowHeight:h}},disableScreen:function(c,a,e,f,b){WindowUtilities.initLightbox(a,c,function(){this._disableScreen(c,a,e,f)}.bind(this),b||document.body)},_disableScreen:function(c,b,f,g){var e=$(b);var a=WindowUtilities.getPageSize(e.parentNode);if(g&&Prototype.Browser.IE){WindowUtilities._hideSelect();WindowUtilities._showSelect(g)}e.style.height=(a.pageHeight+"px");e.style.display="none";if(b=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions){e.overlayOpacity=f;new Effect.Appear(e,Object.extend({from:0,to:f},Windows.overlayShowEffectOptions))}else{e.style.display="block"}},enableScreen:function(b){b=b||"overlay_modal";var a=$(b);if(a){if(b=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions){new Effect.Fade(a,Object.extend({from:a.overlayOpacity,to:0},Windows.overlayHideEffectOptions))}else{a.style.display="none";a.parentNode.removeChild(a)}if(b!="__invisible__"){WindowUtilities._showSelect()}}},_hideSelect:function(a){if(Prototype.Browser.IE){a=a==null?"":"#"+a+" ";$$(a+"select").each(function(b){if(!WindowUtilities.isDefined(b.oldVisibility)){b.oldVisibility=b.style.visibility?b.style.visibility:"visible";b.style.visibility="hidden"}})}},_showSelect:function(a){if(Prototype.Browser.IE){a=a==null?"":"#"+a+" ";$$(a+"select").each(function(b){if(WindowUtilities.isDefined(b.oldVisibility)){try{b.style.visibility=b.oldVisibility}catch(c){b.style.visibility="visible"}b.oldVisibility=null}else{if(b.style.visibility){b.style.visibility="visible"}}})}},isDefined:function(a){return typeof(a)!="undefined"&&a!=null},initLightbox:function(f,c,a,b){if($(f)){Element.setStyle(f,{zIndex:Windows.maxZIndex+1});Windows.maxZIndex++;a()}else{var e=document.createElement("div");e.setAttribute("id",f);e.className="overlay_"+c;e.style.display="none";e.style.position="absolute";e.style.top="0";e.style.left="0";e.style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex++;e.style.width="100%";b.insertBefore(e,b.firstChild);if(Prototype.Browser.WebKit&&f=="overlay_modal"){setTimeout(function(){a()},10)}else{a()}}},setCookie:function(b,a){document.cookie=a[0]+"="+escape(b)+((a[1])?"; expires="+a[1].toGMTString():"")+((a[2])?"; path="+a[2]:"")+((a[3])?"; domain="+a[3]:"")+((a[4])?"; secure":"")},getCookie:function(c){var b=document.cookie;var f=c+"=";var e=b.indexOf("; "+f);if(e==-1){e=b.indexOf(f);if(e!=0){return null}}else{e+=2}var a=document.cookie.indexOf(";",e);if(a==-1){a=b.length}return unescape(b.substring(e+f.length,a))},_computeSize:function(f,a,b,h,e,g){var n=document.body;var c=document.createElement("div");c.setAttribute("id",a);c.className=g+"_content";if(h){c.style.height=h+"px"}else{c.style.width=b+"px"}c.style.position="absolute";c.style.top="0";c.style.left="0";c.style.display="none";c.innerHTML=f;n.insertBefore(c,n.firstChild);var j;if(h){j=$(c).getDimensions().width+e}else{j=$(c).getDimensions().height+e}n.removeChild(c);return j}};var defaultWindowWidth=500;var defaultWindowHeight=340;function showCenteredWindow(b,a){return showCenteredWindowSize(b,a,defaultWindowWidth,defaultWindowHeight)}var windowArray=new Array();function showCenteredWindowSize(e,b,a,c){var f=new Window("window_id_"+windowArray.length,{className:"mac_os_x",title:b,width:a,height:c,showEffect:Element.show,hideEffect:Element.hide});f.getContent().innerHTML=e;f.overlayShowEffectOptions=null;f.setDestroyOnClose();f.showCenter();windowArray[windowArray.length]=f;return f}function closeWindow(){windowArray[windowArray.length-1].close()}function showIframeWindow(a,b){return showIframeWindowSize(a,b,defaultWindowWidth,defaultWindowHeight)}function getFrame(a){return'<iframe src="'+a+'" border=0 width=100% height=100% frameborder="0" marginwidth="0" marginheight="0" scrolling="auto" align="absmiddle" vspace="0" hspace="0"></iframe>'}function showIframeWindowSize(b,c,a,e){var f=showCenteredWindowSize(getFrame(b),c,a,e);return f}function showIframeWindowLocation(a,b,f,e){var c=showIframeWindowSize(a,b,defaultWindowWidth,defaultWindowHeight);c._center(f,e);return c}function showIframeWindowRight(a,b){var c=showIframeWindowSize(a,b,defaultWindowWidth,defaultWindowHeight);c._center(null,WindowUtilities.getPageSize().windowWidth-defaultWindowWidth-100);return c}function overlibnz(){if(arguments.length>0&&arguments[0].length>0){overlib.apply(this,arguments)}}function overlibIframe(){var a=new Array();a[0]=getFrame(arguments[0]);for(i=1;i<arguments.length;i++){a[i]=arguments[i]}overlib.apply(this,a)}if(!window.DHTMLSuite){var DHTMLSuite=new Object()}if(!String.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")}}var DHTMLSuite_funcs=new Object();if(!window.DHTML_SUITE_THEME){var DHTML_SUITE_THEME="blue"}if(!window.DHTML_SUITE_THEME_FOLDER){var DHTML_SUITE_THEME_FOLDER="/js/htmlsuite/themes/"}if(!window.DHTML_SUITE_JS_FOLDER){var DHTML_SUITE_JS_FOLDER="../js/separateFiles/"}var DHTMLSuite=new Object();var standardObjectsCreated=false;DHTMLSuite.eventEls=new Array();var widgetDep=new Object();widgetDep.formValidator=["dhtmlSuite-formUtil.js"];widgetDep.paneSplitter=["dhtmlSuite-paneSplitter.js","dhtmlSuite-paneSplitterModel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.menuBar=["dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.windowWidget=["dhtmlSuite-windowWidget.js","dhtmlSuite-resize.js","dhtmlSuite-dragDropSimple.js","ajax.js","dhtmlSuite-dynamicContent.js"];widgetDep.colorWidget=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.colorSlider=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js","dhtmlSuite-slider.js"];widgetDep.colorPalette=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.calendar=["dhtmlSuite-calendar.js","dhtmlSuite-dragDropSimple.js"];widgetDep.dragDropTree=["dhtmlSuite-dragDropTree.js"];widgetDep.slider=["dhtmlSuite-slider.js"];widgetDep.dragDrop=["dhtmlSuite-dragDrop.js"];widgetDep.imageEnlarger=["dhtmlSuite-imageEnlarger.js","dhtmlSuite-dragDropSimple.js"];widgetDep.imageSelection=["dhtmlSuite-imageSelection.js"];widgetDep.floatingGallery=["dhtmlSuite-floatingGallery.js","dhtmlSuite-mediaModel.js"];widgetDep.contextMenu=["dhtmlSuite-contextMenu.js","dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.dynamicContent=["dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.textEdit=["dhtmlSuite-textEdit.js","dhtmlSuite-textEditModel.js","dhtmlSuite-listModel.js"];widgetDep.listModel=["dhtmlSuite-listModel.js"];widgetDep.resize=["dhtmlSuite-resize.js"];widgetDep.dragDropSimple=["dhtmlSuite-dragDropSimple.js"];widgetDep.dynamicTooltip=["dhtmlSuite-dynamicTooltip.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.modalMessage=["dhtmlSuite-modalMessage.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.tableWidget=["dhtmlSuite-tableWidget.js","ajax.js"];widgetDep.progressBar=["dhtmlSuite-progressBar.js"];widgetDep.tabView=["dhtmlSuite-tabView.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.infoPanel=["dhtmlSuite-infoPanel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.form=["dhtmlSuite-formUtil.js","dhtmlSuite-dynamicContent.js","ajax.js"];var depCache=new Object();DHTMLSuite.include=function(b){if(!widgetDep[b]){alert("Cannot find the files for widget "+b+". Please verify that the name is correct");return}var a=widgetDep[b];for(var c=0;c<a.length;c++){if(!depCache[a[c]]){document.write("<script");document.write(' language="javascript"');document.write(' type="text/javascript"');document.write(' src="'+DHTML_SUITE_JS_FOLDER+a[c]+'">');document.write("<\/script>");depCache[a[c]]=true}}};DHTMLSuite.discardElement=function(a){a=DHTMLSuite.commonObj.getEl(a);var b=document.getElementById("IELeakGBin");if(!b){b=document.createElement("DIV");b.id="IELeakGBin";b.style.display="none";document.body.appendChild(b)}b.appendChild(a);b.innerHTML=""};DHTMLSuite.createStandardObjects=function(){DHTMLSuite.clientInfoObj=new DHTMLSuite.clientInfo();DHTMLSuite.clientInfoObj.init();if(!DHTMLSuite.configObj){DHTMLSuite.configObj=new DHTMLSuite.config();DHTMLSuite.configObj.init()}DHTMLSuite.commonObj=new DHTMLSuite.common();DHTMLSuite.variableStorage=new DHTMLSuite.globalVariableStorage();DHTMLSuite.commonObj.init();DHTMLSuite.domQueryObj=new DHTMLSuite.domQuery();DHTMLSuite.commonObj.addEvent(window,"unload",function(){DHTMLSuite.commonObj.__clearMemoryGarbage()});standardObjectsCreated=true};DHTMLSuite.config=function(){var a;var c;var b;var e};DHTMLSuite.config.prototype={init:function(){this.imagePath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+"/images/";this.cssPath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+"/css/";this.defaultCssPath=this.cssPath;this.defaultImagePath=this.imagePath},setCssPath:function(a){this.cssPath=a},resetCssPath:function(){this.cssPath=this.defaultCssPath},resetImagePath:function(){this.imagePath=this.defaultImagePath},setImagePath:function(a){this.imagePath=a}};DHTMLSuite.globalVariableStorage=function(){var c;this.menuBar_highlightedItems=new Array();var e;var b;this.arrayDSObjects=new Array();this.arrayOfDhtmlSuiteObjects=this.arrayDSObjects;var a;this.ajaxObjects=new Array()};DHTMLSuite.globalVariableStorage.prototype={};DHTMLSuite.common=function(){var e;var c;var a;var b;this.okToSelect=true;this.cssCacheStatus=true;this.eventEls=new Array()};DHTMLSuite.common.prototype={init:function(){this.loadedCSSFiles=new Array()},loadCSS:function(b,c){if(!c&&c!==false){c=true}if(!this.loadedCSSFiles[b]){this.loadedCSSFiles[b]=true;var a=document.createElement("LINK");if(!this.cssCacheStatus){if(b.indexOf("?")>=0){b=b+"&"}else{b=b+"?"}b=b+"rand="+Math.random()}if(c){a.href=DHTMLSuite.configObj.cssPath+b}else{a.href=b}a.rel="stylesheet";a.media="screen";a.type="text/css";document.getElementsByTagName("HEAD")[0].appendChild(a)}},__setTextSelOk:function(a){this.okToSelect=a},__isTextSelOk:function(){return this.okToSelect},setCssCacheStatus:function(a){this.cssCacheStatus=a},getEl:function(a){if(typeof a=="string"){if(document.getElementById(a)){return document.getElementById(a)}if(document.forms[a]){return document.forms[a]}if(document[a]){return document[a]}if(window[a]){return window[a]}}return a},isArray:function(a){if(a.constructor.toString().indexOf("Array")!=-1){return true}return false},getStyle:function(b,c){b=this.getEl(b);if(document.defaultView&&document.defaultView.getComputedStyle){var e=null;var a=document.defaultView.getComputedStyle(b,"");if(a){e=a[c]}return b.style[c]||e}if(document.documentElement.currentStyle&&DHTMLSuite.clientInfoObj.isMSIE){var e=null;if(b.currentStyle){value=b.currentStyle[c]}return(b.style[c]||e)}return b.style[c]},getLeftPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).x}}var a=b.offsetLeft;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=b.offsetLeft;if(document.all){a+=b.clientLeft}}}return a},getTopPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).y}}var a=b.offsetTop;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=(b.offsetTop-b.scrollTop);if(document.all){a+=b.clientTop}}}return a},getCookie:function(c){var e=document.cookie.indexOf(c+"=");var a=e+c.length+1;if((!e)&&(c!=document.cookie.substring(0,c.length))){return null}if(e==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))},setCookie:function(b,g,c,n,e,a){c=c*60*60*24*1000;var f=new Date();var h=new Date(f.getTime()+(c));var j=b+"="+escape(g)+((c)?";expires="+h.toGMTString():"")+((n)?";path="+n:"")+((e)?";domain="+e:"")+((a)?";secure":"");document.cookie=j},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu,01-Jan-1970 00:00:01 GMT"}},cancelEvent:function(){return false},addEvent:function(e,b,a,c){if(!c){c=""}if(e.attachEvent){if(typeof DHTMLSuite_funcs[b+a+c]!="function"){DHTMLSuite_funcs[b+a+c]=function(){a.apply(window.event.srcElement)};e.attachEvent("on"+b,DHTMLSuite_funcs[b+a+c])}e=null}else{e.addEventListener(b,a,false)}this.__addEventEl(e)},removeEvent:function(e,b,a,c){if(e.detachEvent){e.detachEvent("on"+b,DHTMLSuite_funcs[b+a+c]);DHTMLSuite_funcs[b+a+c]=null;e=null}else{e.removeEventListener(b,a,false)}},__clearMemoryGarbage:function(){if(!DHTMLSuite.clientInfoObj.isMSIE){return}for(var c=0;c<DHTMLSuite.eventEls.length;c++){try{var a=DHTMLSuite.eventEls[c];a.onclick=null;a.onmousedown=null;a.onmousemove=null;a.onmouseout=null;a.onmouseover=null;a.onmouseup=null;a.onfocus=null;a.onblur=null;a.onkeydown=null;a.onkeypress=null;a.onkeyup=null;a.onselectstart=null;a.ondragstart=null;a.oncontextmenu=null;a.onscroll=null;a=null}catch(b){}}for(var c in DHTMLSuite.variableStorage.arrayDSObjects){DHTMLSuite.variableStorage.arrayDSObjects[c]=null}window.onbeforeunload=null;window.onunload=null;DHTMLSuite=null},__addEventEl:function(a){DHTMLSuite.eventEls[DHTMLSuite.eventEls.length]=a},getSrcElement:function(b){var a;if(b.target){a=b.target}else{if(b.srcElement){a=b.srcElement}}if(a.nodeType==3){a=a.parentNode}return a},getKeyFromEvent:function(b){var a=this.getKeyCode(b);return String.fromCharCode(a)},getKeyCode:function(a){if(a.keyCode){code=a.keyCode}else{if(a.which){code=a.which}}return code},isObjectClicked:function(c,b){var f=this.getSrcElement(b);var a=f.tagName+"("+f.className+")";if(f==c){return true}while(f.parentNode&&f.tagName.toLowerCase()!="html"){f=f.parentNode;a=a+","+f.tagName+"("+f.className+")";if(f==c){return true}}return false},getObjectByClassName:function(b,a){var c=this.getSrcElement(b);if(c.className==a){return c}while(c&&c.tagName.toLowerCase()!="html"){c=c.parentNode;if(c.className==a){return c}}return false},getObjectByAttribute:function(c,b){var f=this.getSrcElement(c);var a=f.getAttribute(b);if(!a){a=f[b]}if(a){return f}while(f&&f.tagName.toLowerCase()!="html"){f=f.parentNode;var a=f.getAttribute("attribute");if(!a){a=f[b]}if(a){return f}}return false},getUniqueId:function(){var b=Math.random()+"";b=b.replace(".","");var a=Math.random()+"";a=a.replace(".","");return b+a},getAssociativeArrayFromString:function(b){if(!b){return}var a=new Array();var c=b.split(/,/g);for(var f=0;f<c.length;f++){var e=c[f].split(/:/);a[e[0]]=e[1]}return a},correctPng:function(f){f=DHTMLSuite.commonObj.getEl(f);var b=f;var e=b.width;var a=b.height;var c="<span style=\"display:inline-block;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"',sizingMethod='scale');width:"+e+";height:"+a+'"></span>';b.outerHTML=c},__evaluateJs:function(g){g=this.getEl(g);var f=g.getElementsByTagName("SCRIPT");var b="";var e="";for(var h=0;h<f.length;h++){if(f[h].src){var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",f[h].src)}else{if(DHTMLSuite.clientInfoObj.isOpera){e=e+f[h].text+"\n"}else{e=e+f[h].innerHTML}}}if(e){this.__installScript(e)}},__installScript:function(a){try{if(!a){return}if(window.execScript){window.execScript(a)}else{if(window.jQuery&&jQuery.browser.safari){window.setTimeout(a,0)}else{window.setTimeout(a,0)}}}catch(b){}},__evaluateCss:function(b){b=this.getEl(b);var e=b.getElementsByTagName("STYLE");var a=document.getElementsByTagName("HEAD")[0];for(var c=0;c<e.length;c++){a.appendChild(e[c])}}};DHTMLSuite.clientInfo=function(){var e;var c;var a;var f;var g;var b;var f};DHTMLSuite.clientInfo.prototype={init:function(){this.browser=navigator.userAgent;this.isOpera=(this.browser.toLowerCase().indexOf("opera")>=0)?true:false;this.isFirefox=(this.browser.toLowerCase().indexOf("firefox")>=0)?true:false;this.isMSIE=(this.browser.toLowerCase().indexOf("msie")>=0)?true:false;this.isOldMSIE=(this.browser.toLowerCase().match(/msie\s[0-6]/gi))?true:false;this.isSafari=(this.browser.toLowerCase().indexOf("safari")>=0)?true:false;this.navigatorVersion=navigator.appVersion.replace(/.*?MSIE\s(\d\.\d).*/g,"$1")/1;this.isOldMSIE=(this.isMSIE&&this.navigatorVersion<7)?true:false},getBrowserWidth:function(){if(self.innerWidth){return self.innerWidth}return document.documentElement.offsetWidth},getBrowserHeight:function(){if(self.innerHeight){return self.innerHeight}return document.documentElement.offsetHeight}};DHTMLSuite.domQuery=function(){document.getElementsByClassName=this.getElementsByClassName;document.getElementsByAttribute=this.getElementsByAttribute};DHTMLSuite.domQuery.prototype={};if(!window.DHTMLSuite){var DHTMLSuite=new Object()}DHTMLSuite.calendarLanguageModel=function(j){var f;var c;var b;var h;var a;var g;var e;this.monthArray=new Array();this.monthArrayShort=new Array();this.dayArray=new Array();if(!j){j="en"}this.languageCode=j;this.__setCalendarProperties()};DHTMLSuite.calendarLanguageModel.prototype={__setCalendarProperties:function(){switch(this.languageCode){case"ge":this.monthArray=["Januar","Februar","M�rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];this.monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];this.dayArray=["Mon","Die","Mit","Don","Fre","Sam","Son"];this.weekString="Woche";this.todayIsString="Heute";this.todayString="Heute";this.timeString="";break;case"no":this.monthArray=["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"];this.monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"];this.dayArray=["Man","Tir","Ons","Tor","Fre","L&oslash;r","S&oslash;n"];this.weekString="Uke";this.todayIsString="Dagen i dag er";this.todayString="I dag";this.timeString="Tid";break;case"nl":this.monthArray=["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"];this.monthArrayShort=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];this.dayArray=["Ma","Di","Wo","Do","Vr","Za","Zo"];this.weekString="Week";this.todayIsString="Vandaag";this.todayString="Vandaag";this.timeString="";break;case"es":this.monthArray=["Enero","Febrero","Marzo","April","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];this.monthArrayShort=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];this.dayArray=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"];this.weekString="Semana";this.todayIsString="Hoy es";this.todayString="Hoy";this.timeString="";break;case"pt-br":this.monthArray=["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];this.monthArrayShort=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];this.dayArray=["Seg","Ter","Qua","Qui","Sex","S&aacute;b","Dom"];this.weekString="Sem.";this.todayIsString="Hoje &eacute;";this.todayString="Hoje";this.timeString="";break;case"fr":this.monthArray=["Janvier","F�vrier","Mars","Avril","Mai","Juin","Juillet","Ao�t","Septembre","Octobre","Novembre","D�cembre"];this.monthArrayShort=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"];this.dayArray=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];this.weekString="Sem";this.todayIsString="Aujourd'hui";this.todayString="Aujourd";this.timeString="";break;case"da":this.monthArray=["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"];this.monthArrayShort=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];this.dayArray=["man","tirs","ons","tors","fre","l&oslash;r","s&oslash;n"];this.weekString="Uge";this.todayIsString="I dag er den";this.todayString="I dag";this.timeString="Tid";break;case"it":this.monthArray=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];this.monthArrayShort=["Gen","Feb","Mar","Apr","Mag","Giu","Lugl","Ago","Set","Ott","Nov","Dic"];this.dayArray=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"];this.weekString="Sett";this.todayIsString="Oggi &egrave;il";this.todayString="Oggi &egrave;il";this.timeString="";break;case"sv":this.monthArray=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"];this.monthArrayShort=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];this.dayArray=["M&aring;n","Tis","Ons","Tor","Fre","L&ouml;r","S&ouml;n"];this.weekString="Vecka";this.todayIsString="Idag &auml;r det den";this.todayString="Idag &auml;r det den";this.timeString="";break;default:this.monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"];this.monthArrayShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.dayArray=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];this.weekString="Week";this.todayIsString="";this.todayString="Today";this.timeString="Time";break}}};DHTMLSuite.calendarModel=function(a){var c;var o;var j;var e;var v;var t;var n;var h;var q;var b;var u;var g;var p;var f;this.weekStartsOnMonday=true;this.languageCode="en";this.invalidDateRange=new Array();this.__createDefaultModel(a)};DHTMLSuite.calendarModel.prototype={setCallbackFunctionOnMonthChange:function(a){this.callbackFunctionOnMonthChange=a},addInvalidDateRange:function(c,b){var a=this.invalidDateRange.length;this.invalidDateRange[a]=new Object();if(c){c.day=c.day+"";c.month=c.month+"";c.year=c.year+"";if(!c.month){c.month=c.month="1"}if(!c.day){c.day=c.day="1"}if(c.day.length==1){c.day="0"+c.day}if(c.month.length==1){c.month="0"+c.month}this.invalidDateRange[a].fromDate=c.year+c.month+c.day}else{this.invalidDateRange[a].fromDate=false}if(b){b.day=b.day+"";b.month=b.month+"";b.year=b.year+"";if(!b.month){b.month=b.month="1"}if(!b.day){b.day=b.day="1"}if(b.day.length==1){b.day="0"+b.day}if(b.month.length==1){b.month="0"+b.month}this.invalidDateRange[a].toDate=b.year+b.month+b.day}else{this.invalidDateRange[a].toDate=false}},isDateWithinValidRange:function(c){if(this.invalidDateRange.length==0){return true}var e=c.month+"";if(e.length==1){e="0"+e}var b=c.day+"";if(b.length==1){b="0"+b}var a=c.year+e+b;for(var f=0;f<this.invalidDateRange.length;f++){if(!this.invalidDateRange[f].fromDate&&this.invalidDateRange[f].toDate>=a){return false}if(!this.invalidDateRange[f].toDate&&this.invalidDateRange[f].fromDate<=a){return false}if(this.invalidDateRange[f].fromDate<=a&&this.invalidDateRange[f].toDate>=a){return false}}return true},setInitialDateFromInput:function(q,n){if(q.value.length>0){if(!n.match(/^[0-9]*?$/gi)){var j=q.value.split(/[^0-9]/gi);var h=new Object();h.m=n.indexOf("mm");if(h.m==-1){h.m=n.indexOf("m")}h.d=n.indexOf("dd");if(h.d==-1){h.d=n.indexOf("d")}h.y=n.indexOf("yyyy");h.h=n.indexOf("hh");h.i=n.indexOf("ii");var b=Array();b[0]=h.m;b[1]=h.d;b[2]=h.y;b[3]=h.h;b[4]=h.i;b=b.sort(this.__calendarSortItems);var a=-1;this.initialHour="00";this.initialMinute="00";for(var p=0;p<b.length;p++){if(b[p]==-1){continue}a++;if(b[p]==h.m){this.initialMonth=j[a];continue}if(b[p]==h.y){this.initialYear=j[a];continue}if(b[p]==h.d){tmpDay=j[a];continue}if(b[p]==h.h){this.initialHour=j[a];continue}if(b[p]==h.i){this.initialMinute=j[a];continue}}this.initialMonth=this.initialMonth/1;tmpDay=tmpDay/1;this.initialDay=tmpDay}else{var o=n.indexOf("mm");this.initialMonth=q.value.substr(o,2)/1;var e=n.indexOf("yyyy");this.initialYear=q.value.substr(e,4);var g=n.indexOf("dd");tmpDay=q.value.substr(g,2);this.initialDay=tmpDay;var f=n.indexOf("hh");if(f>=0){tmpHour=q.value.substr(f,2);this.initialHour=tmpHour}else{this.initialHour="00"}var c=n.indexOf("ii");if(c>=0){tmpMinute=q.value.substr(c,2);this.initialMinute=tmpMinute}else{this.initialMinute="00"}}}this.__setDisplayedDateToInitialData()},__setDisplayedDateToInitialData:function(){this.displayedYear=this.initialYear;this.displayedMonth=this.initialMonth;this.displayedDay=this.initialDay;this.displayedHour=this.initialHour;this.displayedMinute=this.initialMinute},__calendarSortItems:function(e,c){return e/1-c/1},setWeekStartsOnMonday:function(a){this.weekStartsOnMonday=a},setLanguageCode:function(a){this.languageModel=new DHTMLSuite.calendarLanguageModel(a)},__isLeapYear:function(a){if(a%400==0||(a%4==0&&a%100!=0)){return true}return false},getWeekStartsOnMonday:function(){return this.weekStartsOnMonday},__createDefaultModel:function(a){var b=new Date();this.initialYear=b.getFullYear();this.initialMonth=b.getMonth()+1;this.initialDay=b.getDate();this.initialHour=b.getHours();if(a){if(a.initialYear){this.initialYear=a.initialYear}if(a.initialMonth){this.initialMonth=a.initialMonth}if(a.initialDay){this.initialDay=a.initialDay}if(a.initialHour){this.initialHour=a.initialHour}if(a.initialMinute){this.initialMinute=a.initialMinute}if(a.languageCode){this.languageCode=a.languageCode}}this.displayedYear=this.initialYear;this.displayedMonth=this.initialMonth;this.displayedDay=this.initialDay;this.displayedHour=this.initialHour;this.displayedMinute=this.initialMinute;this.languageModel=new DHTMLSuite.calendarLanguageModel()},__getDisplayedDay:function(){return this.displayedDay},__getDisplayedHourWithLeadingZeros:function(){var a=this.__getDisplayedHour()+"";if(a.length==1){a="0"+a}return a},__getDisplayedMinuteWithLeadingZeros:function(){var a=this.__getDisplayedMinute()+"";if(a.length==1){a="0"+a}return a},__getDisplayedDayWithLeadingZeros:function(){var a=this.__getDisplayedDay()+"";if(a.length==1){a="0"+a}return a},__getDisplayedMonthNumberWithLeadingZeros:function(){var a=this.__getDisplayedMonthNumber()+"";if(a.length==1){a="0"+a}return a},__getDisplayedYear:function(){return this.displayedYear},__getDisplayedHour:function(){if(!this.displayedHour){this.displayedHour=0}return this.displayedHour},__getDisplayedMinute:function(){if(!this.displayedMinute){this.displayedMinute=0}return this.displayedMinute},__getDisplayedMonthNumber:function(){return this.displayedMonth},__getInitialDay:function(){return this.initialDay},__getInitialYear:function(){return this.initialYear},__getInitialMonthNumber:function(){return this.initialMonth},__getMonthNameByMonthNumber:function(a){return this.languageModel.monthArray[a-1]},__moveOneYearBack:function(){this.displayedYear--},__moveOneYearForward:function(){this.displayedYear++},__moveOneMonthBack:function(){this.displayedMonth--;if(this.displayedMonth<1){this.displayedMonth=12;this.displayedYear--}},__moveOneMonthForward:function(){this.displayedMonth++;if(this.displayedMonth>12){this.displayedMonth=1;this.displayedYear++}},__setDisplayedYear:function(a){var b=a!=this.displayedYear;this.displayedYear=a;return b},__setDisplayedMonth:function(a){var b=a!=this.displayedMonth;this.displayedMonth=a;return b},__setDisplayedDay:function(a){this.displayedDay=a},__setDisplayedHour:function(a){this.displayedHour=a/1},__setDisplayedMinute:function(a){this.displayedMinute=a/1},__getPreviousYearAndMonthAsArray:function(){var c=this.displayedMonth-1;var b=this.displayedYear;if(c==0){c=12;b=b-1}var a=[b,c];return a},__getNumberOfDaysInCurrentDisplayedMonth:function(){return this.__getNumberOfDaysInAMonthByMonthAndYear(this.displayedYear,this.displayedMonth)},__getNumberOfDaysInAMonthByMonthAndYear:function(b,e){var c=[31,28,31,30,31,30,31,31,30,31,30,31];var a=c[e-1];if(a==28){if(this.__isLeapYear(b)){a=29}}return a/1},__getStringWeek:function(){return this.languageModel.weekString},__getDaysMondayToSunday:function(){return this.languageModel.dayArray},__getDaysSundayToSaturday:function(){var a=this.languageModel.dayArray.concat();var b=new Array(a[a.length-1]);a.pop();return b.concat(a)},__getWeekNumberFromDayMonthAndYear:function(g,e,j){j=j/1;g=g/1;e=e/1;if(!this.weekStartsOnMonday){return this.__getWeekNumberFromDayMonthAndYear_S(g,e,j)}var n=Math.floor((14-(e))/12);var h=g+4800-n;var c=(e)+(12*n)-3;var o=j+Math.floor(((153*c)+2)/5)+(365*h)+Math.floor(h/4)-Math.floor(h/100)+Math.floor(h/400)-32045;var p=(o+31741-(o%7))%146097%36524%1461;var f=Math.floor(p/1460);var b=((p-f)%365)+f;NumberOfWeek=Math.floor(b/7)+1;return NumberOfWeek},__getWeekNumberFromDayMonthAndYear_S:function(e,f,b){f--;now=Date.UTC(e,f,b+1,0,0,0);var a=new Date();a.setYear(e);a.setMonth(0);a.setDate(1);then=Date.UTC(e,0,1,0,0,0);var c=a.getDay();if(c>3){c-=4}else{c+=3}NumberOfWeek=Math.round((((now-then)/86400000)+c)/7);return NumberOfWeek},__getDayNumberFirstDayInYear:function(a){var b=new Date();b.setFullYear(a);b.setDate(1);b.setMonth(0);return b.getDay()},__getRemainingDaysInPreviousMonthAsArray:function(){var g=new Date();g.setFullYear(this.displayedYear);g.setDate(1);g.setMonth(this.displayedMonth-1);var b=g.getDay();if(this.weekStartsOnMonday){if(b==0){b=7}b--}var e=this.__getPreviousYearAndMonthAsArray();var a=this.__getNumberOfDaysInAMonthByMonthAndYear(e[0],e[1]);var c=new Array();for(var f=0;f<b;f++){c[c.length]=a-b+f+1}return c},__getMonthNames:function(){return this.languageModel.monthArray},__getTodayAsString:function(){return this.languageModel.todayString},__getTimeAsString:function(){return this.languageModel.timeString}};DHTMLSuite.calendar=function(z){var U;var ak;var B;var Y;var h;var Z;var x;var q;var aj;var A;var al;var p;var t;var o;var f;var L;var af;var ab;var S;var E;var H;var M;var u;var V;var ad;var I;var T;var j;var J;var b;var P;var D;var ac;var F;var ag;var n;var Q;var a;var O;var v;var N;var g;var K;var W;var G;var ai;var R;var C;this.displayTimeBar=false;this.minuteDropDownInterval=5;this.htmlElementReferences=new Object();this.posRefToHtmlEl=false;this.displayCloseButton=true;this.displayNavigationBar=true;this.displayTodaysDateInNavigationBar=true;this.yearDropDownOffsetInYear=0;this.hourDropDownOffsetInHour=0;this.minuteDropDownOffsetInHour=0;this.minuteDropDownOffsetInMinute=0;this.layoutCSS="calendar.css";this.isDragable=false;this.scrollInYearDropDownActive=false;this.scrollInHourDropDownActive=false;this.scrollInMinuteDropDownActive=false;this.numberOfRowsInMinuteDropDown=10;this.numberOfRowsInHourDropDown=10;this.numberOfRowsInYearDropDown=10;var w;var ae;var X;var c;this.dateOfToday=new Date();try{if(!standardObjectsCreated){DHTMLSuite.createStandardObjects()}}catch(ah){alert("Include the dhtmlSuite-common.js file")}this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this;if(z){this.__setInitialData(z)}};DHTMLSuite.calendar.prototype={setCallbackFunctionOnDayClick:function(a){this.callbackFunctionOnDayClick=a},setCallbackFunctionOnMonthChange:function(a){if(!this.calendarModelReference){this.calendarModelReference=new DHTMLSuite.calendarModel()}this.callbackFunctionOnMonthChange=a},setCallbackFunctionOnClose:function(a){this.callbackFunctionOnClose=a},setCalendarModelReference:function(a){this.calendarModelReference=a},setCalendarPositionByHTMLElement:function(c,a,b){c=DHTMLSuite.commonObj.getEl(c);this.posRefToHtmlEl=c;if(!a){a=0}if(!b){b=0}this.positioningOffsetXInPixels=a;this.positioningOffsetYInPixels=b},addHtmlElementReference:function(a,b){b=DHTMLSuite.commonObj.getEl(b);if(a){this.htmlElementReferences[a]=b}},getHtmlElementReferences:function(){return this.htmlElementReferences},setDisplayCloseButton:function(a){this.displayCloseButton=a},setTargetReference:function(a){a=DHTMLSuite.commonObj.getEl(a);this.targetReference=a},setIsDragable:function(a){this.isDragable=a},resetViewDisplayedMonth:function(){if(!this.divElement){return}if(!this.calendarModelReference){this.calendarModelReference=new DHTMLSuite.calendarModel()}this.calendarModelReference.__setDisplayedDateToInitialData();this.__populateCalHeading();this.__populateMonthView()},setLayoutCss:function(a){this.layoutCSS=a},__init:function(){if(!this.divElement){DHTMLSuite.commonObj.loadCSS(this.layoutCSS);if(!this.calendarModelReference){this.calendarModelReference=new DHTMLSuite.calendarModel()}this.__createMainHtmlEls();this.__createHeadingElements();this.__createNavigationBar();this.__populateNavigationBar();this.__populateCalHeading();this.__createCalMonthView();this.__populateMonthView();this.__createTimeBar();this.__populateTimeBar();this.__createDropDownYears();this.__populateDropDownYears();this.__positionDropDownYears();this.__createDropDownMonth();this.__populateDropDownMonths();this.__positionDropDownMonths();this.__createDropDownHours();this.__populateDropDownHours();this.__positionDropDownHours();this.__createDropDownMinutes();this.__populateDropDownMinutes();this.__positionDropDownMinutes();this.__addEvents()}else{this.divElement.style.display="block";this.__populateCalHeading();this.__populateMonthView()}this.__resizePrimaryiframeEl()},display:function(){if(!this.divElement){this.__init()}this.__positionCalendar();this.divElement.style.display="block";this.__resizePrimaryiframeEl()},hide:function(){if(this.__handleCalendarCallBack("calendarClose")===false){return false}this.divElement.style.display="none";this.divElYearDropdown.style.display="none";this.divElMonthDropdown.style.display="none"},isVisible:function(){if(!this.divElement){return false}return this.divElement.style.display=="block"?true:false},setInitialDateFromInput:function(a,b){if(!this.calendarModelReference){this.calendarModelReference=new DHTMLSuite.calendarModel()}this.calendarModelReference.setInitialDateFromInput(a,b)},setDisplayedYear:function(a){var b=this.calendarModelReference.__setDisplayedYear(a);this.__populateCalHeading();this.__populateMonthView();if(b){this.__handleCalendarCallBack("monthChange")}},setDisplayedMonth:function(a){var b=this.calendarModelReference.__setDisplayedMonth(a);this.__populateCalHeading();this.__populateMonthView();if(b){this.__handleCalendarCallBack("monthChange")}},setDisplayedHour:function(a){this.calendarModelReference.__setDisplayedHour(a);this.__populateTimeBar()},setDisplayedMinute:function(a){this.calendarModelReference.__setDisplayedMinute(a);this.__populateTimeBar()},__createDropDownMonth:function(){this.divElMonthDropdown=document.createElement("DIV");this.divElMonthDropdown.style.display="none";this.divElMonthDropdown.className="DHTMLSuite_calendar_monthDropDown";document.body.appendChild(this.divElMonthDropdown)},__populateDropDownMonths:function(){this.divElMonthDropdown.innerHTML="";var b=this.objectIndex;var a=this.calendarModelReference.__getMonthNames();for(var c=0;c<a.length;c++){var e=document.createElement("DIV");e.className="DHTMLSuite_calendar_dropDownAMonth";if((c+1)==this.calendarModelReference.__getDisplayedMonthNumber()){e.className="DHTMLSuite_calendar_yearDropDownCurrentMonth"}e.innerHTML=a[c];e.id="DHTMLSuite_calendarMonthPicker"+(c+1);e.onmouseover=this.__mouseoverMonthInDropDown;e.onmouseout=this.__mouseoutMonthInDropDown;e.onclick=function(f){DHTMLSuite.variableStorage.arrayDSObjects[b].__setMonthFromDropdown(f)};this.divElMonthDropdown.appendChild(e);DHTMLSuite.commonObj.__addEventEl(e)}},__createDropDownYears:function(){this.divElYearDropdown=document.createElement("DIV");this.divElYearDropdown.style.display="none";this.divElYearDropdown.className="DHTMLSuite_calendar_yearDropDown";document.body.appendChild(this.divElYearDropdown)},__createDropDownHours:function(){this.divElHourDropdown=document.createElement("DIV");this.divElHourDropdown.style.display="none";this.divElHourDropdown.className="DHTMLSuite_calendar_hourDropDown";document.body.appendChild(this.divElHourDropdown)},__createDropDownMinutes:function(){this.divElMinuteDropdown=document.createElement("DIV");this.divElMinuteDropdown.style.display="none";this.divElMinuteDropdown.className="DHTMLSuite_calendar_minuteDropDown";document.body.appendChild(this.divElMinuteDropdown)},__populateDropDownMinutes:function(){var b=this.objectIndex;this.divElMinuteDropdown.innerHTML="";var a=document.createElement("DIV");a.className="DHTMLSuite_calendar_dropDown_arrowUp";a.onmouseover=function(f){DHTMLSuite.variableStorage.arrayDSObjects[b].__mouseoverUpAndDownArrowsInDropDownMinutes(f)};a.onmouseout=function(f){DHTMLSuite.variableStorage.arrayDSObjects[b].__mouseoutUpAndDownArrowsInDropDownMinutes(f)};this.divElMinuteDropdown.appendChild(a);DHTMLSuite.commonObj.__addEventEl(a);this.divElMinuteDropdownParent=document.createElement("DIV");this.divElMinuteDropdown.appendChild(this.divElMinuteDropdownParent);this.__populateMinutesInsideDropDownMinutes(this.divElMinuteDropdownParent);var c=document.createElement("DIV");c.className="DHTMLSuite_calendar_dropDown_arrowDown";c.innerHTML="<span></span>";c.onmouseover=function(f){DHTMLSuite.variableStorage.arrayDSObjects[b].__mouseoverUpAndDownArrowsInDropDownMinutes(f)};c.onmouseout=function(f){DHTMLSuite.variableStorage.arrayDSObjects[b].__mouseoutUpAndDownArrowsInDropDownMinutes(f)};DHTMLSuite.commonObj.__addEventEl(c);this.divElMinuteDropdown.appendChild(c);if(60/this.minuteDropDownInterval<this.numberOfRowsInMinuteDropDown){a.style.display="none";c.style.display="none"}},__populateMinutesInsideDropDownMinutes:function(){var c=this.objectIndex;this.divElMinuteDropdownParent.innerHTML="";if(60/this.minuteDropDownInterval<this.numberOfRowsInMinuteDropDown){a=0}else{var a=Math.max(0,(this.calendarModelReference.__getDisplayedMinute()-Math.round(this.numberOfRowsInMinuteDropDown/2)));a+=(this.minuteDropDownOffsetInMinute*this.minuteDropDownInterval);if(a<0){a+=this.minuteDropDownInterval;this.minuteDropDownOffsetInMinute++}if(a+(this.numberOfRowsInMinuteDropDown*this.minuteDropDownInterval)>60){a-=this.minuteDropDownInterval;this.minuteDropDownOffsetInMinute--}}for(var e=a;e<Math.min(60,a+this.numberOfRowsInMinuteDropDown*(this.minuteDropDownInterval));e+=this.minuteDropDownInterval){var f=document.createElement("DIV");f.className="DHTMLSuite_calendar_dropDownAMinute";if(e==this.calendarModelReference.__getDisplayedMinute()){f.className="DHTMLSuite_calendar_minuteDropDownCurrentMinute"}var b="";if(e<10){b="0"}f.innerHTML=b+e;f.onmouseover=this.__mouseoverMinuteInDropDown;f.onmouseout=this.__mouseoutMinuteInDropDown;f.onclick=function(g){DHTMLSuite.variableStorage.arrayDSObjects[c].__setMinuteFromDropdown(g)};this.divElMinuteDropdownParent.appendChild(f);DHTMLSuite.commonObj.__addEventEl(f)}},__populateDropDownHours:function(){var a=this.objectIndex;this.divElHourDropdown.innerHTML="";var b=document.createElement("DIV");b.className="DHTMLSuite_calendar_dropDown_arrowUp";b.onmouseover=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoverUpAndDownArrowsInDropDownHours(c)};b.onmouseout=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoutUpAndDownArrowsInDropDownHours(c)};this.divElHourDropdown.appendChild(b);DHTMLSuite.commonObj.__addEventEl(b);this.divElHourDropdownParentHours=document.createElement("DIV");this.divElHourDropdown.appendChild(this.divElHourDropdownParentHours);this.__populateHoursInsideDropDownHours(this.divElHourDropdownParentHours);var b=document.createElement("DIV");b.className="DHTMLSuite_calendar_dropDown_arrowDown";b.innerHTML="<span></span>";b.onmouseover=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoverUpAndDownArrowsInDropDownHours(c)};b.onmouseout=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoutUpAndDownArrowsInDropDownHours(c)};DHTMLSuite.commonObj.__addEventEl(b);this.divElHourDropdown.appendChild(b)},__populateHoursInsideDropDownHours:function(){var b=this.objectIndex;this.divElHourDropdownParentHours.innerHTML="";var e=Math.max(0,(this.calendarModelReference.__getDisplayedHour()-Math.round(this.numberOfRowsInHourDropDown/2)));e=Math.min(14,e);if((e+this.hourDropDownOffsetInHour+this.numberOfRowsInHourDropDown)>24){this.hourDropDownOffsetInHour=(24-e-this.numberOfRowsInHourDropDown)}if((e+this.hourDropDownOffsetInHour)<0){this.hourDropDownOffsetInHour=e*-1}e+=this.hourDropDownOffsetInHour;if(e<0){e=0}if(e>(24-this.numberOfRowsInHourDropDown)){e=(24-this.numberOfRowsInHourDropDown)}for(var c=e;c<e+this.numberOfRowsInHourDropDown;c++){var f=document.createElement("DIV");f.className="DHTMLSuite_calendar_dropDownAnHour";if(c==this.calendarModelReference.__getDisplayedHour()){f.className="DHTMLSuite_calendar_hourDropDownCurrentHour"}var a="";if(c<10){a="0"}f.innerHTML=a+c;f.onmouseover=this.__mouseoverHourInDropDown;f.onmouseout=this.__mouseoutHourInDropDown;f.onclick=function(g){DHTMLSuite.variableStorage.arrayDSObjects[b].__setHourFromDropdown(g)};this.divElHourDropdownParentHours.appendChild(f);DHTMLSuite.commonObj.__addEventEl(f)}},__populateDropDownYears:function(){var a=this.objectIndex;this.divElYearDropdown.innerHTML="";var b=document.createElement("DIV");b.className="DHTMLSuite_calendar_dropDown_arrowUp";b.onmouseover=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoverUpAndDownArrowsInDropDownYears(c)};b.onmouseout=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoutUpAndDownArrowsInDropDownYears(c)};this.divElYearDropdown.appendChild(b);DHTMLSuite.commonObj.__addEventEl(b);this.divElYearDropdownParentYears=document.createElement("DIV");this.divElYearDropdown.appendChild(this.divElYearDropdownParentYears);this.__populateYearsInsideDropDownYears(this.divElYearDropdownParentYears);var b=document.createElement("DIV");b.className="DHTMLSuite_calendar_dropDown_arrowDown";b.innerHTML="<span></span>";b.onmouseover=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoverUpAndDownArrowsInDropDownYears(c)};b.onmouseout=function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__mouseoutUpAndDownArrowsInDropDownYears(c)};DHTMLSuite.commonObj.__addEventEl(b);this.divElYearDropdown.appendChild(b)},__populateYearsInsideDropDownYears:function(c){var b=this.objectIndex;this.divElYearDropdownParentYears.innerHTML="";var a=this.calendarModelReference.__getDisplayedYear()-5+this.yearDropDownOffsetInYear;for(var e=a;e<a+this.numberOfRowsInYearDropDown;e++){var f=document.createElement("DIV");f.className="DHTMLSuite_calendar_dropDownAYear";if(e==this.calendarModelReference.__getDisplayedYear()){f.className="DHTMLSuite_calendar_yearDropDownCurrentYear"}f.innerHTML=e;f.onmouseover=this.__mouseoverYearInDropDown;f.onmouseout=this.__mouseoutYearInDropDown;f.onclick=function(g){DHTMLSuite.variableStorage.arrayDSObjects[b].__setYearFromDropdown(g)};this.divElYearDropdownParentYears.appendChild(f);DHTMLSuite.commonObj.__addEventEl(f)}},__positionDropDownMonths:function(){this.divElMonthDropdown.style.left=DHTMLSuite.commonObj.getLeftPos(this.divElMonthNInHead)+"px";this.divElMonthDropdown.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElMonthNInHead)+this.divElMonthNInHead.offsetHeight)+"px";if(this.iframeElDropDowns){var a=this.iframeElDropDowns.style;a.left=this.divElMonthDropdown.style.left;a.top=this.divElMonthDropdown.style.top;a.width=(this.divElMonthDropdown.clientWidth)+"px";a.height=this.divElMonthDropdown.clientHeight+"px";a.display=this.divElMonthDropdown.style.display}},__positionDropDownYears:function(){this.divElYearDropdown.style.left=DHTMLSuite.commonObj.getLeftPos(this.divElYearInHeading)+"px";this.divElYearDropdown.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElYearInHeading)+this.divElYearInHeading.offsetHeight)+"px";if(this.iframeElDropDowns){var a=this.iframeElDropDowns.style;a.left=this.divElYearDropdown.style.left;a.top=this.divElYearDropdown.style.top;a.width=(this.divElYearDropdown.clientWidth)+"px";a.height=this.divElYearDropdown.clientHeight+"px";a.display=this.divElYearDropdown.style.display}},__positionDropDownHours:function(){this.divElHourDropdown.style.left=DHTMLSuite.commonObj.getLeftPos(this.divElHrInTimeBar)+"px";this.divElHourDropdown.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElHrInTimeBar)+this.divElHrInTimeBar.offsetHeight)+"px";if(this.iframeElDropDowns){var a=this.iframeElDropDowns.style;a.left=this.divElHourDropdown.style.left;a.top=this.divElHourDropdown.style.top;a.width=(this.divElHourDropdown.clientWidth)+"px";a.height=this.divElHourDropdown.clientHeight+"px";a.display=this.divElHourDropdown.style.display}},__positionDropDownMinutes:function(){this.divElMinuteDropdown.style.left=DHTMLSuite.commonObj.getLeftPos(this.divElMinInTimeBar)+"px";this.divElMinuteDropdown.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElMinInTimeBar)+this.divElMinInTimeBar.offsetHeight)+"px";if(this.iframeElDropDowns){var a=this.iframeElDropDowns.style;a.left=this.divElMinuteDropdown.style.left;a.top=this.divElMinuteDropdown.style.top;a.width=(this.divElMinuteDropdown.clientWidth)+"px";a.height=this.divElMinuteDropdown.clientHeight+"px";a.display=this.divElMinuteDropdown.style.display}},__setMonthFromDropdown:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);this.__showHideDropDownBoxMonth();this.setDisplayedMonth(b.id.replace(/[^0-9]/gi,""))},__setYearFromDropdown:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);this.__showHideDropDownBoxYear();this.setDisplayedYear(b.innerHTML)},__setHourFromDropdown:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);this.__showHideDropDownBoxHour();this.setDisplayedHour(b.innerHTML)},__setMinuteFromDropdown:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);this.__showHideDropDownBoxMinute();this.setDisplayedMinute(b.innerHTML)},__autoHideDropDownBoxes:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);if(b.className.indexOf("MonthAndYear")>=0||b.className.indexOf("HourAndMinute")>=0){if(DHTMLSuite.commonObj.isObjectClicked(this.divElement,a)){return}}this.__showHideDropDownBoxMonth("none");this.__showHideDropDownBoxYear("none");this.__showHideDropDownBoxHour("none");this.__showHideDropDownBoxMinute("none")},__showHideDropDownBoxMonth:function(a){if(!a){this.__showHideDropDownBoxYear("none");this.__showHideDropDownBoxHour("none")}if(a){this.divElMonthDropdown.style.display=a}else{this.divElMonthDropdown.style.display=(this.divElMonthDropdown.style.display=="block"?"none":"block")}this.__populateDropDownMonths();this.__positionDropDownMonths()},__showHideDropDownBoxYear:function(a){if(!a){this.__showHideDropDownBoxMonth("none");this.__showHideDropDownBoxHour("none");this.__showHideDropDownBoxMinute("none")}if(a){this.divElYearDropdown.style.display=a}else{this.divElYearDropdown.style.display=(this.divElYearDropdown.style.display=="block"?"none":"block")}if(this.divElYearDropdown.style.display=="none"){this.yearDropDownOffsetInYear=0}else{this.__populateDropDownYears()}this.__positionDropDownYears()},__showHideDropDownBoxHour:function(a){if(!a){this.__showHideDropDownBoxYear("none");this.__showHideDropDownBoxMonth("none");this.__showHideDropDownBoxMinute("none")}if(a){this.divElHourDropdown.style.display=a}else{this.divElHourDropdown.style.display=(this.divElHourDropdown.style.display=="block"?"none":"block")}if(this.divElHourDropdown.style.display=="none"){this.hourDropDownOffsetInHour=0}else{this.__populateDropDownHours()}this.__positionDropDownHours()},__showHideDropDownBoxMinute:function(a){if(!a){this.__showHideDropDownBoxYear("none");this.__showHideDropDownBoxMonth("none");this.__showHideDropDownBoxHour("none")}if(a){this.divElMinuteDropdown.style.display=a}else{this.divElMinuteDropdown.style.display=(this.divElMinuteDropdown.style.display=="block"?"none":"block")}if(this.divElMinuteDropdown.style.display=="none"){this.minuteDropDownOffsetInMinute=0}else{this.__populateDropDownMinutes()}this.__positionDropDownMinutes()},__createMainHtmlEls:function(){this.divElement=document.createElement("DIV");this.divElement.className="DHTMLSuite_calendar";this.divElContent=document.createElement("DIV");this.divElement.appendChild(this.divElContent);this.divElContent.className="DHTMLSuite_calendarContent";if(this.targetReference){this.targetReference.appendChild(this.divElement)}else{document.body.appendChild(this.divElement)}if(this.isDragable){try{this.referenceToDragDropObject=new DHTMLSuite.dragDropSimple({elementReference:this.divElement})}catch(a){alert("Include DHTMLSuite-dragDropSimple.js for the drag feature")}}if(DHTMLSuite.clientInfoObj.isMSIE&&DHTMLSuite.clientInfoObj.navigatorVersion<8){this.iframeEl=document.createElement('<iframe src="about:blank" frameborder="0">');this.iframeEl.className="DHTMLSuite_calendar_iframe";this.iframeEl.style.left="0px";this.iframeEl.style.top="0px";this.iframeEl.style.position="absolute";this.divElement.appendChild(this.iframeEl);this.iframeElDropDowns=document.createElement('<iframe src="about:blank" frameborder="0">');this.iframeElDropDowns.className="DHTMLSuite_calendar_iframe";this.iframeElDropDowns.style.display="none";document.body.appendChild(this.iframeElDropDowns)}},__createHeadingElements:function(){this.divElHeading=document.createElement("DIV");if(this.isDragable){this.referenceToDragDropObject.addDragHandle(this.divElHeading);this.divElHeading.style.cursor="move"}this.divElHeading.className="DHTMLSuite_calendarHeading";this.divElContent.appendChild(this.divElHeading);this.divElHeading.style.position="relative";this.divElClose=document.createElement("DIV");this.divElClose.innerHTML="<span></span>";this.divElClose.className="DHTMLSuite_calendarCloseButton";this.divElHeading.appendChild(this.divElClose);if(!this.displayCloseButton){this.divElClose.style.display="none"}this.divElHeadingTxt=document.createElement("DIV");this.divElHeadingTxt.className="DHTMLSuite_calendarHeadingTxt";if(DHTMLSuite.clientInfoObj.isMSIE){var e=document.createElement('<TABLE cellpadding="0" cellspacing="0" border="0">')}else{var e=document.createElement("TABLE");e.setAttribute("cellpadding",0);e.setAttribute("cellspacing",0);e.setAttribute("border",0)}e.style.margin="0 auto";var b=document.createElement("TBODY");e.appendChild(b);this.divElHeadingTxt.appendChild(e);var f=b.insertRow(0);var a=f.insertCell(-1);this.divElMonthNInHead=document.createElement("DIV");this.divElMonthNInHead.className="DHTMLSuite_calendarHeaderMonthAndYear";a.appendChild(this.divElMonthNInHead);var a=f.insertCell(-1);var c=document.createElement("SPAN");c.innerHTML=",";a.appendChild(c);var a=f.insertCell(-1);this.divElYearInHeading=document.createElement("DIV");this.divElYearInHeading.className="DHTMLSuite_calendarHeaderMonthAndYear";a.appendChild(this.divElYearInHeading);this.divElHeading.appendChild(this.divElHeadingTxt)},__createNavigationBar:function(){this.divElNavBar=document.createElement("DIV");this.divElNavBar.className="DHTMLSuite_calendar_navigationBar";this.divElContent.appendChild(this.divElNavBar);this.divElBtnPreviousYear=document.createElement("DIV");this.divElBtnPreviousYear.className="DHTMLSuite_calendar_btnPreviousYear";this.divElBtnPreviousYear.innerHTML="<span></span>";this.divElNavBar.appendChild(this.divElBtnPreviousYear);this.divElBtnNextYear=document.createElement("DIV");this.divElBtnNextYear.className="DHTMLSuite_calendar_btnNextYear";this.divElBtnNextYear.innerHTML="<span></span>";this.divElNavBar.appendChild(this.divElBtnNextYear);this.divElBtnPrvMonth=document.createElement("DIV");this.divElBtnPrvMonth.className="DHTMLSuite_calendar_btnPreviousMonth";this.divElBtnPrvMonth.innerHTML="<span></span>";this.divElNavBar.appendChild(this.divElBtnPrvMonth);this.divElBtnNextMonth=document.createElement("DIV");this.divElBtnNextMonth.className="DHTMLSuite_calendar_btnNextMonth";this.divElBtnNextMonth.innerHTML="<span></span>";this.divElNavBar.appendChild(this.divElBtnNextMonth);this.divElTodayInNavBar=document.createElement("DIV");this.divElTodayInNavBar.className="DHTMLSuite_calendar_navigationBarToday";this.divElNavBar.appendChild(this.divElTodayInNavBar);if(!this.displayNavigationBar){this.divElNavBar.style.display="none"}if(!this.displayTodaysDateInNavigationBar){this.divElTodayInNavBar.style.display="none"}},__populateNavigationBar:function(){var b=this.objectIndex;this.divElTodayInNavBar.innerHTML="";var a=document.createElement("SPAN");a.innerHTML=this.calendarModelReference.__getTodayAsString();a.onclick=function(){DHTMLSuite.variableStorage.arrayDSObjects[b].__displayMonthOfToday()};this.divElTodayInNavBar.appendChild(a);DHTMLSuite.commonObj.__addEventEl(a)},__createCalMonthView:function(){this.divElMonthView=document.createElement("DIV");this.divElMonthView.className="DHTMLSuite_calendar_monthView";this.divElContent.appendChild(this.divElMonthView)},__populateMonthView:function(){var b=this.objectIndex;this.divElMonthView.innerHTML="";var f=this.calendarModelReference;if(DHTMLSuite.clientInfoObj.isMSIE){var q=document.createElement('<TABLE cellpadding="1" cellspacing="0" border="0" width="100%">')}else{var q=document.createElement("TABLE");q.setAttribute("cellpadding",1);q.setAttribute("cellspacing",0);q.setAttribute("border",0);q.width="100%"}var c=document.createElement("TBODY");q.appendChild(c);this.divElMonthView.appendChild(q);var t=c.insertRow(-1);t.className="DHTMLSuite_calendar_monthView_headerRow";var j=t.insertCell(-1);j.className="DHTMLSuite_calendar_monthView_firstColumn";j.innerHTML=f.__getStringWeek();if(f.getWeekStartsOnMonday()){var n=f.__getDaysMondayToSunday()}else{var n=f.__getDaysSundayToSaturday()}for(var o=0;o<n.length;o++){var j=t.insertCell(-1);j.innerHTML=n[o];j.className="DHTMLSuite_calendar_monthView_headerCell";if(f.getWeekStartsOnMonday()&&o==6){j.className="DHTMLSuite_calendar_monthView_headerSunday"}if(!f.getWeekStartsOnMonday()&&o==0){j.className="DHTMLSuite_calendar_monthView_headerSunday"}}var t=c.insertRow(-1);var j=t.insertCell(-1);j.className="DHTMLSuite_calendar_monthView_firstColumn";var a=f.__getWeekNumberFromDayMonthAndYear(f.__getDisplayedYear(),f.__getDisplayedMonthNumber(),1);j.innerHTML=a>0?a:53;var h=f.__getRemainingDaysInPreviousMonthAsArray();for(var o=0;o<h.length;o++){var j=t.insertCell(-1);j.innerHTML=h[o];j.className="DHTMLSuite_calendar_monthView_daysInOtherMonths"}var g=f.__getNumberOfDaysInCurrentDisplayedMonth();var e=h.length+1;for(var o=1;o<=g;o++){var j=t.insertCell(-1);j.innerHTML=o;j.className="DHTMLSuite_calendar_monthView_daysInThisMonth";DHTMLSuite.commonObj.__addEventEl(j);if(e%7==0&&f.getWeekStartsOnMonday()){j.className="DHTMLSuite_calendar_monthView_sundayInThisMonth"}if(e%7==1&&!f.getWeekStartsOnMonday()){j.className="DHTMLSuite_calendar_monthView_sundayInThisMonth"}if(o==f.__getInitialDay()&&f.__getDisplayedYear()==f.__getInitialYear()&&f.__getDisplayedMonthNumber()==f.__getInitialMonthNumber()){j.className="DHTMLSuite_calendar_monthView_initialDate"}if(!f.isDateWithinValidRange({year:f.__getDisplayedYear(),month:f.__getDisplayedMonthNumber(),day:o})){j.className="DHTMLSuite_calendar_monthView_invalidDate"}else{j.onmousedown=function(u){DHTMLSuite.variableStorage.arrayDSObjects[b].__mousedownOnDayInCalendar(u)};j.onmouseover=this.__mouseoverCalendarDay;j.onmouseout=this.__mouseoutCalendarDay;DHTMLSuite.commonObj.__addEventEl(j)}if(o==this.dateOfToday.getDate()&&f.__getDisplayedYear()==this.dateOfToday.getFullYear()&&f.__getDisplayedMonthNumber()==(this.dateOfToday.getMonth()+1)){j.className="DHTMLSuite_calendar_monthView_currentDate"}if(e%7==0&&o<g){var t=c.insertRow(-1);var j=t.insertCell(-1);j.className="DHTMLSuite_calendar_monthView_firstColumn";a++;j.innerHTML=a}e++}if((e-1)%7>0){var p=1;for(var o=(e-1)%7;o<7;o++){var j=t.insertCell(-1);j.innerHTML=p;j.className="DHTMLSuite_calendar_monthView_daysInOtherMonths";p++}}},__createTimeBar:function(){this.divElTimeBar=document.createElement("DIV");this.divElTimeBar.className="DHTMLSuite_calendar_timeBar";this.divElContent.appendChild(this.divElTimeBar);if(DHTMLSuite.clientInfoObj.isMSIE){var c=document.createElement('<TABLE cellpadding="0" cellspacing="0" border="0">')}else{var c=document.createElement("TABLE");c.setAttribute("cellpadding",0);c.setAttribute("cellspacing",0);c.setAttribute("border",0)}c.style.margin="0 auto";this.divElTimeBar.appendChild(c);var e=c.insertRow(0);var a=e.insertCell(-1);this.divElHrInTimeBar=document.createElement("DIV");this.divElHrInTimeBar.className="DHTMLSuite_calendar_timeBarHourAndMinute";a.appendChild(this.divElHrInTimeBar);var a=e.insertCell(-1);var b=document.createElement("SPAN");b.innerHTML=":";a.appendChild(b);var a=e.insertCell(-1);this.divElMinInTimeBar=document.createElement("DIV");this.divElMinInTimeBar.className="DHTMLSuite_calendar_timeBarHourAndMinute";a.appendChild(this.divElMinInTimeBar);this.divElTimeStringInTimeBar=document.createElement("DIV");this.divElTimeStringInTimeBar.className="DHTMLSuite_calendarTimeBarTimeString";this.divElTimeBar.appendChild(this.divElTimeStringInTimeBar);if(!this.displayTimeBar){this.divElTimeBar.style.display="none"}},__populateTimeBar:function(){this.divElHrInTimeBar.innerHTML=this.calendarModelReference.__getDisplayedHourWithLeadingZeros();this.divElMinInTimeBar.innerHTML=this.calendarModelReference.__getDisplayedMinuteWithLeadingZeros();this.divElTimeStringInTimeBar.innerHTML=this.calendarModelReference.__getTimeAsString()+":"},__populateCalHeading:function(){this.divElMonthNInHead.innerHTML=this.calendarModelReference.__getMonthNameByMonthNumber(this.calendarModelReference.__getDisplayedMonthNumber());this.divElYearInHeading.innerHTML=this.calendarModelReference.__getDisplayedYear()},__mousedownOnDayInCalendar:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);this.calendarModelReference.__setDisplayedDay(b.innerHTML);this.__handleCalendarCallBack("dayClick")},__handleCalendarCallBack:function(b){var a="";switch(b){case"dayClick":if(this.callbackFunctionOnDayClick){a=this.callbackFunctionOnDayClick}break;case"monthChange":if(this.callbackFunctionOnMonthChange){a=this.callbackFunctionOnMonthChange}break;case"calendarClose":if(this.callbackFunctionOnClose){a=this.callbackFunctionOnClose}break}if(a){a=a+"({ year:"+this.calendarModelReference.__getDisplayedYear()+',month:"'+this.calendarModelReference.__getDisplayedMonthNumberWithLeadingZeros()+'",day:"'+this.calendarModelReference.__getDisplayedDayWithLeadingZeros()+'",hour:"'+this.calendarModelReference.__getDisplayedHourWithLeadingZeros()+'",minute:"'+this.calendarModelReference.__getDisplayedMinuteWithLeadingZeros()+'",calendarRef:this';a=a+"})"}if(a){return this.__evaluateCallBackString(a)}},__evaluateCallBackString:function(callbackString){try{return eval(callbackString)}catch(e){alert("Could not excute call back function "+callbackString+"\n"+e.message)}},__displayMonthOfToday:function(){var c=new Date();var b=c.getMonth()+1;var a=c.getFullYear();this.setDisplayedYear(a);this.setDisplayedMonth(b)},__moveOneYearBack:function(){this.calendarModelReference.__moveOneYearBack();this.__populateCalHeading();this.__populateMonthView();this.__handleCalendarCallBack("monthChange")},__moveOneYearForward:function(){this.calendarModelReference.__moveOneYearForward();this.__populateCalHeading();this.__populateMonthView();this.__handleCalendarCallBack("monthChange")},__moveOneMonthBack:function(){this.calendarModelReference.__moveOneMonthBack();this.__populateCalHeading();this.__populateMonthView();this.__handleCalendarCallBack("monthChange")},__moveOneMonthForward:function(){this.calendarModelReference.__moveOneMonthForward();this.__populateCalHeading();this.__populateMonthView();this.__handleCalendarCallBack("monthChange")},__addEvents:function(){var a=this.objectIndex;this.divElClose.onmouseover=this.__mouseoverCalendarButton;this.divElClose.onmouseout=this.__mouseoutCalendarButton;this.divElClose.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].hide()};DHTMLSuite.commonObj.__addEventEl(this.divElClose);this.divElBtnPreviousYear.onmouseover=this.__mouseoverCalendarButton;this.divElBtnPreviousYear.onmouseout=this.__mouseoutCalendarButton;this.divElBtnPreviousYear.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__moveOneYearBack()};DHTMLSuite.commonObj.__addEventEl(this.divElBtnPreviousYear);this.divElBtnNextYear.onmouseover=this.__mouseoverCalendarButton;this.divElBtnNextYear.onmouseout=this.__mouseoutCalendarButton;this.divElBtnNextYear.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__moveOneYearForward()};DHTMLSuite.commonObj.__addEventEl(this.divElBtnNextYear);this.divElBtnPrvMonth.onmouseover=this.__mouseoverCalendarButton;this.divElBtnPrvMonth.onmouseout=this.__mouseoutCalendarButton;this.divElBtnPrvMonth.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__moveOneMonthBack()};DHTMLSuite.commonObj.__addEventEl(this.divElBtnPrvMonth);this.divElBtnNextMonth.onmouseover=this.__mouseoverCalendarButton;this.divElBtnNextMonth.onmouseout=this.__mouseoutCalendarButton;this.divElBtnNextMonth.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__moveOneMonthForward()};DHTMLSuite.commonObj.__addEventEl(this.divElBtnNextMonth);this.divElYearInHeading.onmouseover=this.__mouseoverMonthAndYear;this.divElYearInHeading.onmouseout=this.__mouseoutMonthAndYear;this.divElYearInHeading.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__showHideDropDownBoxYear()};DHTMLSuite.commonObj.__addEventEl(this.divElYearInHeading);this.divElMonthNInHead.onmouseover=this.__mouseoverMonthAndYear;this.divElMonthNInHead.onmouseout=this.__mouseoutMonthAndYear;this.divElMonthNInHead.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__showHideDropDownBoxMonth()};DHTMLSuite.commonObj.__addEventEl(this.divElMonthNInHead);this.divElHrInTimeBar.onmouseover=this.__mouseoverHourAndMinute;this.divElHrInTimeBar.onmouseout=this.__mouseoutHourAndMinute;this.divElHrInTimeBar.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__showHideDropDownBoxHour()};DHTMLSuite.commonObj.__addEventEl(this.divElHrInTimeBar);this.divElMinInTimeBar.onmouseover=this.__mouseoverHourAndMinute;this.divElMinInTimeBar.onmouseout=this.__mouseoutHourAndMinute;this.divElMinInTimeBar.onclick=function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__showHideDropDownBoxMinute()};DHTMLSuite.commonObj.__addEventEl(this.divElMinInTimeBar);this.divElHeading.onselectstart=function(){return false};DHTMLSuite.commonObj.__addEventEl(this.divElHeading);DHTMLSuite.commonObj.addEvent(document.documentElement,"click",function(b){DHTMLSuite.variableStorage.arrayDSObjects[a].__autoHideDropDownBoxes(b)},a+"")},__resizePrimaryiframeEl:function(){if(!this.iframeEl){return}this.iframeEl.style.width=this.divElement.clientWidth+"px";this.iframeEl.style.height=this.divElement.clientHeight+"px"},__scrollInYearDropDown:function(b){if(!this.scrollInYearDropDownActive){return}var a=this.objectIndex;this.yearDropDownOffsetInYear+=b;this.__populateYearsInsideDropDownYears();setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInYearDropDown("+b+")",150)},__mouseoverUpAndDownArrowsInDropDownYears:function(b){var a=this.objectIndex;if(document.all){b=event}var f=DHTMLSuite.commonObj.getSrcElement(b);var c=(f.className.toLowerCase().indexOf("up")>=0?-1:1);f.className=f.className+" DHTMLSuite_calendarDropDown_dropDownArrowOver";this.scrollInYearDropDownActive=true;setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInYearDropDown("+c+")",100)},__mouseoutUpAndDownArrowsInDropDownYears:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);b.className=b.className.replace(" DHTMLSuite_calendarDropDown_dropDownArrowOver","");this.scrollInYearDropDownActive=false},__scrollInHourDropDown:function(b){if(!this.scrollInHourDropDownActive){return}var a=this.objectIndex;this.hourDropDownOffsetInHour+=b;this.__populateHoursInsideDropDownHours();setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInHourDropDown("+b+")",150)},__mouseoverUpAndDownArrowsInDropDownHours:function(b){var a=this.objectIndex;if(document.all){b=event}var f=DHTMLSuite.commonObj.getSrcElement(b);var c=(f.className.toLowerCase().indexOf("up")>=0?-1:1);f.className=f.className+" DHTMLSuite_calendarDropDown_dropDownArrowOver";this.scrollInHourDropDownActive=true;setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInHourDropDown("+c+")",100)},__mouseoutUpAndDownArrowsInDropDownHours:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);b.className=b.className.replace(" DHTMLSuite_calendarDropDown_dropDownArrowOver","");this.scrollInHourDropDownActive=false},__scrollInMinuteDropDown:function(b){if(!this.scrollInMinuteDropDownActive){return}var a=this.objectIndex;this.minuteDropDownOffsetInMinute+=b;this.__populateMinutesInsideDropDownMinutes();setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInMinuteDropDown("+b+")",150)},__mouseoverUpAndDownArrowsInDropDownMinutes:function(b){var a=this.objectIndex;if(document.all){b=event}var f=DHTMLSuite.commonObj.getSrcElement(b);var c=(f.className.toLowerCase().indexOf("up")>=0?-1:1);f.className=f.className+" DHTMLSuite_calendarDropDown_dropDownArrowOver";this.scrollInMinuteDropDownActive=true;setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__scrollInMinuteDropDown("+c+")",100)},__mouseoutUpAndDownArrowsInDropDownMinutes:function(a){if(document.all){a=event}var b=DHTMLSuite.commonObj.getSrcElement(a);b.className=b.className.replace(" DHTMLSuite_calendarDropDown_dropDownArrowOver","");this.scrollInMinuteDropDownActive=false},__mouseoverYearInDropDown:function(){this.className=this.className+" DHTMLSuite_calendar_dropdownAYearOver"},__mouseoutYearInDropDown:function(){this.className=this.className.replace(" DHTMLSuite_calendar_dropdownAYearOver","")},__mouseoverHourInDropDown:function(){this.className=this.className+" DHTMLSuite_calendar_dropdownAnHourOver"},__mouseoutHourInDropDown:function(){this.className=this.className.replace(" DHTMLSuite_calendar_dropdownAnHourOver","")},__mouseoverMinuteInDropDown:function(){this.className=this.className+" DHTMLSuite_calendar_dropdownAMinuteOver"},__mouseoutMinuteInDropDown:function(){this.className=this.className.replace(" DHTMLSuite_calendar_dropdownAMinuteOver","")},__mouseoverMonthInDropDown:function(){this.className=this.className+" DHTMLSuite_calendar_dropdownAMonthOver"},__mouseoutMonthInDropDown:function(){this.className=this.className.replace(" DHTMLSuite_calendar_dropdownAMonthOver","")},__mouseoverCalendarDay:function(){this.className=this.className+" DHTMLSuite_calendarDayOver"},__mouseoutCalendarDay:function(){this.className=this.className.replace(" DHTMLSuite_calendarDayOver","")},__mouseoverCalendarButton:function(){this.className=this.className+" DHTMLSuite_calendarButtonOver"},__mouseoutCalendarButton:function(){this.className=this.className.replace(" DHTMLSuite_calendarButtonOver","")},__mouseoverMonthAndYear:function(){this.className=this.className+" DHTMLSuite_calendarHeaderMonthAndYearOver"},__mouseoutMonthAndYear:function(){this.className=this.className.replace(" DHTMLSuite_calendarHeaderMonthAndYearOver","")},__mouseoverHourAndMinute:function(){this.className=this.className+" DHTMLSuite_calendarTimeBarHourAndMinuteOver"},__mouseoutHourAndMinute:function(){this.className=this.className.replace(" DHTMLSuite_calendarTimeBarHourAndMinuteOver","")},__positionCalendar:function(){if(!this.posRefToHtmlEl){return}if(this.divElement.parentNode!=document.body){document.body.appendChild(this.divElement)}this.divElement.style.position="absolute";this.divElement.style.left=(DHTMLSuite.commonObj.getLeftPos(this.posRefToHtmlEl)+this.positioningOffsetXInPixels)+"px";this.divElement.style.top=(DHTMLSuite.commonObj.getTopPos(this.posRefToHtmlEl)+this.positioningOffsetYInPixels)+"px"},__setInitialData:function(a){if(a.id){this.id=a.id}if(a.targetReference){this.targetReference=a.targetReference}if(a.calendarModelReference){this.calendarModelReference=a.calendarModelReference}if(a.callbackFunctionOnDayClick){this.callbackFunctionOnDayClick=a.callbackFunctionOnDayClick}if(a.callbackFunctionOnMonthChange){this.callbackFunctionOnMonthChange=a.callbackFunctionOnMonthChange}if(a.callbackFunctionOnClose){this.callbackFunctionOnClose=a.callbackFunctionOnClose}if(a.displayCloseButton||a.displayCloseButton===false){this.displayCloseButton=a.displayCloseButton}if(a.displayNavigationBar||a.displayNavigationBar===false){this.displayNavigationBar=a.displayNavigationBar}if(a.displayTodaysDateInNavigationBar||a.displayTodaysDateInNavigationBar===false){this.displayTodaysDateInNavigationBar=a.displayTodaysDateInNavigationBar}if(a.minuteDropDownInterval){this.minuteDropDownInterval=a.minuteDropDownInterval}if(a.numberOfRowsInHourDropDown){this.numberOfRowsInHourDropDown=a.numberOfRowsInHourDropDown}if(a.numberOfRowsInMinuteDropDown){this.numberOfRowsInHourDropDown=a.numberOfRowsInMinuteDropDown}if(a.numberOfRowsInYearDropDown){this.numberOfRowsInYearDropDown=a.numberOfRowsInYearDropDown}if(a.isDragable||a.isDragable===false){this.isDragable=a.isDragable}if(a.displayTimeBar||a.displayTimeBar===false){this.displayTimeBar=a.displayTimeBar}}};if(!window.DHTMLSuite){var DHTMLSuite=new Object()}var DHTMLSuite_dragDropSimple_curZIndex=100000;var DHTMLSuite_dragDropSimple_curObjIndex=false;DHTMLSuite.dragDropSimple=function(o){var j;var f;var t;this.cloneNode=true;var c;var g;var w;var b;var a;var v;var B;var A;var x;var C;var D;var F;var E;var n;var u;this.positionSet=false;this.dragHandle=new Array();var q;var p;this.allowMoveX=true;this.allowMoveY=true;this.maxY=false;this.maxX=false;this.minX=false;this.minY=false;this.callbackOnAfterDrag=false;this.callbackOnBeforeDrag=false;this.dragStatus=-1;try{if(!standardObjectsCreated){DHTMLSuite.createStandardObjects()}}catch(z){alert("Include the dhtmlSuite-common.js file")}var h;this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this;this.__setInitProps(o);this.__init()};DHTMLSuite.dragDropSimple.prototype={__setInitProps:function(a){if(a.cloneNode===false||a.cloneNode){this.cloneNode=a.cloneNode}if(a.allowMoveX===false||a.allowMoveX){this.allowMoveX=a.allowMoveX}if(a.allowMoveY===false||a.allowMoveY){this.allowMoveY=a.allowMoveY}if(a.minY||a.minY===0){this.minY=a.minY}if(a.maxY||a.maxY===0){this.maxY=a.maxY}if(a.minX||a.minX===0){this.minX=a.minX}if(a.maxX||a.maxX===0){this.maxX=a.maxX}if(!a.initOffsetX){a.initOffsetX=0}if(!a.initOffsetY){a.initOffsetY=0}this.initOffsetX=a.initOffsetX;this.initOffsetY=a.initOffsetY;if(a.callbackOnBeforeDrag){this.callbackOnBeforeDrag=a.callbackOnBeforeDrag}if(a.callbackOnAfterDrag){this.callbackOnAfterDrag=a.callbackOnAfterDrag}if(a.callbackOnDuringDrag){this.callbackOnDuringDrag=a.callbackOnDuringDrag}a.elementReference=DHTMLSuite.commonObj.getEl(a.elementReference);this.divElement=a.elementReference;this.initialXPos=DHTMLSuite.commonObj.getLeftPos(this.divElement);this.initialYPos=DHTMLSuite.commonObj.getTopPos(this.divElement);if(a.dragHandle){this.dragHandle[this.dragHandle.length]=DHTMLSuite.commonObj.getEl(a.dragHandle)}},__init:function(){var a=this.objectIndex;this.divElement.objectIndex=a;this.divElement.setAttribute("objectIndex",a);this.divElement.style.padding="0px";if(this.allowMoveX){this.divElement.style.left=(DHTMLSuite.commonObj.getLeftPos(this.divElement)+this.initOffsetX)+"px"}if(this.allowMoveY){this.divElement.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElement)+this.initOffsetY)+"px"}this.divElement.style.position="absolute";this.divElement.style.margin="0px";if(this.divElement.style.zIndex&&this.divElement.style.zIndex/1>DHTMLSuite_dragDropSimple_curZIndex){DHTMLSuite_dragDropSimple_curZIndex=this.divElement.style.zIndex/1}DHTMLSuite_dragDropSimple_curZIndex=DHTMLSuite_dragDropSimple_curZIndex/1+1;this.divElement.style.zIndex=DHTMLSuite_dragDropSimple_curZIndex;if(this.cloneNode){var b=this.divElement.cloneNode(true);this.divElement.parentNode.insertBefore(b,this.divElement);b.style.visibility="hidden";document.body.appendChild(this.divElement)}DHTMLSuite.commonObj.addEvent(this.divElement,"mousedown",function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__initDragProcess(c)},a);DHTMLSuite.commonObj.addEvent(document.documentElement,"mousemove",function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__moveDragableElement(c)},a);DHTMLSuite.commonObj.addEvent(document.documentElement,"mouseup",function(c){DHTMLSuite.variableStorage.arrayDSObjects[a].__stopDragProcess(c)},a);if(!document.documentElement.onselectstart){document.documentElement.onselectstart=function(){return DHTMLSuite.commonObj.__isTextSelOk()}}},setCallbackOnAfterDrag:function(a){this.callbackOnAfterDrag=a},setCallbackOnBeforeDrag:function(a){this.callbackOnBeforeDrag=a},addDragHandle:function(a){this.dragHandle[this.dragHandle.length]=a},__initDragProcess:function(f){if(document.all){f=event}var c=this.objectIndex;DHTMLSuite_dragDropSimple_curObjIndex=c;var b=DHTMLSuite.variableStorage.arrayDSObjects[c];if(!DHTMLSuite.commonObj.isObjectClicked(b.divElement,f)){return}if(b.divElement.style.zIndex&&b.divElement.style.zIndex/1>DHTMLSuite_dragDropSimple_curZIndex){DHTMLSuite_dragDropSimple_curZIndex=b.divElement.style.zIndex/1}DHTMLSuite_dragDropSimple_curZIndex=DHTMLSuite_dragDropSimple_curZIndex/1+1;b.divElement.style.zIndex=DHTMLSuite_dragDropSimple_curZIndex;if(b.callbackOnBeforeDrag){b.__handleCallback("beforeDrag",f)}if(b.dragHandle.length>0){var a;for(var g=0;g<b.dragHandle.length;g++){if(!a){a=DHTMLSuite.commonObj.isObjectClicked(b.dragHandle[g],f)}}if(!a){return}}DHTMLSuite.commonObj.__setTextSelOk(false);b.mouse_x=f.clientX;b.mouse_y=f.clientY;b.el_x=b.divElement.style.left.replace("px","")/1;b.el_y=b.divElement.style.top.replace("px","")/1;b.dragTimer=0;b.__waitBeforeDragProcessStarts();return false},__waitBeforeDragProcessStarts:function(){var a=this.objectIndex;if(this.dragTimer>=0&&this.dragTimer<5){this.dragTimer++;setTimeout("DHTMLSuite.variableStorage.arrayDSObjects["+a+"].__waitBeforeDragProcessStarts()",5)}},__moveDragableElement:function(f){if(document.all){f=event}var c=this.objectIndex;var g=DHTMLSuite.variableStorage.arrayDSObjects[c];if(DHTMLSuite.clientInfoObj.isMSIE&&f.button!=1){return g.__stopDragProcess()}if(g.dragTimer==5){if(g.allowMoveX){var b=(f.clientX-this.mouse_x+this.el_x);if(this.maxX!==false){if(b+document.documentElement.scrollLeft>this.initialXPos+this.maxX){b=this.initialXPos+this.maxX}}if(this.minX!==false){if(b+document.documentElement.scrollLeft<this.initialXPos+this.minX){b=this.initialXPos+this.minX}}g.divElement.style.left=b+"px"}if(g.allowMoveY){var a=(f.clientY-g.mouse_y+g.el_y);if(this.maxY!==false){if(a>this.initialYPos+this.maxY){a=this.initialYPos+this.maxY}}if(this.minY!==false){if(a<this.initialYPos+this.minY){a=this.initialYPos+this.minY}}g.divElement.style.top=a+"px"}if(this.callbackOnDuringDrag){this.__handleCallback("duringDrag",f)}}return false},__stopDragProcess:function(b){var a=this.objectIndex;DHTMLSuite.commonObj.__setTextSelOk(true);var c=DHTMLSuite.variableStorage.arrayDSObjects[a];if(c.dragTimer==5){c.__handleCallback("afterDrag",b)}c.dragTimer=-1},__handleCallback:function(action,e){var callbackString="";switch(action){case"afterDrag":callbackString=this.callbackOnAfterDrag;break;case"beforeDrag":callbackString=this.callbackOnBeforeDrag;break;case"duringDrag":callbackString=this.callbackOnDuringDrag;break}if(callbackString){callbackString=callbackString+"(e)";try{eval(callbackString)}catch(e){alert("Could not execute callback function("+callbackString+")after drag")}}},__setNewCurrentZIndex:function(a){if(a>DHTMLSuite_dragDropSimple_curZIndex){DHTMLSuite_dragDropSimple_curZIndex=a/1+1}}};var stIsIE=
/*@cc_on!@*/
false;sorttable={init:function(a){if(arguments.callee.done&&!(a=="true")){return}arguments.callee.done=true;if(_timer){clearInterval(_timer)}if(!document.createElement||!document.getElementsByTagName){return}sorttable.DATE_RE=/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/;forEach(document.getElementsByTagName("table"),function(b){if(b.className.search(/\bsortable\b/)!=-1){sorttable.makeSortable(b)}})},makeSortable:function(b){if(b.getElementsByTagName("thead").length==0){the=document.createElement("thead");the.appendChild(b.rows[0]);b.insertBefore(the,b.firstChild)}if(b.tHead==null){b.tHead=b.getElementsByTagName("thead")[0]}sortbottomrows=[];for(var a=0;a<b.rows.length;a++){if(b.rows[a].className.search(/\bsortbottom\b/)!=-1){sortbottomrows[sortbottomrows.length]=b.rows[a]}}if(sortbottomrows){if(b.tFoot==null){tfo=document.createElement("tfoot");b.appendChild(tfo)}for(var a=0;a<sortbottomrows.length;a++){tfo.appendChild(sortbottomrows[a])}delete sortbottomrows}headrow=b.tHead.rows[b.tHead.rows.length-1].cells;for(var a=0;a<headrow.length;a++){if(!headrow[a].className.match(/\bsorttable_nosort\b/)){mtch=headrow[a].className.match(/\bsorttable_([a-z0-9]+)\b/);if(mtch){override=mtch[1]}if(mtch&&typeof sorttable["sort_"+override]=="function"){headrow[a].sorttable_sortfunction=sorttable["sort_"+override]}else{headrow[a].sorttable_sortfunction=sorttable.guessType(b,a)}headrow[a].sorttable_columnindex=a;headrow[a].sorttable_tbody=b.tBodies[0];dean_addEvent(headrow[a],"click",function(f){if(this.className.search(/\bsorttable_sorted\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace("sorttable_sorted","sorttable_sorted_reverse");this.removeChild(document.getElementById("sorttable_sortfwdind"));sortrevind=document.createElement("span");sortrevind.id="sorttable_sortrevind";sortrevind.innerHTML=stIsIE?'&nbsp<font face="webdings">5</font>':"&nbsp;&#x25B4;";this.appendChild(sortrevind);return}if(this.className.search(/\bsorttable_sorted_reverse\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace("sorttable_sorted_reverse","sorttable_sorted");this.removeChild(document.getElementById("sorttable_sortrevind"));sortfwdind=document.createElement("span");sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;";this.appendChild(sortfwdind);return}theadrow=this.parentNode;forEach(theadrow.childNodes,function(e){if(e.nodeType==1){e.className=e.className.replace("sorttable_sorted_reverse","");e.className=e.className.replace("sorttable_sorted","")}});sortfwdind=document.getElementById("sorttable_sortfwdind");if(sortfwdind){sortfwdind.parentNode.removeChild(sortfwdind)}sortrevind=document.getElementById("sorttable_sortrevind");if(sortrevind){sortrevind.parentNode.removeChild(sortrevind)}this.className+=" sorttable_sorted";sortfwdind=document.createElement("span");sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;";this.appendChild(sortfwdind);row_array=[];col=this.sorttable_columnindex;rows=this.sorttable_tbody.rows;for(var c=0;c<rows.length;c++){row_array[row_array.length]=[sorttable.getInnerText(rows[c].cells[col]),rows[c]]}row_array.sort(this.sorttable_sortfunction);tb=this.sorttable_tbody;for(var c=0;c<row_array.length;c++){tb.appendChild(row_array[c][1])}delete row_array})}}},guessType:function(c,b){sortfn=sorttable.sort_alpha;for(var a=0;a<c.tBodies[0].rows.length;a++){text=sorttable.getInnerText(c.tBodies[0].rows[a].cells[b]);if(text!=""){if(text.match(/^-?[�$�]?[\d,.]+%?$/)){return sorttable.sort_numeric}possdate=text.match(sorttable.DATE_RE);if(possdate){first=parseInt(possdate[1]);second=parseInt(possdate[2]);if(first>12){return sorttable.sort_ddmm}else{if(second>12){return sorttable.sort_mmdd}else{sortfn=sorttable.sort_ddmm}}}}}return sortfn},getInnerText:function(b){try{b.getAttribute("sorttable_customkey")}catch(f){return""}hasInputs=(typeof b.getElementsByTagName=="function")&&b.getElementsByTagName("input").length;if(b.getAttribute("sorttable_customkey")!=null){return b.getAttribute("sorttable_customkey")}else{if(typeof b.textContent!="undefined"&&!hasInputs){return b.textContent.replace(/^\s+|\s+$/g,"")}else{if(typeof b.innerText!="undefined"&&!hasInputs){return b.innerText.replace(/^\s+|\s+$/g,"")}else{if(typeof b.text!="undefined"&&!hasInputs){return b.text.replace(/^\s+|\s+$/g,"")}else{switch(b.nodeType){case 3:if(b.nodeName.toLowerCase()=="input"){return b.value.replace(/^\s+|\s+$/g,"")}case 4:return b.nodeValue.replace(/^\s+|\s+$/g,"");break;case 1:case 11:var c="";for(var a=0;a<b.childNodes.length;a++){c+=sorttable.getInnerText(b.childNodes[a])}return c.replace(/^\s+|\s+$/g,"");break;default:return""}}}}}},reverse:function(a){newrows=[];for(var b=0;b<a.rows.length;b++){newrows[newrows.length]=a.rows[b]}for(var b=newrows.length-1;b>=0;b--){a.appendChild(newrows[b])}delete newrows},sort_numeric:function(e,c){aa=parseFloat(e[0].replace(/[^0-9.-]/g,""));if(isNaN(aa)){aa=0}bb=parseFloat(c[0].replace(/[^0-9.-]/g,""));if(isNaN(bb)){bb=0}return aa-bb},sort_alpha:function(e,c){if(e[0]==c[0]){return 0}if(e[0]<c[0]){return -1}return 1},sort_ddmm:function(e,c){mtch=e[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt1=y+m+d;mtch=c[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt2=y+m+d;if(dt1==dt2){return 0}if(dt1<dt2){return -1}return 1},sort_mmdd:function(e,c){mtch=e[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt1=y+m+d;mtch=c[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1){m="0"+m}if(d.length==1){d="0"+d}dt2=y+m+d;if(dt1==dt2){return 0}if(dt1<dt2){return -1}return 1},shaker_sort:function(h,f){var a=0;var e=h.length-1;var j=true;while(j){j=false;for(var c=a;c<e;++c){if(f(h[c],h[c+1])>0){var g=h[c];h[c]=h[c+1];h[c+1]=g;j=true}}e--;if(!j){break}for(var c=e;c>a;--c){if(f(h[c],h[c-1])<0){var g=h[c];h[c]=h[c-1];h[c-1]=g;j=true}}a++}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",sorttable.init,false);
/*@cc_on @*/
/*@if (@_win32)
    document.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");
    var script = document.getElementById("__ie_onload");
    script.onreadystatechange = function() {
        if (this.readyState == "complete") {
            sorttable.init(); // call the onload handler
        }
    };
/*@end @*/
}if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){sorttable.init()}},10)}window.onload=sorttable.init;function dean_addEvent(b,e,c){if(b.addEventListener){b.addEventListener(e,c,false)}else{if(!c.$$guid){c.$$guid=dean_addEvent.guid++}if(!b.events){b.events={}}var a=b.events[e];if(!a){a=b.events[e]={};if(b["on"+e]){a[0]=b["on"+e]}}a[c.$$guid]=c;b["on"+e]=handleEvent}}dean_addEvent.guid=1;function removeEvent(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.events&&a.events[c]){delete a.events[c][b.$$guid]}}}function handleEvent(e){var c=true;e=e||fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var a=this.events[e.type];for(var b in a){this.$$handleEvent=a[b];if(this.$$handleEvent(e)===false){c=false}}return c}function fixEvent(a){a.preventDefault=fixEvent.preventDefault;a.stopPropagation=fixEvent.stopPropagation;return a}fixEvent.preventDefault=function(){this.returnValue=false};fixEvent.stopPropagation=function(){this.cancelBubble=true};if(!Array.forEach){Array.forEach=function(e,c,b){for(var a=0;a<e.length;a++){c.call(b,e[a],a,e)}}}Function.prototype.forEach=function(a,e,c){for(var b in a){if(typeof this.prototype[b]=="undefined"){e.call(c,a[b],b,a)}}};String.forEach=function(a,c,b){Array.forEach(a.split(""),function(f,e){c.call(b,f,e,a)})};var forEach=function(a,e,b){if(a){var c=Object;if(a instanceof Function){c=Function}else{if(a.forEach instanceof Function){a.forEach(e,b);return}else{if(typeof a=="string"){c=String}else{if(typeof a.length=="number"){c=Array}}}}c.forEach(a,e,b)}};String.prototype.parseColor=function(){var a="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(",");var b=0;do{a+=parseInt(c[b]).toColorPart()}while(++b<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var b=1;b<4;b++){a+=(this.charAt(b)+this.charAt(b)).toLowerCase()}}if(this.length==7){a=this.toLowerCase()}}}return(a.length==7?a:(arguments[0]||this))};Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return(b.nodeType==3?b.nodeValue:(b.hasChildNodes()?Element.collectTextNodes(b):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return(c.nodeType==3?c.nodeValue:((c.hasChildNodes()&&!Element.hasClassName(c,b))?Element.collectTextNodesIgnoreClass(c,b):""))}).flatten().join("")};Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:(b/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(b){}};Array.prototype.call=function(){var a=arguments;this.each(function(b){b.apply(this,a)})};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},tagifyText:function(a){if(typeof Builder=="undefined"){throw ("Effect.tagifyText requires including script.aculo.us' builder.js library")}var b="position:relative";if(Prototype.Browser.IE){b+=";zoom:1"}a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(e){a.insertBefore(Builder.node("span",{style:b},e==" "?String.fromCharCode(160):e),c)});Element.remove(c)}})},multiple:function(b,c){var f;if(((typeof b=="object")||(typeof b=="function"))&&(b.length)){f=b}else{f=$(b).childNodes}var a=Object.extend({speed:0.1,delay:0},arguments[2]||{});var e=a.delay;$A(f).each(function(h,g){new c(h,Object.extend(a,{delay:g*a.speed+e}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(b,c){b=$(b);c=(c||"appear").toLowerCase();var a=Object.extend({queue:{position:"end",scope:(b.id||"global"),limit:1}},arguments[2]||{});Effect[b.visible()?Effect.PAIRS[c][1]:Effect.PAIRS[c][0]](b,a)}};var Effect2=Effect;Effect.Transitions={linear:Prototype.K,sinoidal:function(a){return(-Math.cos(a*Math.PI)/2)+0.5},reverse:function(a){return 1-a},flicker:function(a){var a=((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4;return(a>1?1:a)},wobble:function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5},pulse:function(b,a){a=a||5;return(Math.round((b%(1/a))*a)==0?((b*a*2)-Math.floor(b*a*2)):1-((b*a*2)-Math.floor(b*a*2)))},none:function(a){return 0},full:function(a){return 1}};Effect.ScopedQueue=Class.create();Object.extend(Object.extend(Effect.ScopedQueue.prototype,Enumerable),{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(b){var c=new Date().getTime();var a=(typeof b.options.queue=="string")?b.options.queue:b.options.queue.position;switch(a){case"front":this.effects.findAll(function(f){return f.state=="idle"}).each(function(f){f.startOn+=b.finishOn;f.finishOn+=b.finishOn});break;case"with-last":c=this.effects.pluck("startOn").max()||c;break;case"end":c=this.effects.pluck("finishOn").max()||c;break}b.startOn+=c;b.finishOn+=c;if(!b.options.queue.limit||(this.effects.length<b.options.queue.limit)){this.effects.push(b)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var c=new Date().getTime();for(var b=0,a=this.effects.length;b<a;b++){this.effects[b]&&this.effects[b].loop(c)}}});Effect.Queues={instances:$H(),get:function(a){if(typeof a!="string"){return a}if(!this.instances[a]){this.instances[a]=new Effect.ScopedQueue()}return this.instances[a]}};Effect.Queue=Effect.Queues.get("global");Effect.DefaultOptions={transition:Effect.Transitions.sinoidal,duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"};Effect.Base=function(){};Effect.Base.prototype={position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+"Internal"]?"this.options."+eventName+"Internal(this);":"")+(options[eventName]?"this.options."+eventName+"(this);":""))}if(options.transition===false){options.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ if(this.state=="idle"){this.state="running";'+codeForEvent(options,"beforeSetup")+(this.setup?"this.setup();":"")+codeForEvent(options,"afterSetup")+'};if(this.state=="running"){pos=this.options.transition(pos)*'+this.fromToDelta+"+"+this.options.from+";this.position=pos;"+codeForEvent(options,"beforeUpdate")+(this.update?"this.update(pos);":"")+codeForEvent(options,"afterUpdate")+"}}");this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).add(this)}},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}var b=(c-this.startOn)/this.totalTime,a=Math.round(b*this.totalFrames);if(a>this.currentFrame){this.render(b);this.currentFrame=a}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},inspect:function(){var a=$H();for(property in this){if(typeof this[property]!="function"){a[property]=this[property]}}return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}};Effect.Parallel=Class.create();Object.extend(Object.extend(Effect.Parallel.prototype,Effect.Base.prototype),{initialize:function(a){this.effects=a||[];this.start(arguments[1])},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1);b.cancel();b.event("beforeFinish");if(b.finish){b.finish(a)}b.event("afterFinish")})}});Effect.Event=Class.create();Object.extend(Object.extend(Effect.Event.prototype,Effect.Base.prototype),{initialize:function(){var a=Object.extend({duration:0},arguments[0]||{});this.start(a)},update:Prototype.emptyFunction});Effect.Opacity=Class.create();Object.extend(Object.extend(Effect.Opacity.prototype,Effect.Base.prototype),{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var a=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(a)},update:function(a){this.element.setOpacity(a)}});Effect.Move=Class.create();Object.extend(Object.extend(Effect.Move.prototype,Effect.Base.prototype),{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(a)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(a){this.element.setStyle({left:Math.round(this.options.x*a+this.originalLeft)+"px",top:Math.round(this.options.y*a+this.originalTop)+"px"})}});Effect.MoveBy=function(b,a,c){return new Effect.Move(b,Object.extend({x:c,y:a},arguments[3]||{}))};Effect.Scale=Class.create();Object.extend(Object.extend(Effect.Scale.prototype,Effect.Base.prototype),{initialize:function(b,c){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:c},arguments[2]||{});this.start(a)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=this.element.style[b]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){if(a.indexOf(b)>0){this.fontSize=parseFloat(a);this.fontSizeType=b}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}},update:function(a){var b=(this.options.scaleFrom/100)+(this.factor*a);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*b+this.fontSizeType})}this.setDimensions(this.dims[0]*b,this.dims[1]*b)},finish:function(a){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle)}},setDimensions:function(a,e){var f={};if(this.options.scaleX){f.width=Math.round(e)+"px"}if(this.options.scaleY){f.height=Math.round(a)+"px"}if(this.options.scaleFromCenter){var c=(a-this.dims[0])/2;var b=(e-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){f.top=this.originalTop-c+"px"}if(this.options.scaleX){f.left=this.originalLeft-b+"px"}}else{if(this.options.scaleY){f.top=-c+"px"}if(this.options.scaleX){f.left=-b+"px"}}}this.element.setStyle(f)}});Effect.Highlight=Class.create();Object.extend(Object.extend(Effect.Highlight.prototype,Effect.Base.prototype),{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(a)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color")}this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,e){return b+(Math.round(this._base[e]+(this._delta[e]*a)).toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=Class.create();Object.extend(Object.extend(Effect.ScrollTo.prototype,Effect.Base.prototype),{initialize:function(a){this.element=$(a);this.start(arguments[1]||{})},setup:function(){Position.prepare();var b=Position.cumulativeOffset(this.element);if(this.options.offset){b[1]+=this.options.offset}var a=window.innerHeight?window.height-window.innerHeight:document.body.scrollHeight-(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);this.scrollStart=Position.deltaY;this.delta=(b[1]>a?a:b[1])-this.scrollStart},update:function(a){Position.prepare();window.scrollTo(Position.deltaX,this.scrollStart+(a*this.delta))}});Effect.Fade=function(c){c=$(c);var a=c.getInlineOpacity();var b=Object.extend({from:c.getOpacity()||1,to:0,afterFinishInternal:function(e){if(e.options.to!=0){return}e.element.hide().setStyle({opacity:a})}},arguments[1]||{});return new Effect.Opacity(c,b)};Effect.Appear=function(b){b=$(b);var a=Object.extend({from:(b.getStyle("display")=="none"?0:b.getOpacity()||0),to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},arguments[1]||{});return new Effect.Opacity(b,a)};Effect.Puff=function(b){b=$(b);var a={opacity:b.getInlineOpacity(),position:b.getStyle("position"),top:b.style.top,left:b.style.left,width:b.style.width,height:b.style.height};return new Effect.Parallel([new Effect.Scale(b,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(b,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(c){Position.absolutize(c.effects[0].element)},afterFinishInternal:function(c){c.effects[0].element.hide().setStyle(a)}},arguments[1]||{}))};Effect.BlindUp=function(a){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(b){b.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(b){b=$(b);var a=b.getDimensions();return new Effect.Scale(b,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:a.height,originalWidth:a.width},restoreAfterFinish:true,afterSetup:function(c){c.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(c){c.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(b){b=$(b);var a=b.getInlineOpacity();return new Effect.Appear(b,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(c){new Effect.Scale(c.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:a})}})}},arguments[1]||{}))};Effect.DropOut=function(b){b=$(b);var a={top:b.getStyle("top"),left:b.getStyle("left"),opacity:b.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(b,{x:0,y:100,sync:true}),new Effect.Opacity(b,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(c){c.effects[0].element.makePositioned()},afterFinishInternal:function(c){c.effects[0].element.hide().undoPositioned().setStyle(a)}},arguments[1]||{}))};Effect.Shake=function(b){b=$(b);var a={top:b.getStyle("top"),left:b.getStyle("left")};return new Effect.Move(b,{x:20,y:0,duration:0.05,afterFinishInternal:function(c){new Effect.Move(c.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(e){new Effect.Move(e.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(f){new Effect.Move(f.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(g){new Effect.Move(g.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(h){new Effect.Move(h.element,{x:-20,y:0,duration:0.05,afterFinishInternal:function(j){j.element.undoPositioned().setStyle(a)}})}})}})}})}})}})};Effect.SlideDown=function(c){c=$(c).cleanWhitespace();var a=c.down().getStyle("bottom");var b=c.getDimensions();return new Effect.Scale(c,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();if(window.opera){e.element.setStyle({top:""})}e.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:(e.dims[0]-e.element.clientHeight)+"px"})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))};Effect.SlideUp=function(b){b=$(b).cleanWhitespace();var a=b.down().getStyle("bottom");return new Effect.Scale(b,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(c){c.element.makePositioned();c.element.down().makePositioned();if(window.opera){c.element.setStyle({top:""})}c.element.makeClipping().show()},afterUpdateInternal:function(c){c.element.down().setStyle({bottom:(c.dims[0]-c.element.clientHeight)+"px"})},afterFinishInternal:function(c){c.element.hide().undoClipping().undoPositioned().setStyle({bottom:a});c.element.down().undoPositioned()}},arguments[1]||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})};Effect.Grow=function(c){c=$(c);var b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()};var h=c.getDimensions();var j,g;var f,e;switch(b.direction){case"top-left":j=g=f=e=0;break;case"top-right":j=h.width;g=e=0;f=-h.width;break;case"bottom-left":j=f=0;g=h.height;e=-h.height;break;case"bottom-right":j=h.width;g=h.height;f=-h.width;e=-h.height;break;case"center":j=h.width/2;g=h.height/2;f=-h.width/2;e=-h.height/2;break}return new Effect.Move(c,{x:j,y:g,duration:0.01,beforeSetup:function(n){n.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(n){new Effect.Parallel([new Effect.Opacity(n.element,{sync:true,to:1,from:0,transition:b.opacityTransition}),new Effect.Move(n.element,{x:f,y:e,sync:true,transition:b.moveTransition}),new Effect.Scale(n.element,100,{scaleMode:{originalHeight:h.height,originalWidth:h.width},sync:true,scaleFrom:window.opera?1:0,transition:b.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(o){o.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(o){o.effects[0].element.undoClipping().undoPositioned().setStyle(a)}},b))}})};Effect.Shrink=function(c){c=$(c);var b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()};var g=c.getDimensions();var f,e;switch(b.direction){case"top-left":f=e=0;break;case"top-right":f=g.width;e=0;break;case"bottom-left":f=0;e=g.height;break;case"bottom-right":f=g.width;e=g.height;break;case"center":f=g.width/2;e=g.height/2;break}return new Effect.Parallel([new Effect.Opacity(c,{sync:true,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(c,window.opera?1:0,{sync:true,transition:b.scaleTransition,restoreAfterFinish:true}),new Effect.Move(c,{x:f,y:e,sync:true,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(h){h.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(h){h.effects[0].element.hide().undoClipping().undoPositioned().setStyle(a)}},b))};Effect.Pulsate=function(c){c=$(c);var b=arguments[1]||{};var a=c.getInlineOpacity();var f=b.transition||Effect.Transitions.sinoidal;var e=function(g){return f(1-Effect.Transitions.pulse(g,b.pulses))};e.bind(f);return new Effect.Opacity(c,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(g){g.element.setStyle({opacity:a})}},b),{transition:e}))};Effect.Fold=function(b){b=$(b);var a={top:b.style.top,left:b.style.left,width:b.style.width,height:b.style.height};b.makeClipping();return new Effect.Scale(b,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(c){new Effect.Scale(b,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(a)}})}},arguments[1]||{}))};Effect.Morph=Class.create();Object.extend(Object.extend(Effect.Morph.prototype,Effect.Base.prototype),{initialize:function(c){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}var b=Object.extend({style:{}},arguments[1]||{});if(typeof b.style=="string"){if(b.style.indexOf(":")==-1){var e="",a="."+b.style;$A(document.styleSheets).reverse().each(function(f){if(f.cssRules){cssRules=f.cssRules}else{if(f.rules){cssRules=f.rules}}$A(cssRules).reverse().each(function(g){if(a==g.selectorText){e=g.style.cssText;throw $break}});if(e){throw $break}});this.style=e.parseStyle();b.afterFinishInternal=function(f){f.element.addClassName(f.options.style);f.transforms.each(function(g){if(g.style!="opacity"){f.element.style[g.style]=""}})}}else{this.style=b.style.parseStyle()}}else{this.style=$H(b.style)}this.start(b)},setup:function(){function a(b){if(!b||["rgba(0, 0, 0, 0)","transparent"].include(b)){b="#ffffff"}b=b.parseColor();return $R(0,2).map(function(c){return parseInt(b.slice(c*2+1,c*2+3),16)})}this.transforms=this.style.map(function(h){var g=h[0],f=h[1],e=null;if(f.parseColor("#zzzzzz")!="#zzzzzz"){f=f.parseColor();e="color"}else{if(g=="opacity"){f=parseFloat(f);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(f)){var c=f.match(/^([\+\-]?[0-9\.]+)(.*)$/);f=parseFloat(c[1]);e=(c.length==3)?c[2]:null}}}var b=this.element.getStyle(g);return{style:g.camelize(),originalValue:e=="color"?a(b):parseFloat(b||0),targetValue:e=="color"?a(f):f,unit:e}}.bind(this)).reject(function(b){return((b.originalValue==b.targetValue)||(b.unit!="color"&&(isNaN(b.originalValue)||isNaN(b.targetValue))))})},update:function(a){var e={},b,c=this.transforms.length;while(c--){e[(b=this.transforms[c]).style]=b.unit=="color"?"#"+(Math.round(b.originalValue[0]+(b.targetValue[0]-b.originalValue[0])*a)).toColorPart()+(Math.round(b.originalValue[1]+(b.targetValue[1]-b.originalValue[1])*a)).toColorPart()+(Math.round(b.originalValue[2]+(b.targetValue[2]-b.originalValue[2])*a)).toColorPart():b.originalValue+Math.round(((b.targetValue-b.originalValue)*a)*1000)/1000+b.unit}this.element.setStyle(e,true)}});Effect.Transform=Class.create();Object.extend(Effect.Transform.prototype,{initialize:function(a){this.tracks=[];this.options=arguments[1]||{};this.addTracks(a)},addTracks:function(a){a.each(function(b){var c=$H(b).values().first();this.tracks.push($H({ids:$H(b).keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var b=[$(a.ids)||$$(a.ids)].flatten();return b.map(function(c){return new a.effect(c,Object.extend({sync:true},a.options))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.prototype.parseStyle=function(){var b=document.createElement("div");b.innerHTML='<div style="'+this+'"></div>';var c=b.childNodes[0].style,a=$H();Element.CSS_PROPERTIES.each(function(e){if(c[e]){a[e]=c[e]}});if(Prototype.Browser.IE&&this.indexOf("opacity")>-1){a.opacity=this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]}return a};Element.morph=function(a,b){new Effect.Morph(a,Object.extend({style:b},arguments[2]||{}));return a};["getInlineOpacity","forceRerendering","setContentZoom","collectTextNodes","collectTextNodesIgnoreClass","morph"].each(function(a){Element.Methods[a]=Element[a]});Element.Methods.visualEffect=function(b,c,a){s=c.dasherize().camelize();effect_class=s.charAt(0).toUpperCase()+s.substring(1);new Effect[effect_class](b,a);return $(b)};Element.addMethods();var myCalendarModel=new DHTMLSuite.calendarModel({initialYear:2004,initialMonth:5,initialDay:20});var dNow=new Date();dNow.setDate(dNow.getDate()+1);myCalendarModel.addInvalidDateRange({year:dNow.getFullYear(),month:dNow.getMonth()+1,day:dNow.getDate()},false);var calendarObjForFormMin=new DHTMLSuite.calendar({minuteDropDownInterval:60,numberOfRowsInHourDropDown:10,callbackFunctionOnDayClick:"getDateFromCalendarMin",isDragable:true,displayTimeBar:true});var calendarObjForFormMax=new DHTMLSuite.calendar({minuteDropDownInterval:60,numberOfRowsInHourDropDown:10,callbackFunctionOnDayClick:"getDateFromCalendarMax",isDragable:true,displayTimeBar:true});calendarObjForFormMax.setCalendarModelReference(myCalendarModel);calendarObjForFormMin.setCalendarModelReference(myCalendarModel);calendarObjForFormMax.setCallbackFunctionOnClose("myOtherFunctionMax");calendarObjForFormMin.setCallbackFunctionOnClose("myOtherFunctionMin");function setCalendarFineGranularity(){calendarObjForFormMin.minuteDropDownInterval=5;calendarObjForFormMax.minuteDropDownInterval=5}function myOtherFunctionMax(a){getDateFromCalendarCloseMax(a);update_quick_jump()}function myOtherFunctionMin(a){getDateFromCalendarCloseMin(a);update_quick_jump()}function pickDate(a,c,b){if(b.isVisible()){b.hide()}else{b.setCalendarPositionByHTMLElement(c,0,c.offsetHeight+2);b.setInitialDateFromInput(c,"yyyy-mm-dd hh:ii");b.addHtmlElementReference("myDate",c);b.resetViewDisplayedMonth();b.display()}}function getDateFromCalendarClose(a,b){var f=a.year+"-"+a.month+"-"+a.day+" "+a.hour+":"+a.minute;b.myDate.value=f;var c=new Date();c.setFullYear(a.year,a.month-1,a.day);c.setHours(a.hour);c.setMinutes(a.minute);c.setSeconds(0);c.setMilliseconds(0);var e=now.getTime()-c.getTime();if(e<60000){e=0}document.getElementById("interval."+b.myDate.id).value=e}function getDateFromCalendarCloseMin(a){var b=calendarObjForFormMin.getHtmlElementReferences();getDateFromCalendarClose(a,b)}function getDateFromCalendarMin(a){getDateFromCalendarCloseMin(a);calendarObjForFormMin.hide()}function getDateFromCalendarCloseMax(a){var b=calendarObjForFormMax.getHtmlElementReferences();getDateFromCalendarClose(a,b)}function getDateFromCalendarMax(a){getDateFromCalendarCloseMax(a);calendarObjForFormMax.hide()}function showZero(a){return(a<10?"0":"")+a}function dateToString(a){return a.getFullYear()+"-"+showZero(a.getMonth()+1)+"-"+showZero(a.getDate())+" "+showZero(a.getHours())+":"+showZero(a.getMinutes())}function init_form(){if(now.getFullYear()+""=="NaN"){now=new Date();now.setMinutes(0);now.setSeconds(0);now.setMilliseconds(0)}var a=new Date(now.getTime()-document.getElementById("interval.min").value);var b=new Date(now.getTime()-document.getElementById("interval.max").value);document.getElementById("min").value=dateToString(a);document.getElementById("max").value=dateToString(b);update_quick_jump()}function update_quick_jump(){var a=false;if(document.forms.form1.elements["interval.max"].value==0){for(i=1;i<document.form1.quick_interval.options.length;i++){if(document.form1.quick_interval.options[i].value==document.forms.form1.elements["interval.min"].value){document.form1.quick_interval.selectedIndex=i;a=true}}}if(!a){document.form1.quick_interval.selectedIndex=0}}function quick_jump(){var a=document.form1.quick_interval.options[document.form1.quick_interval.selectedIndex].value;if(a>0){document.forms.form1.elements["interval.min"].value=a;document.forms.form1.elements["interval.max"].value=0;init_form()}document.form1.submit()}function move_back(){var diff=document.getElementById("interval.max").value-document.getElementById("interval.min").value;if(diff<0){diff=-diff}if(diff<3600000){diff=3600000}var x=document.getElementById("interval.max").value;document.getElementById("interval.max").value=eval(x+"+"+diff);var y=document.getElementById("interval.min").value;document.getElementById("interval.min").value=eval(y+"+"+diff);init_form();update_quick_jump();document.form1.submit()}function move_next(){var diff=document.getElementById("interval.max").value-document.getElementById("interval.min").value;if(diff<0){diff=-diff}if(diff<3600000){diff=3600000}var x=document.getElementById("interval.max").value;x=eval(x+"-"+diff);if(x<0){x=0}document.getElementById("interval.max").value=x;var y=document.getElementById("interval.min").value;y=eval(y+"-"+diff);if(y<diff){y=diff}document.getElementById("interval.min").value=y;init_form();update_quick_jump();document.form1.submit()}function openJDL(a){nd();window.open("/jdl/"+a+".html","JDL of "+a,"toolbar=0,width=800,height=600,scrollbars=1,resizable=1,titlebar=1");return false}function openLive(a){nd();var f='<iframe src="/jobs/details.jsp?pid='+a+'" border=0 width=100% height=99% frameborder=0 marginwidth=0 marginheight=0 scrolling=auto align=absmiddle vspace=0 hspace=0></iframe>';var b=a;try{if(b.indexOf("#")>0){b=b.substring(0,b.indexOf("#"))}}catch(c){}showCenteredWindowSize(f,"Status of masterjob "+b,800,400);return false}function jobDetails(a){overlib('<iframe src="/jobs/job_details.jsp?pid='+a+'" border=0 width=100% height=230 frameborder=0 marginwidth=0 marginheight=0 scrolling=no align=absmiddle vspace=0 hspace=0></iframe>',CAPTION,"Click for live details")}function runDetails(a){overlib('<iframe src="/raw/rawrun_details.jsp?run='+a+'" border=0 width=100% height=270 frameborder=0 marginwidth=0 marginheight=0 scrolling=no align=absmiddle vspace=0 hspace=0></iframe>')}function showMenu(){prefix="http://alimonitor.cern.ch";dMLMenu=new dTree("dMLMenu");dMLMenu.add(0,-1,'ALICE Repository <a href="'+prefix+'/xml.jsp"><img border=0 src="/images/xml.gif"></a>',"/");dMLMenu.add(5,0,"Google Map",prefix+"/map.jsp");dMLMenu.add(6,0,"Shifter's dashboard",prefix+"/dashboard/");dMLMenu.add(7,0,"Run Condition Table",prefix+"/configuration/");dMLMenu.add(9,0,"Production info",null);dMLMenu.add(9005,9,"Run view",prefix+"/runview/");dMLMenu.add(9002,9,"RAW production cycles",prefix+"/production/raw.jsp");dMLMenu.add(9003,9,"RAW activities",prefix+"/prod/?t=3");dMLMenu.add(9004,9,"Analysis train",prefix+"/prod/");dMLMenu.add(9000,9,"MC production cycles",prefix+"/job_details.jsp");dMLMenu.add(9001,9,"MC production requests",prefix+"/PWG/");dMLMenu.add(10,0,"Job Information",prefix+"/show?page=jobStatus.html");dMLMenu.add(100,"Jobs details",prefix+"/job_events.jsp");dMLMenu.add(101,10,"Site views",null);dMLMenu.add(1011,101,"Summary plots",prefix+"/display?page=jobStatusSites_TOTALS");dMLMenu.add(1012,101,"Job states",prefix+"/display?page=jobStatusSites_RUNNING");dMLMenu.add(1013,101,"Jobs per site",prefix+"/display?page=jobs_per_site");dMLMenu.add(1014,101,"Jobs per site table",prefix+"/stats?page=current_job_status");dMLMenu.add(1017,101,"Resource usage",prefix+"/display?page=jobResUsageSum_time_cpu");dMLMenu.add(102,10,"User views",null);dMLMenu.add(1021,102,"Summary plots",prefix+"/display?page=jpu/jobs_per_user");dMLMenu.add(1022,102,"Jobs status",prefix+"/display?page=jpu/jpu_RUNNING");dMLMenu.add(1023,102,"Grid packages",prefix+"/packages/");dMLMenu.add(1024,102,"Quotas",prefix+"/users/quotas.jsp");dMLMenu.add(103,10,"Task queue");dMLMenu.add(1031,103,"Task queue summary",prefix+"/display?page=jobStatusCS_run_params");dMLMenu.add(1032,103,"Jobs in TQ table",prefix+"/job_stats.jsp");dMLMenu.add(104,10,"Job timings");dMLMenu.add(1041,104,"By site",prefix+"/Correlations?page=timings/persite");dMLMenu.add(1042,104,"Per user",prefix+"/Correlations?page=timings/peruser");dMLMenu.add(107,10,"Memory profiles");dMLMenu.add(1070,107,"Offending jobs",prefix+"/display?page=memory/offenders");dMLMenu.add(1071,107,"By site",prefix+"/display?page=jps/mem_combined");dMLMenu.add(1072,107,"Per user",prefix+"/display?page=jpu/mem_combined");dMLMenu.add(1073,107,"Current jobs",prefix+"/memory/");dMLMenu.add(105,10,"Federation views");dMLMenu.add(1051,105,"Resources",prefix+"/display?page=federations/histogram_time_run_si2k");dMLMenu.add(1052,105,"Jobs",prefix+"/display?page=federations/histogram_jobs_done");dMLMenu.add(106,10,"JobAgents");dMLMenu.add(1061,106,"CE status",prefix+"/display?page=ja");dMLMenu.add(1062,106,"Active JAs",prefix+"/display?page=ja_status");dMLMenu.add(1063,106,"Cumulative JAs",prefix+"/display?page=ja_status_R");dMLMenu.add(108,10,"Running trend",prefix+"/trend.jsp");dMLMenu.add(20,0,"SE Information","");dMLMenu.add(201,20,"Status",prefix+"/stats?page=SE/table");dMLMenu.add(202,20,"Traffic",prefix+"/display?page=seTraffic_mbytes");dMLMenu.add(203,20,"Files",prefix+"/display?page=seTraffic_files_rd");dMLMenu.add(207,20,"xrootd","");dMLMenu.add(2071,207,"SEs overview",prefix+"/display?page=xrootdse/SEs");dMLMenu.add(2072,207,"Per SE details","");dMLMenu.add(20721,2072,"Traffic",prefix+"/display?page=xrootdse/by_se");dMLMenu.add(20722,2072,"Load",prefix+"/display?page=xrootdse/by_se_load");dMLMenu.add(20723,2072,"Sockets",prefix+"/display?page=xrootdse/by_se_sockets");dMLMenu.add(208,20,"CERN Castor2x",prefix+"/display?page=castor2/hist");dMLMenu.add(209,20,"AFs","");dMLMenu.add(2091,209,"Overview",prefix+"/display?page=PROOF/SEs");dMLMenu.add(2092,209,"Details","");dMLMenu.add(20921,2092,"Traffic",prefix+"/display?page=PROOF/by_se");dMLMenu.add(20922,2092,"Load",prefix+"/display?page=PROOF/by_se_load");dMLMenu.add(20923,2092,"Sockets",prefix+"/display?page=PROOF/by_se_sockets");dMLMenu.add(30,0,"Services",null);dMLMenu.add(301,30,"Central Services",prefix+"/show?page=racks.html");dMLMenu.add(3011,301,"Central machines",prefix+"/stats?page=machines/machines");dMLMenu.add(3012,301,"APIServers",prefix+"/display?page=api_sessions");dMLMenu.add(3013,301,"DAQ Registration",prefix+"/display?page=DAQ2/daq_size");dMLMenu.add(3015,301,"ML Repository",prefix+"/info.jsp");dMLMenu.add(3016,301,"UPSs",prefix+"/stats?page=ups/ups");dMLMenu.add(3017,301,"Sensors",prefix+"/stats?page=machines/ipmi");dMLMenu.add(3018,301,"VirtualBox",prefix+"/stats?page=machines%2Fvirtualbox");dMLMenu.add(3019,301,"Build machines",prefix+"/stats?page=machines%2Fbuild");dMLMenu.add(3010,301,"Network traffic",prefix+"/display?page=machines/net/uplink");dMLMenu.add(302,30,"Site Services",null);dMLMenu.add(3020,302,"Site overview",prefix+"/siteinfo/");dMLMenu.add(3021,302,"VO Boxes",prefix+"/stats?page=vobox_status");dMLMenu.add(3022,302,"Services status",prefix+"/stats?page=services_status");dMLMenu.add(3023,302,"MonaLisa",prefix+"/stats?page=siteMLstatus");dMLMenu.add(3024,302,"Proxies",prefix+"/stats?page=proxies");dMLMenu.add(3025,302,"Packages",prefix+"/packages/list.jsp");dMLMenu.add(3026,302,"VoBox temp",prefix+"/temp.jsp");dMLMenu.add(3027,302,"SAM Tests",prefix+"/sam/sam.jsp");dMLMenu.add(40,0,"Network Traffic",null);dMLMenu.add(41,40,"Incomming",prefix+"/display?page=site_in_traffic_hist");dMLMenu.add(42,40,"Outgoing",prefix+"/display?page=site_out_traffic_hist");dMLMenu.add(43,40,"Internal",prefix+"/display?page=site_int_traffic_hist");dMLMenu.add(44,40,"Inter-Site",prefix+"/display?page=site_intsite_traffic_hist");dMLMenu.add(45,40,"Bandwidth tests",prefix+"/speed/");dMLMenu.add(60,0,"FTD Transfers",prefix+"/show?page=ftdStatus.html");dMLMenu.add(601,60,"RAW replication",prefix+"/transfers");dMLMenu.add(601,60,"Transfer states",prefix+"/display?page=FTD/CS");dMLMenu.add(602,60,"Transfer speed",prefix+"/display?page=FTD/SE");dMLMenu.add(603,60,"FTD efficiency","http://dashb-alice-job.cern.ch/dashboard/data/fts/index.html",null,"_blank");dMLMenu.add(70,0,"CAF Monitoring",null);dMLMenu.add(700,70,"RAW Data Reconstruction",prefix+"/raw_reco_status.jsp");dMLMenu.add(701,70,"Machine views",null);dMLMenu.add(7011,701,"Status table",prefix+"/stats?page=CAF2/table");dMLMenu.add(7012,701,"Parameter view",prefix+"/display?page=CAF2/parameter");dMLMenu.add(7013,701,"Machine details",prefix+"/display?page=CAF2/machine");dMLMenu.add(704,70,"CPU quotas",prefix+"/caf/cpuquota.jsp");dMLMenu.add(705,70,"Datasets",prefix+"/stats?page=CAF2/datasets");dMLMenu.add(80,0,"SHUTTLE",prefix+"/show?page=shuttle.html");dMLMenu.add(801,80,"Production@P2",prefix+"/shuttle.jsp?instance=PROD");dMLMenu.add(802,80,"Test setup",prefix+"/shuttle.jsp");dMLMenu.add(803,80,"Host monitoring",prefix+"/display?page=shuttle/machine");dMLMenu.add(91,0,"Build system");dMLMenu.add(911,91,"AliRoot benchmarks",prefix+"/bits/bits_benchmark.jsp");dMLMenu.add(92,0,"HepSpec");dMLMenu.add(921,92,"Overview",prefix+"/hepspec/");dMLMenu.add(922,92,"Per site",prefix+"/hepspec/site.jsp");dMLMenu.add(100,0,"Dynamic charts",prefix+"/correlations/");document.write(dMLMenu)};